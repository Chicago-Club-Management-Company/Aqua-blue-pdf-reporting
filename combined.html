<html>
<head>

    <script>
    window.MathJax = {
        jax: ["input/TeX","output/HTML-CSS"],
        extensions: ["tex2jax.js"],
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            ignoreClass: "nostem|no-math",
            processClass: "math|tex"
        },
        TeX: {
            extensions: ["AMSmath.js", "AMSsymbols.js"]
        },
        "HTML-CSS": {
            availableFonts: ["TeX"],
            scale: 200
        },
        showProcessingMessages: false,
        messageStyle: "none",
        skipStartupTypeset: false
    };
</script>
<script src="file:///C:/Users/jaxan/AppData/Roaming/npm/node_modules/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<link rel="stylesheet" href="myStyles.css">
</head><body>
<!-- Start of C:/CodingGeneral/chicagoClubManagement/aqua-blue/_build/aqua_blue.html -->
<nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>
            <img src="https://raw.githubusercontent.com/Chicago-Club-Management-Company/aqua-blue/refs/heads/main/assets/blue.jpg" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>

            <h2>Contents</h2>
            <ul>
  <li><a href="#aqua-blue">aqua-blue</a>
  <ul>
    <li><a href="#what-is-aqua-blue"> What is aqua-blue?</a></li>
    <li><a href="#found-a-bug"> Found a bug?</a></li>
    <li><a href="#contributing"> Contributing</a></li>
    <li><a href="#installation"> Installation</a></li>
    <li><a href="#quickstart"> Quickstart</a></li>
    <li><a href="#license"> License</a></li>
  </ul></li>
  <li><a href="#examples">Examples</a>
  <ul>
    <li><a href="#basic-lotka-volterra-example"> Basic Lotka-Volterra example</a></li>
    <li><a href="#using-datetime-objects"> Using datetime objects</a></li>
    <li><a href="#load-and-output-a-json-string"> Load and output a JSON string</a></li>
    <li><a href="#explicit-weights"> Explicit weights</a></li>
    <li><a href="#explicit-activation-function"> Explicit activation function</a></li>
    <li><a href="#http-requests"> HTTP Requests</a></li>
    <li><a href="#read-from-and-write-to-csv-files"> Read from and write to CSV files</a></li>
    <li><a href="#logging"> Logging</a></li>
  </ul></li>
</ul>


            <h2>Submodules</h2>
            <ul>
                    <li><a href="aqua_blue/datetimelikearray.html">datetimelikearray</a></li>
                    <li><a href="aqua_blue/models.html">models</a></li>
                    <li><a href="aqua_blue/readouts.html">readouts</a></li>
                    <li><a href="aqua_blue/reservoirs.html">reservoirs</a></li>
                    <li><a href="aqua_blue/time_series.html">time_series</a></li>
                    <li><a href="aqua_blue/utilities.html">utilities</a></li>
            </ul>

            <h2>API Documentation</h2>
                <ul class="memberlist">
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
aqua_blue    </h1>

                        <div class="docstring"><h1 id="aqua-blue">aqua-blue</h1>

<p>Lightweight and basic reservoir computing library</p>

<p><a href="https://chicago-club-management-company.github.io/aqua-blue/"><img src="https://img.shields.io/badge/docs-brightgreen?logo=github&logoColor=green&label=gh-pages" alt="Custom shields.io" /></a></p>

<p><a href="https://pypi.python.org/pypi/aqua-blue/"><img src="https://img.shields.io/pypi/v/aqua-blue.svg" alt="PyPI version shields.io" /></a>
<a href="https://pypi.python.org/pypi/aqua-blue/"><img src="https://img.shields.io/pypi/pyversions/aqua-blue.svg" alt="PyPI pyversions shields.io" /></a></p>

<h2 id="what-is-aqua-blue"> What is aqua-blue?</h2>

<p><code>aqua-blue</code> is a lightweight <code>python</code> library for reservoir computing (specifically <a href="https://en.wikipedia.org/wiki/Echo_state_network">echo state networks</a>) depending only on <code>numpy</code>. <code>aqua-blue</code>'s namesake comes from:</p>

<ul>
<li>A blue ocean of data, aka a reservoir </li>
<li>A very fancy cat named Blue </li>
</ul>

<h2 id="found-a-bug"> Found a bug?</h2>

<p>Please open an issue <a href="https://github.com/Chicago-Club-Management-Company/aqua-blue/issues">here</a> if you found a bug!
The easier it is to reproduce the bug, the faster we will find a solution to the problem. Please consider including the
following info in your issue:</p>

<ul>
<li>Steps to reproduce</li>
<li>Expected and actual behavior</li>
<li>Version info, OS, etc.</li>
</ul>

<h2 id="contributing"> Contributing</h2>

<p>Please see <a href="https://github.com/Chicago-Club-Management-Company/aqua-blue/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a>
for instructions on how to contribute to <code>aqua-blue</code> </p>

<h2 id="installation"> Installation</h2>

<p><code>aqua-blue</code> is on PyPI, and can therefore be installed with <code>pip</code>:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>aqua-blue
</code></pre>
</div>

<h2 id="quickstart"> Quickstart</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">aqua_blue</span>

<span class="c1"># generate arbitrary two-dimensional time series</span>
<span class="c1"># y_1(t) = cos(t), y_2(t) = sin(t)</span>
<span class="c1"># resulting dependent variable has shape (number of timesteps, 2)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">10_000</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">5.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>

<span class="c1"># create time series object to feed into echo state network</span>
<span class="n">time_series</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/time_series.html#TimeSeries">aqua_blue.time_series.TimeSeries</a></span><span class="p">(</span><span class="n">dependent_variable</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>

<span class="c1"># normalize</span>
<span class="n">normalizer</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/utilities.html#Normalizer">aqua_blue.utilities.Normalizer</a></span><span class="p">()</span>
<span class="n">time_series</span> <span class="o">=</span> <span class="n">normalizer</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span>

<span class="c1"># make model and train</span>
<span class="n">model</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/models.html#Model">aqua_blue.models.Model</a></span><span class="p">(</span>
    <span class="n">reservoir</span><span class="o">=</span><span class="n"><a href="aqua_blue/reservoirs.html#DynamicalReservoir">aqua_blue.reservoirs.DynamicalReservoir</a></span><span class="p">(</span>
        <span class="n">reservoir_dimensionality</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">input_dimensionality</span><span class="o">=</span><span class="mi">2</span>
    <span class="p">),</span>
    <span class="n">readout</span><span class="o">=</span><span class="n"><a href="aqua_blue/readouts.html#LinearReadout">aqua_blue.readouts.LinearReadout</a></span><span class="p">()</span>
<span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span>

<span class="c1"># predict and denormalize</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">1_000</span><span class="p">)</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">normalizer</span><span class="o">.</span><span class="n">denormalize</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
</code></pre>
</div>

<h2 id="license"> License</h2>

<p><code>aqua-blue</code> is released under the MIT License.</p>

<hr />

<p><img src="https://raw.githubusercontent.com/Chicago-Club-Management-Company/aqua-blue/refs/heads/main/assets/blue.jpg" alt="Blue" /></p>

<p><em>Blue, the cat behind <code>aqua-blue</code>.</em></p>

<h1 id="examples">Examples</h1>

<h2 id="basic-lotka-volterra-example"> Basic Lotka-Volterra example</h2>

<p>Below is an example of using <code>aqua-blue</code> to predict the predator-prey
<a href="https://en.wikipedia.org/wiki/Lotka%E2%80%93Volterra_equations">Lotka-Volterra equations</a>:</p>

<p>$$ \dot x = \alpha x - \beta xy $$
$$ \dot y = -\gamma y + \delta xy$$</p>

<p>with parameters $\alpha = 0.1$, $\beta = 0.02$, $\gamma = 0.3$, and $\delta = 0.01$, and initial conditions
$(x_0, y_0) = (20, 9)$. We train a reservoir computer with a reservoir dimensionality of $1000$ over $0\leq t\leq 10$,
with $1000$ timesteps. Then, we predict the next $1000$ timesteps.</p>

<p>Here, we use <code>scipy.integrate.solve_ivp</code> to integrate the system of differential equations.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">aqua_blue</span>


<span class="k">def</span><span class="w"> </span><span class="nf">lotka_volterra</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">z</span>
    <span class="n">dxdt</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
    <span class="n">dydt</span> <span class="o">=</span> <span class="n">delta</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">y</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dxdt</span><span class="p">,</span> <span class="n">dydt</span><span class="p">]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">solve_lv</span><span class="p">(</span><span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span><span class="p">,</span> <span class="n">no</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mi">9</span><span class="p">):</span>

    <span class="n">t_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span><span class="p">,</span> <span class="n">no</span><span class="p">)</span>
    <span class="n">solution</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">lotka_volterra</span><span class="p">,</span> <span class="p">[</span><span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span><span class="p">],</span> <span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">],</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">))</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">y</span>
    <span class="n">lotka_volterra_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
    <span class="k">return</span> <span class="n">lotka_volterra_array</span>


<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">solve_lv</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

    <span class="n">time_series</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/time_series.html#TimeSeries">aqua_blue.time_series.TimeSeries</a></span><span class="p">(</span><span class="n">dependent_variable</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>

    <span class="n">normalizer</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/utilities.html#Normalizer">aqua_blue.utilities.Normalizer</a></span><span class="p">()</span>
    <span class="n">time_series</span> <span class="o">=</span> <span class="n">normalizer</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/models.html#Model">aqua_blue.models.Model</a></span><span class="p">(</span>
        <span class="n">reservoir</span><span class="o">=</span><span class="n"><a href="aqua_blue/reservoirs.html#DynamicalReservoir">aqua_blue.reservoirs.DynamicalReservoir</a></span><span class="p">(</span>
            <span class="n">reservoir_dimensionality</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
            <span class="n">input_dimensionality</span><span class="o">=</span><span class="mi">2</span>
        <span class="p">),</span>
        <span class="n">readout</span><span class="o">=</span><span class="n"><a href="aqua_blue/readouts.html#LinearReadout">aqua_blue.readouts.LinearReadout</a></span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span>

    <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">1_000</span><span class="p">)</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">normalizer</span><span class="o">.</span><span class="n">denormalize</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>

    <span class="n">actual_future</span> <span class="o">=</span> <span class="n">solve_lv</span><span class="p">(</span><span class="n">prediction</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">prediction</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1_000</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">prediction</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">actual_future</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">prediction</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">prediction</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;actual x&#39;</span><span class="p">,</span> <span class="s1">&#39;actual y&#39;</span><span class="p">,</span> <span class="s1">&#39;predicted x&#39;</span><span class="p">,</span> <span class="s1">&#39;predicted y&#39;</span><span class="p">],</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Lotka-Volterra System&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="n">main</span><span class="p">()</span>
</code></pre>
</div>

<h2 id="using-datetime-objects"> Using datetime objects</h2>

<p>Below is an example of a simple sine-cosine task similar to above, using <code>datetime.datetime</code> objects as times.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">zoneinfo</span><span class="w"> </span><span class="kn">import</span> <span class="n">ZoneInfo</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">aqua_blue</span>


<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>

    <span class="n">start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">astimezone</span><span class="p">(</span><span class="n">ZoneInfo</span><span class="p">(</span><span class="s2">&quot;Indian/Maldives&quot;</span><span class="p">))</span>

    <span class="c1"># Generate 10,000 datetime objects, each 1 minute apart</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="n">start_date</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">)]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="o">/</span> <span class="mi">100</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
    <span class="n">time_series</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/time_series.html#TimeSeries">aqua_blue.time_series.TimeSeries</a></span><span class="p">(</span><span class="n">dependent_variable</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
    <span class="n">normalizer</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/utilities.html#Normalizer">aqua_blue.utilities.Normalizer</a></span><span class="p">()</span>
    <span class="n">time_series</span> <span class="o">=</span> <span class="n">normalizer</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/models.html#Model">aqua_blue.models.Model</a></span><span class="p">(</span>
        <span class="n">reservoir</span><span class="o">=</span><span class="n"><a href="aqua_blue/reservoirs.html#DynamicalReservoir">aqua_blue.reservoirs.DynamicalReservoir</a></span><span class="p">(</span>
            <span class="n">reservoir_dimensionality</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
            <span class="n">input_dimensionality</span><span class="o">=</span><span class="mi">2</span>
        <span class="p">),</span>
        <span class="n">readout</span><span class="o">=</span><span class="n"><a href="aqua_blue/readouts.html#LinearReadout">aqua_blue.readouts.LinearReadout</a></span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span>

    <span class="n">horizon</span> <span class="o">=</span> <span class="mi">1_000</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="n">horizon</span><span class="p">)</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">normalizer</span><span class="o">.</span><span class="n">denormalize</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>

    <span class="n">dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">a</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">actual_future</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span>
        <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">horizon</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">horizon</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">))</span><span class="o">.</span><span class="n">T</span>

    <span class="n">root_mean_square_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">actual_future</span> <span class="o">-</span> <span class="n">prediction</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">root_mean_square_error</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">prediction</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">actual_future</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">prediction</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">prediction</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;actual x&#39;</span><span class="p">,</span> <span class="s1">&#39;actual y&#39;</span><span class="p">,</span> <span class="s1">&#39;predicted x&#39;</span><span class="p">,</span> <span class="s1">&#39;predicted y&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="n">main</span><span class="p">()</span>
</code></pre>
</div>

<h2 id="load-and-output-a-json-string"> Load and output a JSON string</h2>

<p>Below is an example of inputting a <code>json</code> string as the training data, and outputting a <code>json</code> string for the
prediction. This is particularly useful for interfacing <code>aqua-blue</code> with already-existing systems.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">aqua_blue</span>


<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>

    <span class="c1"># some string that is valid json</span>
    <span class="n">json_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    {</span>
<span class="s2">        &quot;dependent_variable&quot;: [</span>
<span class="s2">            [2.0, -1.0],</span>
<span class="s2">            [1.5403023058681398, -0.1585290151921035],</span>
<span class="s2">            [0.5838531634528576, -0.09070257317431829],</span>
<span class="s2">            [0.010007503399554585, -0.8588799919401328],</span>
<span class="s2">            [0.34635637913638806, -1.7568024953079282],</span>
<span class="s2">            [1.2836621854632262, -1.9589242746631386],</span>
<span class="s2">            [1.9601702866503659, -1.2794154981989259],</span>
<span class="s2">            [1.7539022543433047, -0.34301340128121094],</span>
<span class="s2">            [0.8544999661913865, -0.010641753376618213],</span>
<span class="s2">            [0.08886973811532306, -0.5878815147582435]</span>
<span class="s2">        ],</span>
<span class="s2">        &quot;times&quot;: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
<span class="s2">    }</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="c1"># turn into a TimeSeries instance</span>
    <span class="n">time_series</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/time_series.html#TimeSeries">aqua_blue.time_series.TimeSeries</a></span><span class="p">(</span><span class="o">**</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_str</span><span class="p">))</span>

    <span class="c1"># normalize and feed into model</span>
    <span class="n">normalizer</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/utilities.html#Normalizer">aqua_blue.utilities.Normalizer</a></span><span class="p">()</span>
    <span class="n">normalized_time_series</span> <span class="o">=</span> <span class="n">normalizer</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/models.html#Model">aqua_blue.models.Model</a></span><span class="p">(</span>
        <span class="n">reservoir</span><span class="o">=</span><span class="n"><a href="aqua_blue/reservoirs.html#DynamicalReservoir">aqua_blue.reservoirs.DynamicalReservoir</a></span><span class="p">(</span>
            <span class="n">reservoir_dimensionality</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
            <span class="n">input_dimensionality</span><span class="o">=</span><span class="mi">2</span>
        <span class="p">),</span>
        <span class="n">readout</span><span class="o">=</span><span class="n"><a href="aqua_blue/readouts.html#LinearReadout">aqua_blue.readouts.LinearReadout</a></span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">normalized_time_series</span><span class="p">)</span>

    <span class="c1"># predict 5 more steps</span>
    <span class="n">horizon</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="n">horizon</span><span class="p">)</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">normalizer</span><span class="o">.</span><span class="n">denormalize</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>

    <span class="c1"># concatenate prediction and original time series, and print out a new json</span>
    <span class="n">concatenated</span> <span class="o">=</span> <span class="n">time_series</span> <span class="o">&gt;&gt;</span> <span class="n">prediction</span>

    <span class="c1"># turn into a dictionary and json dump it</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">concatenated</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()))</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="n">main</span><span class="p">()</span>
</code></pre>
</div>

<h2 id="explicit-weights"> Explicit weights</h2>

<p>Below is an example of generating explicit matrices for $W_\text{in}$ and $W_\text{res}$. Here, <code>sparsity=0.99</code> and
<code>spectral_radius=1.2</code> respectively zero-out $99\%$ of $W_\text{res}$'s elements and force $W_\text{res}$ to have a
<a href="https://en.wikipedia.org/wiki/Spectral_radius">spectral radius</a> of $1.2$. We also showcase the <code>&gt;&gt;</code> operator, which
concatenates instances of <code><a href="aqua_blue/time_series.html#TimeSeries">aqua_blue.time_series.TimeSeries</a></code>.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">aqua_blue</span>


<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5_000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span><span class="o">.</span><span class="n">T</span>

    <span class="n">time_series</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/time_series.html#TimeSeries">aqua_blue.time_series.TimeSeries</a></span><span class="p">(</span><span class="n">dependent_variable</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
    <span class="n">normalizer</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/utilities.html#Normalizer">aqua_blue.utilities.Normalizer</a></span><span class="p">()</span>
    <span class="n">normalized_time_series</span> <span class="o">=</span> <span class="n">normalizer</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span>
    <span class="n">generator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">w_res</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
        <span class="n">low</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">high</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">w_in</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
        <span class="n">low</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">high</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/models.html#Model">aqua_blue.models.Model</a></span><span class="p">(</span>
        <span class="n">reservoir</span><span class="o">=</span><span class="n"><a href="aqua_blue/reservoirs.html#DynamicalReservoir">aqua_blue.reservoirs.DynamicalReservoir</a></span><span class="p">(</span>
            <span class="n">reservoir_dimensionality</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
            <span class="n">input_dimensionality</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">w_res</span><span class="o">=</span><span class="n">w_res</span><span class="p">,</span>
            <span class="n">w_in</span><span class="o">=</span><span class="n">w_in</span><span class="p">,</span>
            <span class="n">spectral_radius</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span>
            <span class="n">sparsity</span><span class="o">=</span><span class="mf">0.99</span>
        <span class="p">),</span>
        <span class="n">readout</span><span class="o">=</span><span class="n"><a href="aqua_blue/readouts.html#LinearReadout">aqua_blue.readouts.LinearReadout</a></span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">normalized_time_series</span><span class="p">)</span>

    <span class="n">horizon</span> <span class="o">=</span> <span class="mi">1_000</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="n">horizon</span><span class="p">)</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">normalizer</span><span class="o">.</span><span class="n">denormalize</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>

    <span class="n">actual_future</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/time_series.html#TimeSeries">aqua_blue.time_series.TimeSeries</a></span><span class="p">(</span>
        <span class="n">dependent_variable</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">prediction</span><span class="o">.</span><span class="n">times</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">prediction</span><span class="o">.</span><span class="n">times</span><span class="p">)))</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
        <span class="n">times</span><span class="o">=</span><span class="n">prediction</span><span class="o">.</span><span class="n">times</span>
    <span class="p">)</span>

    <span class="n">ground_truth</span> <span class="o">=</span> <span class="n">time_series</span> <span class="o">&gt;&gt;</span> <span class="n">actual_future</span>
    <span class="n">predicted</span> <span class="o">=</span> <span class="n">time_series</span> <span class="o">&gt;&gt;</span> <span class="n">prediction</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ground_truth</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">ground_truth</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">predicted</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">predicted</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">time_series</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;actual x&#39;</span><span class="p">,</span> <span class="s1">&#39;actual y&#39;</span><span class="p">,</span> <span class="s1">&#39;predicted x&#39;</span><span class="p">,</span> <span class="s1">&#39;predicted y&#39;</span><span class="p">,</span> <span class="s1">&#39;knowledge horizon&#39;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Explicit Weight Matrix Example&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="n">main</span><span class="p">()</span>
</code></pre>
</div>

<h2 id="explicit-activation-function"> Explicit activation function</h2>

<p>Below is an example of using a different activation function to map from the input state to the reservoir.
Here, we use both hyperbolic tangent (<code>tanh</code>) and the <a href="https://en.wikipedia.org/wiki/Error_function">error function</a>
(<code>erf</code>), and compare the results.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Callable</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">aqua_blue</span>


<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">activation_functions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;tanh&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">,</span> <span class="s2">&quot;erf&quot;</span><span class="p">:</span> <span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">erf</span><span class="p">}</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10_000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span><span class="o">.</span><span class="n">T</span>

    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">activation_function</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">activation_functions</span><span class="p">):</span>
        <span class="n">time_series</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/time_series.html#TimeSeries">aqua_blue.time_series.TimeSeries</a></span><span class="p">(</span><span class="n">dependent_variable</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
        <span class="n">normalizer</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/utilities.html#Normalizer">aqua_blue.utilities.Normalizer</a></span><span class="p">()</span>
        <span class="n">time_series</span> <span class="o">=</span> <span class="n">normalizer</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span>

        <span class="n">model</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/models.html#Model">aqua_blue.models.Model</a></span><span class="p">(</span>
            <span class="n">reservoir</span><span class="o">=</span><span class="n"><a href="aqua_blue/reservoirs.html#DynamicalReservoir">aqua_blue.reservoirs.DynamicalReservoir</a></span><span class="p">(</span>
                <span class="n">reservoir_dimensionality</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                <span class="n">input_dimensionality</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">activation_function</span><span class="o">=</span><span class="n">activation_functions</span><span class="p">[</span><span class="n">activation_function</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="n">readout</span><span class="o">=</span><span class="n"><a href="aqua_blue/readouts.html#LinearReadout">aqua_blue.readouts.LinearReadout</a></span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span>

        <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="mi">1_000</span><span class="p">)</span>
        <span class="n">prediction</span> <span class="o">=</span> <span class="n">normalizer</span><span class="o">.</span><span class="n">denormalize</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>

        <span class="n">actual_future</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">prediction</span><span class="o">.</span><span class="n">times</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">prediction</span><span class="o">.</span><span class="n">times</span><span class="p">)))</span><span class="o">.</span><span class="n">T</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">prediction</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">actual_future</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">prediction</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">prediction</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;actual_x&#39;</span><span class="p">,</span> <span class="s1">&#39;actual_y&#39;</span><span class="p">,</span> <span class="s1">&#39;predicted_x&#39;</span><span class="p">,</span> <span class="s1">&#39;predicted_y&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">activation_function</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="n">main</span><span class="p">()</span>
</code></pre>
</div>

<h2 id="http-requests"> HTTP Requests</h2>

<p>Below is an example of pulling csv file data from a resource URL using the <a href="https://pypi.org/project/requests/">requests</a> library. 
Here, we retrieve a time series of temperature data from <a href="https://www.ncei.noaa.gov/data/global-summary-of-the-day/access/2024/01001099999.csv">NCEI NOAA</a>
and use it for training and predicting temperatures.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">aqua_blue</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">io</span><span class="w"> </span><span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span> 
    <span class="n">req</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://www.ncei.noaa.gov/data/global-summary-of-the-day/access/2024/01001099999.csv&quot;</span><span class="p">)</span>

    <span class="n">time_col</span> <span class="o">=</span> <span class="s2">&quot;DATE&quot;</span>
    <span class="n">dependent_var_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;TEMP&quot;</span><span class="p">]</span>

    <span class="k">with</span> <span class="n">BytesIO</span><span class="p">()</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">txt</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">text</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">txt</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
        <span class="n">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">DATA</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/time_series.html#TimeSeries.from_csv">aqua_blue.time_series.TimeSeries.from_csv</a></span><span class="p">(</span>
            <span class="n">fp</span><span class="o">=</span><span class="n">file</span><span class="p">,</span>
            <span class="n">time_col</span><span class="o">=</span><span class="n">time_col</span><span class="p">,</span>
            <span class="n">dependent_var_cols</span><span class="o">=</span><span class="n">dependent_var_cols</span><span class="p">,</span>
            <span class="n">times_dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[s]&#39;</span><span class="p">,</span>
            <span class="n">max_rows</span><span class="o">=</span><span class="mi">87</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">TRAIN_DATA</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/time_series.html#TimeSeries">aqua_blue.time_series.TimeSeries</a></span><span class="p">(</span>
        <span class="n">times</span><span class="o">=</span><span class="n">DATA</span><span class="o">.</span><span class="n">times</span><span class="p">[:</span><span class="mi">82</span><span class="p">],</span> 
        <span class="n">dependent_variable</span><span class="o">=</span><span class="n">DATA</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">[:</span><span class="mi">82</span><span class="p">,</span> <span class="p">:]</span>
    <span class="p">)</span>

    <span class="n">normalizer</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/utilities.html#Normalizer">aqua_blue.utilities.Normalizer</a></span><span class="p">()</span>
    <span class="n">normalized_time_series</span> <span class="o">=</span> <span class="n">normalizer</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">TRAIN_DATA</span><span class="p">)</span>

    <span class="n">seed</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
    <span class="n">generator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

    <span class="n">w_res</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
        <span class="n">low</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">high</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">w_in</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
        <span class="n">low</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">high</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/models.html#Model">aqua_blue.models.Model</a></span><span class="p">(</span>
        <span class="n">reservoir</span><span class="o">=</span><span class="n"><a href="aqua_blue/reservoirs.html#DynamicalReservoir">aqua_blue.reservoirs.DynamicalReservoir</a></span><span class="p">(</span>
            <span class="n">reservoir_dimensionality</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
            <span class="n">w_in</span> <span class="o">=</span> <span class="n">w_in</span><span class="p">,</span>
            <span class="n">w_res</span> <span class="o">=</span> <span class="n">w_res</span><span class="p">,</span>
            <span class="n">input_dimensionality</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">readout</span><span class="o">=</span><span class="n"><a href="aqua_blue/readouts.html#LinearReadout">aqua_blue.readouts.LinearReadout</a></span><span class="p">(</span><span class="mf">1e-1</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">normalized_time_series</span><span class="p">)</span>

    <span class="n">horizon</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="n">horizon</span><span class="p">)</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">normalizer</span><span class="o">.</span><span class="n">denormalize</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>

    <span class="n">concatenated</span> <span class="o">=</span> <span class="n">TRAIN_DATA</span> <span class="o">&gt;&gt;</span> <span class="n">prediction</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">concatenated</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">concatenated</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicted Future&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">DATA</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">DATA</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual Future&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span> 
    <span class="n">main</span><span class="p">()</span>
</code></pre>
</div>

<h2 id="read-from-and-write-to-csv-files"> Read from and write to CSV files</h2>

<p>Below is an example of parsing data from a csv file (<code>goldstocks.csv</code>) and writing it to a <code>TimeSeries</code> object, which is used for training and predictions. 
The predictions are written to a new csv file (<code>predicted-goldstocks.csv</code>).</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">aqua_blue</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span> 

    <span class="n">goldstocks</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/time_series.html#TimeSeries.from_csv">aqua_blue.time_series.TimeSeries.from_csv</a></span><span class="p">(</span>
        <span class="n">fp</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;examples/goldstocks.csv&#39;</span><span class="p">),</span> 
        <span class="n">time_col</span><span class="o">=</span><span class="s1">&#39;DATE&#39;</span><span class="p">,</span>
        <span class="n">times_dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[s]&#39;</span><span class="p">,</span>
        <span class="n">dependent_var_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="n">normalizer</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/utilities.html#Normalizer">aqua_blue.utilities.Normalizer</a></span><span class="p">()</span>
    <span class="n">normalized_time_series</span> <span class="o">=</span> <span class="n">normalizer</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">goldstocks</span><span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/models.html#Model">aqua_blue.models.Model</a></span><span class="p">(</span>
        <span class="n">reservoir</span><span class="o">=</span><span class="n"><a href="aqua_blue/reservoirs.html#DynamicalReservoir">aqua_blue.reservoirs.DynamicalReservoir</a></span><span class="p">(</span>
            <span class="n">reservoir_dimensionality</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
            <span class="n">input_dimensionality</span><span class="o">=</span><span class="mi">5</span>
        <span class="p">),</span>
        <span class="n">readout</span><span class="o">=</span><span class="n"><a href="aqua_blue/readouts.html#LinearReadout">aqua_blue.readouts.LinearReadout</a></span><span class="p">()</span>
    <span class="p">)</span>

    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">normalized_time_series</span><span class="p">)</span>

    <span class="n">horizon</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">horizon</span><span class="o">=</span><span class="n">horizon</span><span class="p">)</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">normalizer</span><span class="o">.</span><span class="n">denormalize</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>

    <span class="n">concatenated</span> <span class="o">=</span> <span class="n">goldstocks</span> <span class="o">&gt;&gt;</span> <span class="n">prediction</span>

    <span class="n">concatenated</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
        <span class="n">fp</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;examples/predicted_goldstocks.csv&#39;</span><span class="p">),</span>
        <span class="n">header</span><span class="o">=</span><span class="s1">&#39;DATE,X,Y,Z,A,B&#39;</span><span class="p">,</span>
        <span class="n">fmt</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre>
</div>

<h2 id="logging"> Logging</h2>

<p><code>aqua-blue</code> utilizes the native <code>logging</code> library to do some additional logging. An example of this is below:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">aqua_blue</span>


<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5_000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)))</span><span class="o">.</span><span class="n">T</span>

    <span class="n">time_series</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/time_series.html#TimeSeries">aqua_blue.time_series.TimeSeries</a></span><span class="p">(</span><span class="n">dependent_variable</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
    <span class="n">normalizer</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/utilities.html#Normalizer">aqua_blue.utilities.Normalizer</a></span><span class="p">()</span>
    <span class="n">normalized_time_series</span> <span class="o">=</span> <span class="n">normalizer</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n"><a href="aqua_blue/models.html#Model">aqua_blue.models.Model</a></span><span class="p">(</span>
        <span class="n">reservoir</span><span class="o">=</span><span class="n"><a href="aqua_blue/reservoirs.html#DynamicalReservoir">aqua_blue.reservoirs.DynamicalReservoir</a></span><span class="p">(</span>
            <span class="n">reservoir_dimensionality</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
            <span class="n">input_dimensionality</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">sparsity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">spectral_radius</span><span class="o">=</span><span class="mf">0.95</span>
        <span class="p">),</span>
        <span class="n">readout</span><span class="o">=</span><span class="n"><a href="aqua_blue/readouts.html#LinearReadout">aqua_blue.readouts.LinearReadout</a></span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">normalized_time_series</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="n">main</span><span class="p">()</span>
</code></pre>
</div>

<p>which prints:</p>

<pre><code>INFO:root:times dtype set to float64
INFO:root:times dtype set to float64
DEBUG:root:DynamicalReservoir.w_res sparsity set to 50.67%
DEBUG:root:DynamicalReservoir.w_res spectral radius set to 4.7707258199919655
INFO:root:LinearReadout layer trained. Inaccuracy = 5.025374978118052e-09 and pcc = 1.0
DEBUG:root:Model.timestep set to 0.01
DEBUG:root:Model.final_time set to 49.99
DEBUG:root:Model.tz set to None
DEBUG:root:Model.times_detype set to float64
</code></pre>

<p>For my favorite video about logging in Python, see a wonderful video below by <a href="https://mcoding.io/">mCoding</a>:</p>


</div>

                        <input id="mod-aqua_blue-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-aqua_blue-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">.. include:: ../README.md</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd"># Examples</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">##  Basic Lotka-Volterra example</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">Below is an example of using `aqua-blue` to predict the predator-prey</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">[Lotka-Volterra equations](https://en.wikipedia.org/wiki/Lotka%E2%80%93Volterra_equations):</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="sd">$$ \dot x = \alpha x - \beta xy $$</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="sd">$$ \dot y = -\gamma y + \delta xy$$</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="sd">with parameters $\alpha = 0.1$, $\beta = 0.02$, $\gamma = 0.3$, and $\delta = 0.01$, and initial conditions</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="sd">$(x_0, y_0) = (20, 9)$. We train a reservoir computer with a reservoir dimensionality of $1000$ over $0\leq t\leq 10$,</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="sd">with $1000$ timesteps. Then, we predict the next $1000$ timesteps.</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="sd">Here, we use `scipy.integrate.solve_ivp` to integrate the system of differential equations.</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="sd">```py</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="sd">.. include:: ../examples/lotka-volterra.py</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="sd">```</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">##  Using datetime objects</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">Below is an example of a simple sine-cosine task similar to above, using `datetime.datetime` objects as times.</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">```py</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">.. include:: ../examples/sine-cosine.py</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">```</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">##  Load and output a JSON string</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">Below is an example of inputting a `json` string as the training data, and outputting a `json` string for the</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">prediction. This is particularly useful for interfacing `aqua-blue` with already-existing systems.</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">```py</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">.. include:: ../examples/json-example.py</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">```</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">##  Explicit weights</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">Below is an example of generating explicit matrices for $W_\text{in}$ and $W_\text{res}$. Here, `sparsity=0.99` and</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">`spectral_radius=1.2` respectively zero-out $99\%$ of $W_\text{res}$&#39;s elements and force $W_\text{res}$ to have a</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">[spectral radius](https://en.wikipedia.org/wiki/Spectral_radius) of $1.2$. We also showcase the `&gt;&gt;` operator, which</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">concatenates instances of `aqua_blue.time_series.TimeSeries`.</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">```py</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">.. include:: ../examples/explicit-weights.py</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">```</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">##  Explicit activation function</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">Below is an example of using a different activation function to map from the input state to the reservoir.</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">Here, we use both hyperbolic tangent (`tanh`) and the [error function](https://en.wikipedia.org/wiki/Error_function)</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">(`erf`), and compare the results.</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">```py</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">.. include:: ../examples/activation-functions.py</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">```</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">##  HTTP Requests</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">Below is an example of pulling csv file data from a resource URL using the [requests](https://pypi.org/project/requests/) library. </span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">Here, we retrieve a time series of temperature data from [NCEI NOAA](https://www.ncei.noaa.gov/data/global-summary-of-the-day/access/2024/01001099999.csv)</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">and use it for training and predicting temperatures.</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">```py</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">.. include:: ../examples/apireq-example.py</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">```</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">##  Read from and write to CSV files</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">Below is an example of parsing data from a csv file (`goldstocks.csv`) and writing it to a `TimeSeries` object, which is used for training and predictions. </span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">The predictions are written to a new csv file (`predicted-goldstocks.csv`).</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">```py</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">.. include:: ../examples/csv-example.py</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">```</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">##  Logging</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">`aqua-blue` utilizes the native `logging` library to do some additional logging. An example of this is below:</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">```py</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">.. include:: ../examples/logging-example.py</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">```</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">which prints:</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">```</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">INFO:root:times dtype set to float64</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">INFO:root:times dtype set to float64</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">DEBUG:root:DynamicalReservoir.w_res sparsity set to 50.67%</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">DEBUG:root:DynamicalReservoir.w_res spectral radius set to 4.7707258199919655</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">INFO:root:LinearReadout layer trained. Inaccuracy = 5.025374978118052e-09 and pcc = 1.0</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">DEBUG:root:Model.timestep set to 0.01</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">DEBUG:root:Model.final_time set to 49.99</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">DEBUG:root:Model.tz set to None</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">DEBUG:root:Model.times_detype set to float64</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">```</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">For my favorite video about logging in Python, see a wonderful video below by [mCoding](https://mcoding.io/):</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">&lt;div style=&quot;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; margin: auto;&quot;&gt;</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">  &lt;iframe src=&quot;https://www.youtube-nocookie.com/embed/9L77QExPmI0?si=JE-GParvVMRGA-by&quot;</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">          style=&quot;position: absolute; top: 0; left: 0; width: 100%; height: 100%;&quot;</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">          frameborder=&quot;0&quot;</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="sd">          allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share&quot;</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">          referrerpolicy=&quot;strict-origin-when-cross-origin&quot;</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="sd">          allowfullscreen</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">          title=&quot;YouTube video player&quot;&gt;</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="sd">  &lt;/iframe&gt;</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">&lt;/div&gt;</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;0.2.17&quot;</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a><span class="n">__authors__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>    <span class="s2">&quot;Jacob Jeffries&quot;</span><span class="p">,</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>    <span class="s2">&quot;Hrishikesh Belagali&quot;</span><span class="p">,</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>    <span class="s2">&quot;Avik Thumati&quot;</span><span class="p">,</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>    <span class="s2">&quot;Ameen Mahmood&quot;</span><span class="p">,</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>    <span class="s2">&quot;Jackson Henry&quot;</span><span class="p">,</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>    <span class="s2">&quot;Samuel Josephs&quot;</span><span class="p">,</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a><span class="p">]</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a><span class="n">__author_emails__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>    <span class="s2">&quot;jacob.jeffries@ccmc.global&quot;</span><span class="p">,</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>    <span class="s2">&quot;hrishikesh.belagali@ccmc.global&quot;</span><span class="p">,</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>    <span class="s2">&quot;avik.thumati@ccmc.global&quot;</span><span class="p">,</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>    <span class="s2">&quot;ameen.mahmood@ccmc.global&quot;</span><span class="p">,</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>    <span class="s2">&quot;jackson.henry@ccmc.global&quot;</span><span class="p">,</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>    <span class="s2">&quot;samuel.josephs@ccmc.global&quot;</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a><span class="p">]</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="n">__url__</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/Chicago-Club-Management-Company/aqua-blue&quot;</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">utilities</span> <span class="k">as</span> <span class="n">utilities</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">reservoirs</span> <span class="k">as</span> <span class="n">reservoirs</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">readouts</span> <span class="k">as</span> <span class="n">readouts</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">models</span> <span class="k">as</span> <span class="n">models</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">time_series</span> <span class="k">as</span> <span class="n">time_series</span>
</span></pre></div>


            </section>
    </main>
<!-- End of C:/CodingGeneral/chicagoClubManagement/aqua-blue/_build/aqua_blue.html -->
<!-- Start of C:/CodingGeneral/chicagoClubManagement/aqua-blue/_build/aqua_blue/datetimelikearray.html -->
<nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../aqua_blue.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;aqua_blue</a>

            <img src="https://raw.githubusercontent.com/Chicago-Club-Management-Company/aqua-blue/refs/heads/main/assets/blue.jpg" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#DatetimeLike">DatetimeLike</a>
            </li>
            <li>
                    <a class="variable" href="#TimeDeltaLike">TimeDeltaLike</a>
            </li>
            <li>
                    <a class="class" href="#DatetimeLikeArray">DatetimeLikeArray</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DatetimeLikeArray.__init__">DatetimeLikeArray</a>
                        </li>
                        <li>
                                <a class="variable" href="#DatetimeLikeArray.tz">tz</a>
                        </li>
                        <li>
                                <a class="variable" href="#DatetimeLikeArray.tz_offset">tz_offset</a>
                        </li>
                        <li>
                                <a class="function" href="#DatetimeLikeArray.to_list">to_list</a>
                        </li>
                        <li>
                                <a class="function" href="#DatetimeLikeArray.to_file">to_file</a>
                        </li>
                        <li>
                                <a class="function" href="#DatetimeLikeArray.from_array">from_array</a>
                        </li>
                        <li>
                                <a class="function" href="#DatetimeLikeArray.from_fp">from_fp</a>
                        </li>
                        <li>
                                <a class="function" href="#DatetimeLikeArray.from_iter">from_iter</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../aqua_blue.html">aqua_blue</a><wbr>.datetimelikearray    </h1>

                        <div class="docstring"><p>Module providing a timezone-aware wrapper for NumPy arrays.</p>

<p>Timezone awareness is a deprecated NumPy feature due to the deprecation of pytz.
This module provides a workaround by storing the timezone information separately in the array.
The datetime objects are stored in UTC and converted to the specified timezone when accessed.</p>

<p>This implementation is designed specifically for one-dimensional arrays and is intended to
satisfy the datetime processing requirements of the project, rather than general NumPy timezone integration.</p>
</div>

                        <input id="mod-datetimelikearray-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-datetimelikearray-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">Module providing a timezone-aware wrapper for NumPy arrays.</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">Timezone awareness is a deprecated NumPy feature due to the deprecation of pytz.</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">This module provides a workaround by storing the timezone information separately in the array.</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">The datetime objects are stored in UTC and converted to the specified timezone when accessed.</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">This implementation is designed specifically for one-dimensional arrays and is intended to</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">satisfy the datetime processing requirements of the project, rather than general NumPy timezone integration.</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">IO</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">TypeVar</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Generator</span><span class="p">,</span> <span class="n">Optional</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">zoneinfo</span><span class="w"> </span><span class="kn">import</span> <span class="n">ZoneInfo</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="n">DatetimeLike</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;DatetimeLike&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">)</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="sd">&quot;&quot;&quot;Datetime like, representing either dates or numerical values&quot;&quot;&quot;</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="n">TimeDeltaLike</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;TimeDeltaLike&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">)</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">&quot;&quot;&quot;Corresponding object representing timesteps, which are either float if the two times are floats, or a timedelta&quot;&quot;&quot;</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="k">class</span><span class="w"> </span><span class="nc">DatetimeLikeArray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">    A subclass of NumPy ndarray that provides timezone awareness for datetime arrays.</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">    The timezone information is stored separately since NumPy does not natively support</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">    timezone-aware datetime objects. All datetime values are stored in UTC and converted</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">    back to the specified timezone when accessed.</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>    <span class="n">tz</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The timezone associated with the array. Defaults to None (assumed UTC).&quot;&quot;&quot;</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>    <span class="n">tz_offset</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The timezone offset from UTC for the stored datetime values. Defaults to None.&quot;&quot;&quot;</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">input_array</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">DatetimeLike</span><span class="p">],</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">        Create a new instance of DatetimeLikeArray.</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">        Args:</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">            input_array (Sequence[DatetimeLike]): List of datetime-like objects to be stored in the array.</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">            dtype: Data type for the NumPy array.</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">            buffer: Optional buffer for the array.</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">            offset: Offset for the array.</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">            strides: Strides for the array.</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">            order: Memory layout order.</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">        Returns:</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">            DatetimeLikeArray: A new instance of the class.</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">):</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>            <span class="k">return</span> <span class="n">input_array</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>            <span class="c1"># If input is a list of floats, treat it as a normal NumPy array</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>            <span class="n">new_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">input_array</span><span class="p">)</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>            <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">new_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">strides</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>            <span class="n">obj</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">new_arr</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>            <span class="k">return</span> <span class="n">obj</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>        <span class="c1"># If you pass List[datetime.datetime], then create a timezone aware array of np.datetime64</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>        <span class="c1"># Store the timezone information of the first element</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>        <span class="c1"># This means that all elements must belong to the same timezone.</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>        <span class="n">tz_</span> <span class="o">=</span> <span class="n">input_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tzinfo</span> <span class="k">if</span> <span class="n">input_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tzinfo</span> <span class="k">else</span> <span class="n">ZoneInfo</span><span class="p">(</span><span class="s1">&#39;UTC&#39;</span><span class="p">)</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>        <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">input_array</span><span class="p">:</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>            <span class="n">current_tz</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">tzinfo</span> <span class="k">if</span> <span class="n">dt</span><span class="o">.</span><span class="n">tzinfo</span> <span class="k">else</span> <span class="n">ZoneInfo</span><span class="p">(</span><span class="s1">&#39;UTC&#39;</span><span class="p">)</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>            <span class="k">if</span> <span class="n">current_tz</span> <span class="o">!=</span> <span class="n">tz_</span><span class="p">:</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All elements must belong to the same timezone.&quot;</span><span class="p">)</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>        <span class="c1"># Purge the timezone information from the datetime objects</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>        <span class="n">generator</span> <span class="o">=</span> <span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">input_array</span><span class="p">)</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>        <span class="n">datetime64_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(</span><span class="n">generator</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>        <span class="n">tz_offset_</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz_</span><span class="p">)</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">()</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>        <span class="n">seconds_offset</span> <span class="o">=</span> <span class="n">tz_offset_</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="k">if</span> <span class="n">tz_offset_</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>        <span class="n">np_offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">seconds_offset</span><span class="p">)),</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>        
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>        <span class="k">if</span> <span class="n">seconds_offset</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>            <span class="n">datetime64_array</span> <span class="o">+=</span> <span class="n">np_offset</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>            <span class="n">datetime64_array</span> <span class="o">-=</span> <span class="n">np_offset</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>        
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>        <span class="c1"># Initialize an NDArray and populate with the datetime values</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">datetime64_array</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">strides</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>        <span class="n">obj</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">datetime64_array</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>        
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>        <span class="c1"># Set the timezone and offset of the array</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>        <span class="n">obj</span><span class="o">.</span><span class="n">tz</span> <span class="o">=</span> <span class="n">tz_</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>        <span class="n">obj</span><span class="o">.</span><span class="n">tz_offset</span> <span class="o">=</span> <span class="n">tz_offset_</span> <span class="k">if</span> <span class="n">tz_offset_</span> <span class="k">else</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>        <span class="k">return</span> <span class="n">obj</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a string representation of the array, including timezone information.&quot;&quot;&quot;</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="p">:</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span><span class="si">}</span><span class="s2">, tz=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="sd">        Compare two DatetimeLikeArray instances for equality.</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="sd">        Args:</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">            other (DatetimeLikeArray | np.ndarray): The other array to compare.</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">        Returns:</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="sd">            bool: True if both arrays and their timezones are equal, otherwise False.</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tz</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">tz</span><span class="p">:</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>            <span class="c1"># Due to .tzinfo being abstract, we compare the offsets rather than the timezone objects themselves</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>            <span class="n">tzs_equal</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="p">)</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">()</span> <span class="o">==</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">tz</span><span class="p">)</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">()</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>            <span class="n">arrays_equal</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)))</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>            <span class="k">return</span> <span class="n">arrays_equal</span> <span class="ow">and</span> <span class="n">tzs_equal</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>            <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)))</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">DatetimeLike</span><span class="p">]:</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a><span class="sd">        Convert the array back to a list of datetime-like objects with timezone information.</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a><span class="sd">        Returns:</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a><span class="sd">            List[DatetimeLike]: A list of datetime objects with their original timezone restored.</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>        <span class="n">arr</span><span class="p">[:]</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="p">:</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>            <span class="k">return</span> <span class="n">arr</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>        <span class="c1"># Check if it&#39;s None for type-checking</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>        <span class="n">tz_offset</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tz_offset</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tz_offset</span> <span class="k">else</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>        <span class="n">np_offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tz_offset</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">())),</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>        <span class="k">if</span> <span class="n">tz_offset</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>            <span class="n">offset_arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">-</span> <span class="n">np_offset</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>            <span class="n">offset_arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">+</span> <span class="n">np_offset</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>        <span class="n">list_arr</span> <span class="o">=</span> <span class="n">offset_arr</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>        <span class="n">converted_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="p">)</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">list_arr</span><span class="p">]</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>        <span class="k">return</span> <span class="n">converted_arr</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>    
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">IO</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="n">tz</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a><span class="sd">        Save a DatetimeLikeArray instance to a text file.</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="sd">        Args:</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">            fp (Union[IO, str, Path]): File path or file-like object to write to.</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="sd">            tz (datetime.tzinfo, optional): Timezone in which to write the data.</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>        <span class="n">arr</span><span class="p">[:]</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="p">:</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>            <span class="k">return</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>        <span class="n">tz_offset</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="p">)</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">()</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>        <span class="n">seconds_offset</span> <span class="o">=</span> <span class="n">tz_offset</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="k">if</span> <span class="n">tz_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>        <span class="n">np_offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">seconds_offset</span><span class="p">)),</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>        <span class="k">if</span> <span class="n">seconds_offset</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>            <span class="n">offset_arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">-</span> <span class="n">np_offset</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>            <span class="n">offset_arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">+</span> <span class="n">np_offset</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>        <span class="n">offset_arr</span> <span class="o">=</span> <span class="n">offset_arr</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>        <span class="n">replaced_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">offset_arr</span><span class="p">]</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">replaced_arr</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_array</span><span class="p">(</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>        <span class="n">input_array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">]],</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>        <span class="n">tz</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>    <span class="p">):</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a><span class="sd">        Convert a numpy array to a DatetimeLikeArray instance.</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a><span class="sd">        </span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a><span class="sd">        Args:</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a><span class="sd">            input_array (np.ndarray): NumPy array containing datetime values.</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a><span class="sd">            tz (datetime.tzinfo, optional): Timezone of the input datetime values.</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a><span class="sd">        Returns:</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a><span class="sd">            DatetimeLikeArray: A new instance with timezone awareness.</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>        <span class="n">array</span> <span class="o">=</span> <span class="n">input_array</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>        <span class="k">if</span> <span class="n">tz</span><span class="p">:</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>            <span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="n">tz</span><span class="p">)</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">array</span><span class="p">]</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">input_array</span><span class="o">=</span><span class="n">array</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">input_array</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_fp</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">IO</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="n">tz</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a><span class="sd">        Load a text file and convert it to a DatetimeLikeArray instance.</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a><span class="sd">        Args:</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a><span class="sd">            fp (Union[IO, str, Path]): File path or file-like object to read from.</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a><span class="sd">            dtype (Type): Data type of the values in the file.</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a><span class="sd">            tz (datetime.tzinfo, optional): Timezone to assign to the loaded data.</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a><span class="sd">        </span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a><span class="sd">        Returns:</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a><span class="sd">            DatetimeLikeArray: A new instance with timezone awareness.</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">tz</span><span class="p">:</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">input_array</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>        <span class="n">dtype_</span> <span class="o">=</span> <span class="s1">&#39;datetime64[s]&#39;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">dtype</span> <span class="k">else</span> <span class="n">dtype</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype_</span><span class="p">)</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">input_array</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="n">tz</span><span class="p">)</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>    
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>    <span class="nd">@classmethod</span> 
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_iter</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">gen</span><span class="p">:</span> <span class="n">Generator</span><span class="p">[</span><span class="n">DatetimeLike</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="n">tz</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a><span class="sd">        </span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a><span class="sd">        Create a DatetimeLikeArray object from an Iterable with DatetimeLike yields</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a><span class="sd">        Args:</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a><span class="sd">            gen (Generator[DatetimeLike, None, None]): A generator that yields DatetimeLike values</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a><span class="sd">            dtype (Type): Data type of the values in the file.</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a><span class="sd">            tz (datetime.tzinfo, optional): Timezone to assign to the loaded data.</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a><span class="sd">        </span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a><span class="sd">        Returns:</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a><span class="sd">            DatetimeLikeArray: A new instance with timezone awareness.</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper_gen</span><span class="p">(</span><span class="n">gen</span><span class="p">):</span> 
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>            
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">:</span> 
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>                
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>                <span class="c1"># If it is timezone-aware, remove the timezone</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span> 
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>                    <span class="n">a</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>                    <span class="k">yield</span> <span class="n">a</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>                
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>                <span class="k">else</span><span class="p">:</span> 
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>                    <span class="k">yield</span> <span class="n">value</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>        
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>        <span class="n">naive_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(</span><span class="n">wrapper_gen</span><span class="p">(</span><span class="n">gen</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>        
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>        <span class="k">if</span> <span class="n">tz</span><span class="p">:</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>            <span class="n">tz_offset_</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="p">)</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">()</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>            <span class="n">seconds_offset</span> <span class="o">=</span> <span class="n">tz_offset_</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="k">if</span> <span class="n">tz_offset_</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>            <span class="n">np_offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">seconds_offset</span><span class="p">)),</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>            
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>            <span class="k">if</span> <span class="n">seconds_offset</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>                <span class="n">naive_array</span> <span class="o">+=</span> <span class="n">np_offset</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>                <span class="n">naive_array</span> <span class="o">-=</span> <span class="n">np_offset</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>            
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>            <span class="c1"># Initialize an NDArray and populate with the datetime values</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>            <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">naive_array</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>            <span class="n">obj</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">naive_array</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>            
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>            <span class="c1"># Set the timezone and offset of the array</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>            <span class="n">obj</span><span class="o">.</span><span class="n">tz</span> <span class="o">=</span> <span class="n">tz</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>            <span class="n">obj</span><span class="o">.</span><span class="n">tz_offset</span> <span class="o">=</span> <span class="n">tz_offset_</span> <span class="k">if</span> <span class="n">tz_offset_</span> <span class="k">else</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>            <span class="k">return</span> <span class="n">obj</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>        
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">naive_array</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>        <span class="n">obj</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">naive_array</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>        <span class="k">return</span> <span class="n">obj</span>
</span></pre></div>


            </section>
                <section id="DatetimeLike">
                    <div class="attr variable">
            <span class="name">DatetimeLike</span>        =
<span class="default_value">~DatetimeLike</span>

        
    </div>
    <a class="headerlink" href="#DatetimeLike"></a>
    
            <div class="docstring"><p>Datetime like, representing either dates or numerical values</p>
</div>


                </section>
                <section id="TimeDeltaLike">
                    <div class="attr variable">
            <span class="name">TimeDeltaLike</span>        =
<span class="default_value">~TimeDeltaLike</span>

        
    </div>
    <a class="headerlink" href="#TimeDeltaLike"></a>
    
            <div class="docstring"><p>Corresponding object representing timesteps, which are either float if the two times are floats, or a timedelta</p>
</div>


                </section>
                <section id="DatetimeLikeArray">
                            <input id="DatetimeLikeArray-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DatetimeLikeArray</span><wbr>(<span class="base">numpy.ndarray</span>):

                <label class="view-source-button" for="DatetimeLikeArray-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DatetimeLikeArray"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DatetimeLikeArray-30"><a href="#DatetimeLikeArray-30"><span class="linenos"> 30</span></a><span class="k">class</span><span class="w"> </span><span class="nc">DatetimeLikeArray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="DatetimeLikeArray-31"><a href="#DatetimeLikeArray-31"><span class="linenos"> 31</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray-32"><a href="#DatetimeLikeArray-32"><span class="linenos"> 32</span></a><span class="sd">    A subclass of NumPy ndarray that provides timezone awareness for datetime arrays.</span>
</span><span id="DatetimeLikeArray-33"><a href="#DatetimeLikeArray-33"><span class="linenos"> 33</span></a>
</span><span id="DatetimeLikeArray-34"><a href="#DatetimeLikeArray-34"><span class="linenos"> 34</span></a><span class="sd">    The timezone information is stored separately since NumPy does not natively support</span>
</span><span id="DatetimeLikeArray-35"><a href="#DatetimeLikeArray-35"><span class="linenos"> 35</span></a><span class="sd">    timezone-aware datetime objects. All datetime values are stored in UTC and converted</span>
</span><span id="DatetimeLikeArray-36"><a href="#DatetimeLikeArray-36"><span class="linenos"> 36</span></a><span class="sd">    back to the specified timezone when accessed.</span>
</span><span id="DatetimeLikeArray-37"><a href="#DatetimeLikeArray-37"><span class="linenos"> 37</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray-38"><a href="#DatetimeLikeArray-38"><span class="linenos"> 38</span></a>
</span><span id="DatetimeLikeArray-39"><a href="#DatetimeLikeArray-39"><span class="linenos"> 39</span></a>    <span class="n">tz</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DatetimeLikeArray-40"><a href="#DatetimeLikeArray-40"><span class="linenos"> 40</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The timezone associated with the array. Defaults to None (assumed UTC).&quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray-41"><a href="#DatetimeLikeArray-41"><span class="linenos"> 41</span></a>
</span><span id="DatetimeLikeArray-42"><a href="#DatetimeLikeArray-42"><span class="linenos"> 42</span></a>    <span class="n">tz_offset</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DatetimeLikeArray-43"><a href="#DatetimeLikeArray-43"><span class="linenos"> 43</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The timezone offset from UTC for the stored datetime values. Defaults to None.&quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray-44"><a href="#DatetimeLikeArray-44"><span class="linenos"> 44</span></a>
</span><span id="DatetimeLikeArray-45"><a href="#DatetimeLikeArray-45"><span class="linenos"> 45</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">input_array</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">DatetimeLike</span><span class="p">],</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="DatetimeLikeArray-46"><a href="#DatetimeLikeArray-46"><span class="linenos"> 46</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray-47"><a href="#DatetimeLikeArray-47"><span class="linenos"> 47</span></a><span class="sd">        Create a new instance of DatetimeLikeArray.</span>
</span><span id="DatetimeLikeArray-48"><a href="#DatetimeLikeArray-48"><span class="linenos"> 48</span></a>
</span><span id="DatetimeLikeArray-49"><a href="#DatetimeLikeArray-49"><span class="linenos"> 49</span></a><span class="sd">        Args:</span>
</span><span id="DatetimeLikeArray-50"><a href="#DatetimeLikeArray-50"><span class="linenos"> 50</span></a><span class="sd">            input_array (Sequence[DatetimeLike]): List of datetime-like objects to be stored in the array.</span>
</span><span id="DatetimeLikeArray-51"><a href="#DatetimeLikeArray-51"><span class="linenos"> 51</span></a><span class="sd">            dtype: Data type for the NumPy array.</span>
</span><span id="DatetimeLikeArray-52"><a href="#DatetimeLikeArray-52"><span class="linenos"> 52</span></a><span class="sd">            buffer: Optional buffer for the array.</span>
</span><span id="DatetimeLikeArray-53"><a href="#DatetimeLikeArray-53"><span class="linenos"> 53</span></a><span class="sd">            offset: Offset for the array.</span>
</span><span id="DatetimeLikeArray-54"><a href="#DatetimeLikeArray-54"><span class="linenos"> 54</span></a><span class="sd">            strides: Strides for the array.</span>
</span><span id="DatetimeLikeArray-55"><a href="#DatetimeLikeArray-55"><span class="linenos"> 55</span></a><span class="sd">            order: Memory layout order.</span>
</span><span id="DatetimeLikeArray-56"><a href="#DatetimeLikeArray-56"><span class="linenos"> 56</span></a>
</span><span id="DatetimeLikeArray-57"><a href="#DatetimeLikeArray-57"><span class="linenos"> 57</span></a><span class="sd">        Returns:</span>
</span><span id="DatetimeLikeArray-58"><a href="#DatetimeLikeArray-58"><span class="linenos"> 58</span></a><span class="sd">            DatetimeLikeArray: A new instance of the class.</span>
</span><span id="DatetimeLikeArray-59"><a href="#DatetimeLikeArray-59"><span class="linenos"> 59</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray-60"><a href="#DatetimeLikeArray-60"><span class="linenos"> 60</span></a>
</span><span id="DatetimeLikeArray-61"><a href="#DatetimeLikeArray-61"><span class="linenos"> 61</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">):</span>
</span><span id="DatetimeLikeArray-62"><a href="#DatetimeLikeArray-62"><span class="linenos"> 62</span></a>            <span class="k">return</span> <span class="n">input_array</span>
</span><span id="DatetimeLikeArray-63"><a href="#DatetimeLikeArray-63"><span class="linenos"> 63</span></a>
</span><span id="DatetimeLikeArray-64"><a href="#DatetimeLikeArray-64"><span class="linenos"> 64</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
</span><span id="DatetimeLikeArray-65"><a href="#DatetimeLikeArray-65"><span class="linenos"> 65</span></a>            <span class="c1"># If input is a list of floats, treat it as a normal NumPy array</span>
</span><span id="DatetimeLikeArray-66"><a href="#DatetimeLikeArray-66"><span class="linenos"> 66</span></a>            <span class="n">new_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">input_array</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-67"><a href="#DatetimeLikeArray-67"><span class="linenos"> 67</span></a>            <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">new_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">strides</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-68"><a href="#DatetimeLikeArray-68"><span class="linenos"> 68</span></a>            <span class="n">obj</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">new_arr</span>
</span><span id="DatetimeLikeArray-69"><a href="#DatetimeLikeArray-69"><span class="linenos"> 69</span></a>            <span class="k">return</span> <span class="n">obj</span>
</span><span id="DatetimeLikeArray-70"><a href="#DatetimeLikeArray-70"><span class="linenos"> 70</span></a>
</span><span id="DatetimeLikeArray-71"><a href="#DatetimeLikeArray-71"><span class="linenos"> 71</span></a>        <span class="c1"># If you pass List[datetime.datetime], then create a timezone aware array of np.datetime64</span>
</span><span id="DatetimeLikeArray-72"><a href="#DatetimeLikeArray-72"><span class="linenos"> 72</span></a>        <span class="c1"># Store the timezone information of the first element</span>
</span><span id="DatetimeLikeArray-73"><a href="#DatetimeLikeArray-73"><span class="linenos"> 73</span></a>        <span class="c1"># This means that all elements must belong to the same timezone.</span>
</span><span id="DatetimeLikeArray-74"><a href="#DatetimeLikeArray-74"><span class="linenos"> 74</span></a>        <span class="n">tz_</span> <span class="o">=</span> <span class="n">input_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tzinfo</span> <span class="k">if</span> <span class="n">input_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tzinfo</span> <span class="k">else</span> <span class="n">ZoneInfo</span><span class="p">(</span><span class="s1">&#39;UTC&#39;</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-75"><a href="#DatetimeLikeArray-75"><span class="linenos"> 75</span></a>
</span><span id="DatetimeLikeArray-76"><a href="#DatetimeLikeArray-76"><span class="linenos"> 76</span></a>        <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">input_array</span><span class="p">:</span>
</span><span id="DatetimeLikeArray-77"><a href="#DatetimeLikeArray-77"><span class="linenos"> 77</span></a>            <span class="n">current_tz</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">tzinfo</span> <span class="k">if</span> <span class="n">dt</span><span class="o">.</span><span class="n">tzinfo</span> <span class="k">else</span> <span class="n">ZoneInfo</span><span class="p">(</span><span class="s1">&#39;UTC&#39;</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-78"><a href="#DatetimeLikeArray-78"><span class="linenos"> 78</span></a>            <span class="k">if</span> <span class="n">current_tz</span> <span class="o">!=</span> <span class="n">tz_</span><span class="p">:</span>
</span><span id="DatetimeLikeArray-79"><a href="#DatetimeLikeArray-79"><span class="linenos"> 79</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All elements must belong to the same timezone.&quot;</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-80"><a href="#DatetimeLikeArray-80"><span class="linenos"> 80</span></a>
</span><span id="DatetimeLikeArray-81"><a href="#DatetimeLikeArray-81"><span class="linenos"> 81</span></a>        <span class="c1"># Purge the timezone information from the datetime objects</span>
</span><span id="DatetimeLikeArray-82"><a href="#DatetimeLikeArray-82"><span class="linenos"> 82</span></a>        <span class="n">generator</span> <span class="o">=</span> <span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">input_array</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-83"><a href="#DatetimeLikeArray-83"><span class="linenos"> 83</span></a>        <span class="n">datetime64_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(</span><span class="n">generator</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-84"><a href="#DatetimeLikeArray-84"><span class="linenos"> 84</span></a>        <span class="n">tz_offset_</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz_</span><span class="p">)</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">()</span>
</span><span id="DatetimeLikeArray-85"><a href="#DatetimeLikeArray-85"><span class="linenos"> 85</span></a>        <span class="n">seconds_offset</span> <span class="o">=</span> <span class="n">tz_offset_</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="k">if</span> <span class="n">tz_offset_</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="DatetimeLikeArray-86"><a href="#DatetimeLikeArray-86"><span class="linenos"> 86</span></a>        <span class="n">np_offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">seconds_offset</span><span class="p">)),</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-87"><a href="#DatetimeLikeArray-87"><span class="linenos"> 87</span></a>        
</span><span id="DatetimeLikeArray-88"><a href="#DatetimeLikeArray-88"><span class="linenos"> 88</span></a>        <span class="k">if</span> <span class="n">seconds_offset</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DatetimeLikeArray-89"><a href="#DatetimeLikeArray-89"><span class="linenos"> 89</span></a>            <span class="n">datetime64_array</span> <span class="o">+=</span> <span class="n">np_offset</span>
</span><span id="DatetimeLikeArray-90"><a href="#DatetimeLikeArray-90"><span class="linenos"> 90</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DatetimeLikeArray-91"><a href="#DatetimeLikeArray-91"><span class="linenos"> 91</span></a>            <span class="n">datetime64_array</span> <span class="o">-=</span> <span class="n">np_offset</span>
</span><span id="DatetimeLikeArray-92"><a href="#DatetimeLikeArray-92"><span class="linenos"> 92</span></a>        
</span><span id="DatetimeLikeArray-93"><a href="#DatetimeLikeArray-93"><span class="linenos"> 93</span></a>        <span class="c1"># Initialize an NDArray and populate with the datetime values</span>
</span><span id="DatetimeLikeArray-94"><a href="#DatetimeLikeArray-94"><span class="linenos"> 94</span></a>        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">datetime64_array</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">strides</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-95"><a href="#DatetimeLikeArray-95"><span class="linenos"> 95</span></a>        <span class="n">obj</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">datetime64_array</span>
</span><span id="DatetimeLikeArray-96"><a href="#DatetimeLikeArray-96"><span class="linenos"> 96</span></a>        
</span><span id="DatetimeLikeArray-97"><a href="#DatetimeLikeArray-97"><span class="linenos"> 97</span></a>        <span class="c1"># Set the timezone and offset of the array</span>
</span><span id="DatetimeLikeArray-98"><a href="#DatetimeLikeArray-98"><span class="linenos"> 98</span></a>        <span class="n">obj</span><span class="o">.</span><span class="n">tz</span> <span class="o">=</span> <span class="n">tz_</span>
</span><span id="DatetimeLikeArray-99"><a href="#DatetimeLikeArray-99"><span class="linenos"> 99</span></a>        <span class="n">obj</span><span class="o">.</span><span class="n">tz_offset</span> <span class="o">=</span> <span class="n">tz_offset_</span> <span class="k">if</span> <span class="n">tz_offset_</span> <span class="k">else</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-100"><a href="#DatetimeLikeArray-100"><span class="linenos">100</span></a>        <span class="k">return</span> <span class="n">obj</span>
</span><span id="DatetimeLikeArray-101"><a href="#DatetimeLikeArray-101"><span class="linenos">101</span></a>
</span><span id="DatetimeLikeArray-102"><a href="#DatetimeLikeArray-102"><span class="linenos">102</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="DatetimeLikeArray-103"><a href="#DatetimeLikeArray-103"><span class="linenos">103</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a string representation of the array, including timezone information.&quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray-104"><a href="#DatetimeLikeArray-104"><span class="linenos">104</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="p">:</span>
</span><span id="DatetimeLikeArray-105"><a href="#DatetimeLikeArray-105"><span class="linenos">105</span></a>            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span><span class="si">}</span><span class="s2">, tz=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="DatetimeLikeArray-106"><a href="#DatetimeLikeArray-106"><span class="linenos">106</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="DatetimeLikeArray-107"><a href="#DatetimeLikeArray-107"><span class="linenos">107</span></a>
</span><span id="DatetimeLikeArray-108"><a href="#DatetimeLikeArray-108"><span class="linenos">108</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="DatetimeLikeArray-109"><a href="#DatetimeLikeArray-109"><span class="linenos">109</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray-110"><a href="#DatetimeLikeArray-110"><span class="linenos">110</span></a><span class="sd">        Compare two DatetimeLikeArray instances for equality.</span>
</span><span id="DatetimeLikeArray-111"><a href="#DatetimeLikeArray-111"><span class="linenos">111</span></a>
</span><span id="DatetimeLikeArray-112"><a href="#DatetimeLikeArray-112"><span class="linenos">112</span></a><span class="sd">        Args:</span>
</span><span id="DatetimeLikeArray-113"><a href="#DatetimeLikeArray-113"><span class="linenos">113</span></a><span class="sd">            other (DatetimeLikeArray | np.ndarray): The other array to compare.</span>
</span><span id="DatetimeLikeArray-114"><a href="#DatetimeLikeArray-114"><span class="linenos">114</span></a>
</span><span id="DatetimeLikeArray-115"><a href="#DatetimeLikeArray-115"><span class="linenos">115</span></a><span class="sd">        Returns:</span>
</span><span id="DatetimeLikeArray-116"><a href="#DatetimeLikeArray-116"><span class="linenos">116</span></a><span class="sd">            bool: True if both arrays and their timezones are equal, otherwise False.</span>
</span><span id="DatetimeLikeArray-117"><a href="#DatetimeLikeArray-117"><span class="linenos">117</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray-118"><a href="#DatetimeLikeArray-118"><span class="linenos">118</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tz</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">tz</span><span class="p">:</span>
</span><span id="DatetimeLikeArray-119"><a href="#DatetimeLikeArray-119"><span class="linenos">119</span></a>            <span class="c1"># Due to .tzinfo being abstract, we compare the offsets rather than the timezone objects themselves</span>
</span><span id="DatetimeLikeArray-120"><a href="#DatetimeLikeArray-120"><span class="linenos">120</span></a>            <span class="n">tzs_equal</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="p">)</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">()</span> <span class="o">==</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">tz</span><span class="p">)</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">()</span>
</span><span id="DatetimeLikeArray-121"><a href="#DatetimeLikeArray-121"><span class="linenos">121</span></a>            <span class="n">arrays_equal</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)))</span>
</span><span id="DatetimeLikeArray-122"><a href="#DatetimeLikeArray-122"><span class="linenos">122</span></a>            <span class="k">return</span> <span class="n">arrays_equal</span> <span class="ow">and</span> <span class="n">tzs_equal</span>
</span><span id="DatetimeLikeArray-123"><a href="#DatetimeLikeArray-123"><span class="linenos">123</span></a>
</span><span id="DatetimeLikeArray-124"><a href="#DatetimeLikeArray-124"><span class="linenos">124</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="DatetimeLikeArray-125"><a href="#DatetimeLikeArray-125"><span class="linenos">125</span></a>            <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)))</span>
</span><span id="DatetimeLikeArray-126"><a href="#DatetimeLikeArray-126"><span class="linenos">126</span></a>
</span><span id="DatetimeLikeArray-127"><a href="#DatetimeLikeArray-127"><span class="linenos">127</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="DatetimeLikeArray-128"><a href="#DatetimeLikeArray-128"><span class="linenos">128</span></a>
</span><span id="DatetimeLikeArray-129"><a href="#DatetimeLikeArray-129"><span class="linenos">129</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">DatetimeLike</span><span class="p">]:</span>
</span><span id="DatetimeLikeArray-130"><a href="#DatetimeLikeArray-130"><span class="linenos">130</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray-131"><a href="#DatetimeLikeArray-131"><span class="linenos">131</span></a><span class="sd">        Convert the array back to a list of datetime-like objects with timezone information.</span>
</span><span id="DatetimeLikeArray-132"><a href="#DatetimeLikeArray-132"><span class="linenos">132</span></a>
</span><span id="DatetimeLikeArray-133"><a href="#DatetimeLikeArray-133"><span class="linenos">133</span></a><span class="sd">        Returns:</span>
</span><span id="DatetimeLikeArray-134"><a href="#DatetimeLikeArray-134"><span class="linenos">134</span></a><span class="sd">            List[DatetimeLike]: A list of datetime objects with their original timezone restored.</span>
</span><span id="DatetimeLikeArray-135"><a href="#DatetimeLikeArray-135"><span class="linenos">135</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray-136"><a href="#DatetimeLikeArray-136"><span class="linenos">136</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-137"><a href="#DatetimeLikeArray-137"><span class="linenos">137</span></a>        <span class="n">arr</span><span class="p">[:]</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="DatetimeLikeArray-138"><a href="#DatetimeLikeArray-138"><span class="linenos">138</span></a>
</span><span id="DatetimeLikeArray-139"><a href="#DatetimeLikeArray-139"><span class="linenos">139</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="p">:</span>
</span><span id="DatetimeLikeArray-140"><a href="#DatetimeLikeArray-140"><span class="linenos">140</span></a>            <span class="k">return</span> <span class="n">arr</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="DatetimeLikeArray-141"><a href="#DatetimeLikeArray-141"><span class="linenos">141</span></a>
</span><span id="DatetimeLikeArray-142"><a href="#DatetimeLikeArray-142"><span class="linenos">142</span></a>        <span class="c1"># Check if it&#39;s None for type-checking</span>
</span><span id="DatetimeLikeArray-143"><a href="#DatetimeLikeArray-143"><span class="linenos">143</span></a>        <span class="n">tz_offset</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tz_offset</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tz_offset</span> <span class="k">else</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-144"><a href="#DatetimeLikeArray-144"><span class="linenos">144</span></a>        <span class="n">np_offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tz_offset</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">())),</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-145"><a href="#DatetimeLikeArray-145"><span class="linenos">145</span></a>
</span><span id="DatetimeLikeArray-146"><a href="#DatetimeLikeArray-146"><span class="linenos">146</span></a>        <span class="k">if</span> <span class="n">tz_offset</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DatetimeLikeArray-147"><a href="#DatetimeLikeArray-147"><span class="linenos">147</span></a>            <span class="n">offset_arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">-</span> <span class="n">np_offset</span>
</span><span id="DatetimeLikeArray-148"><a href="#DatetimeLikeArray-148"><span class="linenos">148</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DatetimeLikeArray-149"><a href="#DatetimeLikeArray-149"><span class="linenos">149</span></a>            <span class="n">offset_arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">+</span> <span class="n">np_offset</span>
</span><span id="DatetimeLikeArray-150"><a href="#DatetimeLikeArray-150"><span class="linenos">150</span></a>
</span><span id="DatetimeLikeArray-151"><a href="#DatetimeLikeArray-151"><span class="linenos">151</span></a>        <span class="n">list_arr</span> <span class="o">=</span> <span class="n">offset_arr</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="DatetimeLikeArray-152"><a href="#DatetimeLikeArray-152"><span class="linenos">152</span></a>        <span class="n">converted_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="p">)</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">list_arr</span><span class="p">]</span>
</span><span id="DatetimeLikeArray-153"><a href="#DatetimeLikeArray-153"><span class="linenos">153</span></a>
</span><span id="DatetimeLikeArray-154"><a href="#DatetimeLikeArray-154"><span class="linenos">154</span></a>        <span class="k">return</span> <span class="n">converted_arr</span>
</span><span id="DatetimeLikeArray-155"><a href="#DatetimeLikeArray-155"><span class="linenos">155</span></a>    
</span><span id="DatetimeLikeArray-156"><a href="#DatetimeLikeArray-156"><span class="linenos">156</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">IO</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="n">tz</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="DatetimeLikeArray-157"><a href="#DatetimeLikeArray-157"><span class="linenos">157</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray-158"><a href="#DatetimeLikeArray-158"><span class="linenos">158</span></a><span class="sd">        Save a DatetimeLikeArray instance to a text file.</span>
</span><span id="DatetimeLikeArray-159"><a href="#DatetimeLikeArray-159"><span class="linenos">159</span></a>
</span><span id="DatetimeLikeArray-160"><a href="#DatetimeLikeArray-160"><span class="linenos">160</span></a><span class="sd">        Args:</span>
</span><span id="DatetimeLikeArray-161"><a href="#DatetimeLikeArray-161"><span class="linenos">161</span></a><span class="sd">            fp (Union[IO, str, Path]): File path or file-like object to write to.</span>
</span><span id="DatetimeLikeArray-162"><a href="#DatetimeLikeArray-162"><span class="linenos">162</span></a><span class="sd">            tz (datetime.tzinfo, optional): Timezone in which to write the data.</span>
</span><span id="DatetimeLikeArray-163"><a href="#DatetimeLikeArray-163"><span class="linenos">163</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray-164"><a href="#DatetimeLikeArray-164"><span class="linenos">164</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-165"><a href="#DatetimeLikeArray-165"><span class="linenos">165</span></a>        <span class="n">arr</span><span class="p">[:]</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="DatetimeLikeArray-166"><a href="#DatetimeLikeArray-166"><span class="linenos">166</span></a>
</span><span id="DatetimeLikeArray-167"><a href="#DatetimeLikeArray-167"><span class="linenos">167</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="p">:</span>
</span><span id="DatetimeLikeArray-168"><a href="#DatetimeLikeArray-168"><span class="linenos">168</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-169"><a href="#DatetimeLikeArray-169"><span class="linenos">169</span></a>            <span class="k">return</span>
</span><span id="DatetimeLikeArray-170"><a href="#DatetimeLikeArray-170"><span class="linenos">170</span></a>
</span><span id="DatetimeLikeArray-171"><a href="#DatetimeLikeArray-171"><span class="linenos">171</span></a>        <span class="n">tz_offset</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="p">)</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">()</span>
</span><span id="DatetimeLikeArray-172"><a href="#DatetimeLikeArray-172"><span class="linenos">172</span></a>        <span class="n">seconds_offset</span> <span class="o">=</span> <span class="n">tz_offset</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="k">if</span> <span class="n">tz_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="DatetimeLikeArray-173"><a href="#DatetimeLikeArray-173"><span class="linenos">173</span></a>        <span class="n">np_offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">seconds_offset</span><span class="p">)),</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-174"><a href="#DatetimeLikeArray-174"><span class="linenos">174</span></a>
</span><span id="DatetimeLikeArray-175"><a href="#DatetimeLikeArray-175"><span class="linenos">175</span></a>        <span class="k">if</span> <span class="n">seconds_offset</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DatetimeLikeArray-176"><a href="#DatetimeLikeArray-176"><span class="linenos">176</span></a>            <span class="n">offset_arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">-</span> <span class="n">np_offset</span>
</span><span id="DatetimeLikeArray-177"><a href="#DatetimeLikeArray-177"><span class="linenos">177</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DatetimeLikeArray-178"><a href="#DatetimeLikeArray-178"><span class="linenos">178</span></a>            <span class="n">offset_arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">+</span> <span class="n">np_offset</span>
</span><span id="DatetimeLikeArray-179"><a href="#DatetimeLikeArray-179"><span class="linenos">179</span></a>
</span><span id="DatetimeLikeArray-180"><a href="#DatetimeLikeArray-180"><span class="linenos">180</span></a>        <span class="n">offset_arr</span> <span class="o">=</span> <span class="n">offset_arr</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="DatetimeLikeArray-181"><a href="#DatetimeLikeArray-181"><span class="linenos">181</span></a>        <span class="n">replaced_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">offset_arr</span><span class="p">]</span>
</span><span id="DatetimeLikeArray-182"><a href="#DatetimeLikeArray-182"><span class="linenos">182</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">replaced_arr</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-183"><a href="#DatetimeLikeArray-183"><span class="linenos">183</span></a>
</span><span id="DatetimeLikeArray-184"><a href="#DatetimeLikeArray-184"><span class="linenos">184</span></a>    <span class="nd">@classmethod</span>
</span><span id="DatetimeLikeArray-185"><a href="#DatetimeLikeArray-185"><span class="linenos">185</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_array</span><span class="p">(</span>
</span><span id="DatetimeLikeArray-186"><a href="#DatetimeLikeArray-186"><span class="linenos">186</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="DatetimeLikeArray-187"><a href="#DatetimeLikeArray-187"><span class="linenos">187</span></a>        <span class="n">input_array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">]],</span>
</span><span id="DatetimeLikeArray-188"><a href="#DatetimeLikeArray-188"><span class="linenos">188</span></a>        <span class="n">tz</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DatetimeLikeArray-189"><a href="#DatetimeLikeArray-189"><span class="linenos">189</span></a>    <span class="p">):</span>
</span><span id="DatetimeLikeArray-190"><a href="#DatetimeLikeArray-190"><span class="linenos">190</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray-191"><a href="#DatetimeLikeArray-191"><span class="linenos">191</span></a><span class="sd">        Convert a numpy array to a DatetimeLikeArray instance.</span>
</span><span id="DatetimeLikeArray-192"><a href="#DatetimeLikeArray-192"><span class="linenos">192</span></a><span class="sd">        </span>
</span><span id="DatetimeLikeArray-193"><a href="#DatetimeLikeArray-193"><span class="linenos">193</span></a><span class="sd">        Args:</span>
</span><span id="DatetimeLikeArray-194"><a href="#DatetimeLikeArray-194"><span class="linenos">194</span></a><span class="sd">            input_array (np.ndarray): NumPy array containing datetime values.</span>
</span><span id="DatetimeLikeArray-195"><a href="#DatetimeLikeArray-195"><span class="linenos">195</span></a><span class="sd">            tz (datetime.tzinfo, optional): Timezone of the input datetime values.</span>
</span><span id="DatetimeLikeArray-196"><a href="#DatetimeLikeArray-196"><span class="linenos">196</span></a>
</span><span id="DatetimeLikeArray-197"><a href="#DatetimeLikeArray-197"><span class="linenos">197</span></a><span class="sd">        Returns:</span>
</span><span id="DatetimeLikeArray-198"><a href="#DatetimeLikeArray-198"><span class="linenos">198</span></a><span class="sd">            DatetimeLikeArray: A new instance with timezone awareness.</span>
</span><span id="DatetimeLikeArray-199"><a href="#DatetimeLikeArray-199"><span class="linenos">199</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray-200"><a href="#DatetimeLikeArray-200"><span class="linenos">200</span></a>        <span class="n">array</span> <span class="o">=</span> <span class="n">input_array</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="DatetimeLikeArray-201"><a href="#DatetimeLikeArray-201"><span class="linenos">201</span></a>
</span><span id="DatetimeLikeArray-202"><a href="#DatetimeLikeArray-202"><span class="linenos">202</span></a>        <span class="k">if</span> <span class="n">tz</span><span class="p">:</span>
</span><span id="DatetimeLikeArray-203"><a href="#DatetimeLikeArray-203"><span class="linenos">203</span></a>            <span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="n">tz</span><span class="p">)</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">array</span><span class="p">]</span>
</span><span id="DatetimeLikeArray-204"><a href="#DatetimeLikeArray-204"><span class="linenos">204</span></a>
</span><span id="DatetimeLikeArray-205"><a href="#DatetimeLikeArray-205"><span class="linenos">205</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">input_array</span><span class="o">=</span><span class="n">array</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">input_array</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-206"><a href="#DatetimeLikeArray-206"><span class="linenos">206</span></a>
</span><span id="DatetimeLikeArray-207"><a href="#DatetimeLikeArray-207"><span class="linenos">207</span></a>    <span class="nd">@classmethod</span>
</span><span id="DatetimeLikeArray-208"><a href="#DatetimeLikeArray-208"><span class="linenos">208</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_fp</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">IO</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="n">tz</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="DatetimeLikeArray-209"><a href="#DatetimeLikeArray-209"><span class="linenos">209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray-210"><a href="#DatetimeLikeArray-210"><span class="linenos">210</span></a><span class="sd">        Load a text file and convert it to a DatetimeLikeArray instance.</span>
</span><span id="DatetimeLikeArray-211"><a href="#DatetimeLikeArray-211"><span class="linenos">211</span></a>
</span><span id="DatetimeLikeArray-212"><a href="#DatetimeLikeArray-212"><span class="linenos">212</span></a><span class="sd">        Args:</span>
</span><span id="DatetimeLikeArray-213"><a href="#DatetimeLikeArray-213"><span class="linenos">213</span></a><span class="sd">            fp (Union[IO, str, Path]): File path or file-like object to read from.</span>
</span><span id="DatetimeLikeArray-214"><a href="#DatetimeLikeArray-214"><span class="linenos">214</span></a><span class="sd">            dtype (Type): Data type of the values in the file.</span>
</span><span id="DatetimeLikeArray-215"><a href="#DatetimeLikeArray-215"><span class="linenos">215</span></a><span class="sd">            tz (datetime.tzinfo, optional): Timezone to assign to the loaded data.</span>
</span><span id="DatetimeLikeArray-216"><a href="#DatetimeLikeArray-216"><span class="linenos">216</span></a><span class="sd">        </span>
</span><span id="DatetimeLikeArray-217"><a href="#DatetimeLikeArray-217"><span class="linenos">217</span></a><span class="sd">        Returns:</span>
</span><span id="DatetimeLikeArray-218"><a href="#DatetimeLikeArray-218"><span class="linenos">218</span></a><span class="sd">            DatetimeLikeArray: A new instance with timezone awareness.</span>
</span><span id="DatetimeLikeArray-219"><a href="#DatetimeLikeArray-219"><span class="linenos">219</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray-220"><a href="#DatetimeLikeArray-220"><span class="linenos">220</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">tz</span><span class="p">:</span>
</span><span id="DatetimeLikeArray-221"><a href="#DatetimeLikeArray-221"><span class="linenos">221</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-222"><a href="#DatetimeLikeArray-222"><span class="linenos">222</span></a>            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">input_array</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-223"><a href="#DatetimeLikeArray-223"><span class="linenos">223</span></a>
</span><span id="DatetimeLikeArray-224"><a href="#DatetimeLikeArray-224"><span class="linenos">224</span></a>        <span class="n">dtype_</span> <span class="o">=</span> <span class="s1">&#39;datetime64[s]&#39;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">dtype</span> <span class="k">else</span> <span class="n">dtype</span>
</span><span id="DatetimeLikeArray-225"><a href="#DatetimeLikeArray-225"><span class="linenos">225</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype_</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-226"><a href="#DatetimeLikeArray-226"><span class="linenos">226</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">input_array</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="n">tz</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-227"><a href="#DatetimeLikeArray-227"><span class="linenos">227</span></a>    
</span><span id="DatetimeLikeArray-228"><a href="#DatetimeLikeArray-228"><span class="linenos">228</span></a>    <span class="nd">@classmethod</span> 
</span><span id="DatetimeLikeArray-229"><a href="#DatetimeLikeArray-229"><span class="linenos">229</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_iter</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">gen</span><span class="p">:</span> <span class="n">Generator</span><span class="p">[</span><span class="n">DatetimeLike</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="n">tz</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="DatetimeLikeArray-230"><a href="#DatetimeLikeArray-230"><span class="linenos">230</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray-231"><a href="#DatetimeLikeArray-231"><span class="linenos">231</span></a><span class="sd">        </span>
</span><span id="DatetimeLikeArray-232"><a href="#DatetimeLikeArray-232"><span class="linenos">232</span></a><span class="sd">        Create a DatetimeLikeArray object from an Iterable with DatetimeLike yields</span>
</span><span id="DatetimeLikeArray-233"><a href="#DatetimeLikeArray-233"><span class="linenos">233</span></a>
</span><span id="DatetimeLikeArray-234"><a href="#DatetimeLikeArray-234"><span class="linenos">234</span></a><span class="sd">        Args:</span>
</span><span id="DatetimeLikeArray-235"><a href="#DatetimeLikeArray-235"><span class="linenos">235</span></a><span class="sd">            gen (Generator[DatetimeLike, None, None]): A generator that yields DatetimeLike values</span>
</span><span id="DatetimeLikeArray-236"><a href="#DatetimeLikeArray-236"><span class="linenos">236</span></a><span class="sd">            dtype (Type): Data type of the values in the file.</span>
</span><span id="DatetimeLikeArray-237"><a href="#DatetimeLikeArray-237"><span class="linenos">237</span></a><span class="sd">            tz (datetime.tzinfo, optional): Timezone to assign to the loaded data.</span>
</span><span id="DatetimeLikeArray-238"><a href="#DatetimeLikeArray-238"><span class="linenos">238</span></a><span class="sd">        </span>
</span><span id="DatetimeLikeArray-239"><a href="#DatetimeLikeArray-239"><span class="linenos">239</span></a><span class="sd">        Returns:</span>
</span><span id="DatetimeLikeArray-240"><a href="#DatetimeLikeArray-240"><span class="linenos">240</span></a><span class="sd">            DatetimeLikeArray: A new instance with timezone awareness.</span>
</span><span id="DatetimeLikeArray-241"><a href="#DatetimeLikeArray-241"><span class="linenos">241</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray-242"><a href="#DatetimeLikeArray-242"><span class="linenos">242</span></a>
</span><span id="DatetimeLikeArray-243"><a href="#DatetimeLikeArray-243"><span class="linenos">243</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper_gen</span><span class="p">(</span><span class="n">gen</span><span class="p">):</span> 
</span><span id="DatetimeLikeArray-244"><a href="#DatetimeLikeArray-244"><span class="linenos">244</span></a>            
</span><span id="DatetimeLikeArray-245"><a href="#DatetimeLikeArray-245"><span class="linenos">245</span></a>            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">:</span> 
</span><span id="DatetimeLikeArray-246"><a href="#DatetimeLikeArray-246"><span class="linenos">246</span></a>                
</span><span id="DatetimeLikeArray-247"><a href="#DatetimeLikeArray-247"><span class="linenos">247</span></a>                <span class="c1"># If it is timezone-aware, remove the timezone</span>
</span><span id="DatetimeLikeArray-248"><a href="#DatetimeLikeArray-248"><span class="linenos">248</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span> 
</span><span id="DatetimeLikeArray-249"><a href="#DatetimeLikeArray-249"><span class="linenos">249</span></a>                    <span class="n">a</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-250"><a href="#DatetimeLikeArray-250"><span class="linenos">250</span></a>                    <span class="k">yield</span> <span class="n">a</span>
</span><span id="DatetimeLikeArray-251"><a href="#DatetimeLikeArray-251"><span class="linenos">251</span></a>                
</span><span id="DatetimeLikeArray-252"><a href="#DatetimeLikeArray-252"><span class="linenos">252</span></a>                <span class="k">else</span><span class="p">:</span> 
</span><span id="DatetimeLikeArray-253"><a href="#DatetimeLikeArray-253"><span class="linenos">253</span></a>                    <span class="k">yield</span> <span class="n">value</span>
</span><span id="DatetimeLikeArray-254"><a href="#DatetimeLikeArray-254"><span class="linenos">254</span></a>        
</span><span id="DatetimeLikeArray-255"><a href="#DatetimeLikeArray-255"><span class="linenos">255</span></a>        <span class="n">naive_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(</span><span class="n">wrapper_gen</span><span class="p">(</span><span class="n">gen</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-256"><a href="#DatetimeLikeArray-256"><span class="linenos">256</span></a>        
</span><span id="DatetimeLikeArray-257"><a href="#DatetimeLikeArray-257"><span class="linenos">257</span></a>        <span class="k">if</span> <span class="n">tz</span><span class="p">:</span>
</span><span id="DatetimeLikeArray-258"><a href="#DatetimeLikeArray-258"><span class="linenos">258</span></a>            <span class="n">tz_offset_</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="p">)</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">()</span>
</span><span id="DatetimeLikeArray-259"><a href="#DatetimeLikeArray-259"><span class="linenos">259</span></a>            <span class="n">seconds_offset</span> <span class="o">=</span> <span class="n">tz_offset_</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="k">if</span> <span class="n">tz_offset_</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="DatetimeLikeArray-260"><a href="#DatetimeLikeArray-260"><span class="linenos">260</span></a>            <span class="n">np_offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">seconds_offset</span><span class="p">)),</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-261"><a href="#DatetimeLikeArray-261"><span class="linenos">261</span></a>            
</span><span id="DatetimeLikeArray-262"><a href="#DatetimeLikeArray-262"><span class="linenos">262</span></a>            <span class="k">if</span> <span class="n">seconds_offset</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DatetimeLikeArray-263"><a href="#DatetimeLikeArray-263"><span class="linenos">263</span></a>                <span class="n">naive_array</span> <span class="o">+=</span> <span class="n">np_offset</span>
</span><span id="DatetimeLikeArray-264"><a href="#DatetimeLikeArray-264"><span class="linenos">264</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DatetimeLikeArray-265"><a href="#DatetimeLikeArray-265"><span class="linenos">265</span></a>                <span class="n">naive_array</span> <span class="o">-=</span> <span class="n">np_offset</span>
</span><span id="DatetimeLikeArray-266"><a href="#DatetimeLikeArray-266"><span class="linenos">266</span></a>            
</span><span id="DatetimeLikeArray-267"><a href="#DatetimeLikeArray-267"><span class="linenos">267</span></a>            <span class="c1"># Initialize an NDArray and populate with the datetime values</span>
</span><span id="DatetimeLikeArray-268"><a href="#DatetimeLikeArray-268"><span class="linenos">268</span></a>            <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">naive_array</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-269"><a href="#DatetimeLikeArray-269"><span class="linenos">269</span></a>            <span class="n">obj</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">naive_array</span>
</span><span id="DatetimeLikeArray-270"><a href="#DatetimeLikeArray-270"><span class="linenos">270</span></a>            
</span><span id="DatetimeLikeArray-271"><a href="#DatetimeLikeArray-271"><span class="linenos">271</span></a>            <span class="c1"># Set the timezone and offset of the array</span>
</span><span id="DatetimeLikeArray-272"><a href="#DatetimeLikeArray-272"><span class="linenos">272</span></a>            <span class="n">obj</span><span class="o">.</span><span class="n">tz</span> <span class="o">=</span> <span class="n">tz</span>
</span><span id="DatetimeLikeArray-273"><a href="#DatetimeLikeArray-273"><span class="linenos">273</span></a>            <span class="n">obj</span><span class="o">.</span><span class="n">tz_offset</span> <span class="o">=</span> <span class="n">tz_offset_</span> <span class="k">if</span> <span class="n">tz_offset_</span> <span class="k">else</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-274"><a href="#DatetimeLikeArray-274"><span class="linenos">274</span></a>            <span class="k">return</span> <span class="n">obj</span>
</span><span id="DatetimeLikeArray-275"><a href="#DatetimeLikeArray-275"><span class="linenos">275</span></a>        
</span><span id="DatetimeLikeArray-276"><a href="#DatetimeLikeArray-276"><span class="linenos">276</span></a>        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">naive_array</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
</span><span id="DatetimeLikeArray-277"><a href="#DatetimeLikeArray-277"><span class="linenos">277</span></a>        <span class="n">obj</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">naive_array</span>
</span><span id="DatetimeLikeArray-278"><a href="#DatetimeLikeArray-278"><span class="linenos">278</span></a>        <span class="k">return</span> <span class="n">obj</span>
</span></pre></div>


            <div class="docstring"><p>A subclass of NumPy ndarray that provides timezone awareness for datetime arrays.</p>

<p>The timezone information is stored separately since NumPy does not natively support
timezone-aware datetime objects. All datetime values are stored in UTC and converted
back to the specified timezone when accessed.</p>
</div>


                            <div id="DatetimeLikeArray.__init__" class="classattr">
                                        <input id="DatetimeLikeArray.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">DatetimeLikeArray</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">input_array</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="o">~</span><span class="n">DatetimeLike</span><span class="p">]</span>,</span><span class="param">	<span class="n">dtype</span>,</span><span class="param">	<span class="n">buffer</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">offset</span><span class="o">=</span><span class="mi">0</span>,</span><span class="param">	<span class="n">strides</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">order</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="DatetimeLikeArray.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DatetimeLikeArray.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DatetimeLikeArray.__init__-45"><a href="#DatetimeLikeArray.__init__-45"><span class="linenos"> 45</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">input_array</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">DatetimeLike</span><span class="p">],</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="DatetimeLikeArray.__init__-46"><a href="#DatetimeLikeArray.__init__-46"><span class="linenos"> 46</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray.__init__-47"><a href="#DatetimeLikeArray.__init__-47"><span class="linenos"> 47</span></a><span class="sd">        Create a new instance of DatetimeLikeArray.</span>
</span><span id="DatetimeLikeArray.__init__-48"><a href="#DatetimeLikeArray.__init__-48"><span class="linenos"> 48</span></a>
</span><span id="DatetimeLikeArray.__init__-49"><a href="#DatetimeLikeArray.__init__-49"><span class="linenos"> 49</span></a><span class="sd">        Args:</span>
</span><span id="DatetimeLikeArray.__init__-50"><a href="#DatetimeLikeArray.__init__-50"><span class="linenos"> 50</span></a><span class="sd">            input_array (Sequence[DatetimeLike]): List of datetime-like objects to be stored in the array.</span>
</span><span id="DatetimeLikeArray.__init__-51"><a href="#DatetimeLikeArray.__init__-51"><span class="linenos"> 51</span></a><span class="sd">            dtype: Data type for the NumPy array.</span>
</span><span id="DatetimeLikeArray.__init__-52"><a href="#DatetimeLikeArray.__init__-52"><span class="linenos"> 52</span></a><span class="sd">            buffer: Optional buffer for the array.</span>
</span><span id="DatetimeLikeArray.__init__-53"><a href="#DatetimeLikeArray.__init__-53"><span class="linenos"> 53</span></a><span class="sd">            offset: Offset for the array.</span>
</span><span id="DatetimeLikeArray.__init__-54"><a href="#DatetimeLikeArray.__init__-54"><span class="linenos"> 54</span></a><span class="sd">            strides: Strides for the array.</span>
</span><span id="DatetimeLikeArray.__init__-55"><a href="#DatetimeLikeArray.__init__-55"><span class="linenos"> 55</span></a><span class="sd">            order: Memory layout order.</span>
</span><span id="DatetimeLikeArray.__init__-56"><a href="#DatetimeLikeArray.__init__-56"><span class="linenos"> 56</span></a>
</span><span id="DatetimeLikeArray.__init__-57"><a href="#DatetimeLikeArray.__init__-57"><span class="linenos"> 57</span></a><span class="sd">        Returns:</span>
</span><span id="DatetimeLikeArray.__init__-58"><a href="#DatetimeLikeArray.__init__-58"><span class="linenos"> 58</span></a><span class="sd">            DatetimeLikeArray: A new instance of the class.</span>
</span><span id="DatetimeLikeArray.__init__-59"><a href="#DatetimeLikeArray.__init__-59"><span class="linenos"> 59</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray.__init__-60"><a href="#DatetimeLikeArray.__init__-60"><span class="linenos"> 60</span></a>
</span><span id="DatetimeLikeArray.__init__-61"><a href="#DatetimeLikeArray.__init__-61"><span class="linenos"> 61</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">):</span>
</span><span id="DatetimeLikeArray.__init__-62"><a href="#DatetimeLikeArray.__init__-62"><span class="linenos"> 62</span></a>            <span class="k">return</span> <span class="n">input_array</span>
</span><span id="DatetimeLikeArray.__init__-63"><a href="#DatetimeLikeArray.__init__-63"><span class="linenos"> 63</span></a>
</span><span id="DatetimeLikeArray.__init__-64"><a href="#DatetimeLikeArray.__init__-64"><span class="linenos"> 64</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
</span><span id="DatetimeLikeArray.__init__-65"><a href="#DatetimeLikeArray.__init__-65"><span class="linenos"> 65</span></a>            <span class="c1"># If input is a list of floats, treat it as a normal NumPy array</span>
</span><span id="DatetimeLikeArray.__init__-66"><a href="#DatetimeLikeArray.__init__-66"><span class="linenos"> 66</span></a>            <span class="n">new_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">input_array</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.__init__-67"><a href="#DatetimeLikeArray.__init__-67"><span class="linenos"> 67</span></a>            <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">new_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">strides</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.__init__-68"><a href="#DatetimeLikeArray.__init__-68"><span class="linenos"> 68</span></a>            <span class="n">obj</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">new_arr</span>
</span><span id="DatetimeLikeArray.__init__-69"><a href="#DatetimeLikeArray.__init__-69"><span class="linenos"> 69</span></a>            <span class="k">return</span> <span class="n">obj</span>
</span><span id="DatetimeLikeArray.__init__-70"><a href="#DatetimeLikeArray.__init__-70"><span class="linenos"> 70</span></a>
</span><span id="DatetimeLikeArray.__init__-71"><a href="#DatetimeLikeArray.__init__-71"><span class="linenos"> 71</span></a>        <span class="c1"># If you pass List[datetime.datetime], then create a timezone aware array of np.datetime64</span>
</span><span id="DatetimeLikeArray.__init__-72"><a href="#DatetimeLikeArray.__init__-72"><span class="linenos"> 72</span></a>        <span class="c1"># Store the timezone information of the first element</span>
</span><span id="DatetimeLikeArray.__init__-73"><a href="#DatetimeLikeArray.__init__-73"><span class="linenos"> 73</span></a>        <span class="c1"># This means that all elements must belong to the same timezone.</span>
</span><span id="DatetimeLikeArray.__init__-74"><a href="#DatetimeLikeArray.__init__-74"><span class="linenos"> 74</span></a>        <span class="n">tz_</span> <span class="o">=</span> <span class="n">input_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tzinfo</span> <span class="k">if</span> <span class="n">input_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tzinfo</span> <span class="k">else</span> <span class="n">ZoneInfo</span><span class="p">(</span><span class="s1">&#39;UTC&#39;</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.__init__-75"><a href="#DatetimeLikeArray.__init__-75"><span class="linenos"> 75</span></a>
</span><span id="DatetimeLikeArray.__init__-76"><a href="#DatetimeLikeArray.__init__-76"><span class="linenos"> 76</span></a>        <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">input_array</span><span class="p">:</span>
</span><span id="DatetimeLikeArray.__init__-77"><a href="#DatetimeLikeArray.__init__-77"><span class="linenos"> 77</span></a>            <span class="n">current_tz</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">tzinfo</span> <span class="k">if</span> <span class="n">dt</span><span class="o">.</span><span class="n">tzinfo</span> <span class="k">else</span> <span class="n">ZoneInfo</span><span class="p">(</span><span class="s1">&#39;UTC&#39;</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.__init__-78"><a href="#DatetimeLikeArray.__init__-78"><span class="linenos"> 78</span></a>            <span class="k">if</span> <span class="n">current_tz</span> <span class="o">!=</span> <span class="n">tz_</span><span class="p">:</span>
</span><span id="DatetimeLikeArray.__init__-79"><a href="#DatetimeLikeArray.__init__-79"><span class="linenos"> 79</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All elements must belong to the same timezone.&quot;</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.__init__-80"><a href="#DatetimeLikeArray.__init__-80"><span class="linenos"> 80</span></a>
</span><span id="DatetimeLikeArray.__init__-81"><a href="#DatetimeLikeArray.__init__-81"><span class="linenos"> 81</span></a>        <span class="c1"># Purge the timezone information from the datetime objects</span>
</span><span id="DatetimeLikeArray.__init__-82"><a href="#DatetimeLikeArray.__init__-82"><span class="linenos"> 82</span></a>        <span class="n">generator</span> <span class="o">=</span> <span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">input_array</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.__init__-83"><a href="#DatetimeLikeArray.__init__-83"><span class="linenos"> 83</span></a>        <span class="n">datetime64_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(</span><span class="n">generator</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.__init__-84"><a href="#DatetimeLikeArray.__init__-84"><span class="linenos"> 84</span></a>        <span class="n">tz_offset_</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz_</span><span class="p">)</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">()</span>
</span><span id="DatetimeLikeArray.__init__-85"><a href="#DatetimeLikeArray.__init__-85"><span class="linenos"> 85</span></a>        <span class="n">seconds_offset</span> <span class="o">=</span> <span class="n">tz_offset_</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="k">if</span> <span class="n">tz_offset_</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="DatetimeLikeArray.__init__-86"><a href="#DatetimeLikeArray.__init__-86"><span class="linenos"> 86</span></a>        <span class="n">np_offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">seconds_offset</span><span class="p">)),</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.__init__-87"><a href="#DatetimeLikeArray.__init__-87"><span class="linenos"> 87</span></a>        
</span><span id="DatetimeLikeArray.__init__-88"><a href="#DatetimeLikeArray.__init__-88"><span class="linenos"> 88</span></a>        <span class="k">if</span> <span class="n">seconds_offset</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DatetimeLikeArray.__init__-89"><a href="#DatetimeLikeArray.__init__-89"><span class="linenos"> 89</span></a>            <span class="n">datetime64_array</span> <span class="o">+=</span> <span class="n">np_offset</span>
</span><span id="DatetimeLikeArray.__init__-90"><a href="#DatetimeLikeArray.__init__-90"><span class="linenos"> 90</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DatetimeLikeArray.__init__-91"><a href="#DatetimeLikeArray.__init__-91"><span class="linenos"> 91</span></a>            <span class="n">datetime64_array</span> <span class="o">-=</span> <span class="n">np_offset</span>
</span><span id="DatetimeLikeArray.__init__-92"><a href="#DatetimeLikeArray.__init__-92"><span class="linenos"> 92</span></a>        
</span><span id="DatetimeLikeArray.__init__-93"><a href="#DatetimeLikeArray.__init__-93"><span class="linenos"> 93</span></a>        <span class="c1"># Initialize an NDArray and populate with the datetime values</span>
</span><span id="DatetimeLikeArray.__init__-94"><a href="#DatetimeLikeArray.__init__-94"><span class="linenos"> 94</span></a>        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">datetime64_array</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">strides</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.__init__-95"><a href="#DatetimeLikeArray.__init__-95"><span class="linenos"> 95</span></a>        <span class="n">obj</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">datetime64_array</span>
</span><span id="DatetimeLikeArray.__init__-96"><a href="#DatetimeLikeArray.__init__-96"><span class="linenos"> 96</span></a>        
</span><span id="DatetimeLikeArray.__init__-97"><a href="#DatetimeLikeArray.__init__-97"><span class="linenos"> 97</span></a>        <span class="c1"># Set the timezone and offset of the array</span>
</span><span id="DatetimeLikeArray.__init__-98"><a href="#DatetimeLikeArray.__init__-98"><span class="linenos"> 98</span></a>        <span class="n">obj</span><span class="o">.</span><span class="n">tz</span> <span class="o">=</span> <span class="n">tz_</span>
</span><span id="DatetimeLikeArray.__init__-99"><a href="#DatetimeLikeArray.__init__-99"><span class="linenos"> 99</span></a>        <span class="n">obj</span><span class="o">.</span><span class="n">tz_offset</span> <span class="o">=</span> <span class="n">tz_offset_</span> <span class="k">if</span> <span class="n">tz_offset_</span> <span class="k">else</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.__init__-100"><a href="#DatetimeLikeArray.__init__-100"><span class="linenos">100</span></a>        <span class="k">return</span> <span class="n">obj</span>
</span></pre></div>


            <div class="docstring"><p>Create a new instance of DatetimeLikeArray.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>input_array (Sequence[DatetimeLike]):</strong>  List of datetime-like objects to be stored in the array.</li>
<li><strong>dtype:</strong>  Data type for the NumPy array.</li>
<li><strong>buffer:</strong>  Optional buffer for the array.</li>
<li><strong>offset:</strong>  Offset for the array.</li>
<li><strong>strides:</strong>  Strides for the array.</li>
<li><strong>order:</strong>  Memory layout order.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>DatetimeLikeArray: A new instance of the class.</p>
</blockquote>
</div>


                            </div>
                            <div id="DatetimeLikeArray.tz" class="classattr">
                                <div class="attr variable">
            <span class="name">tz</span><span class="annotation">: Optional[datetime.tzinfo]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#DatetimeLikeArray.tz"></a>
    
            <div class="docstring"><p>The timezone associated with the array. Defaults to None (assumed UTC).</p>
</div>


                            </div>
                            <div id="DatetimeLikeArray.tz_offset" class="classattr">
                                <div class="attr variable">
            <span class="name">tz_offset</span><span class="annotation">: Optional[datetime.timedelta]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#DatetimeLikeArray.tz_offset"></a>
    
            <div class="docstring"><p>The timezone offset from UTC for the stored datetime values. Defaults to None.</p>
</div>


                            </div>
                            <div id="DatetimeLikeArray.to_list" class="classattr">
                                        <input id="DatetimeLikeArray.to_list-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_list</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="o">~</span><span class="n">DatetimeLike</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="DatetimeLikeArray.to_list-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DatetimeLikeArray.to_list"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DatetimeLikeArray.to_list-129"><a href="#DatetimeLikeArray.to_list-129"><span class="linenos">129</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">DatetimeLike</span><span class="p">]:</span>
</span><span id="DatetimeLikeArray.to_list-130"><a href="#DatetimeLikeArray.to_list-130"><span class="linenos">130</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray.to_list-131"><a href="#DatetimeLikeArray.to_list-131"><span class="linenos">131</span></a><span class="sd">        Convert the array back to a list of datetime-like objects with timezone information.</span>
</span><span id="DatetimeLikeArray.to_list-132"><a href="#DatetimeLikeArray.to_list-132"><span class="linenos">132</span></a>
</span><span id="DatetimeLikeArray.to_list-133"><a href="#DatetimeLikeArray.to_list-133"><span class="linenos">133</span></a><span class="sd">        Returns:</span>
</span><span id="DatetimeLikeArray.to_list-134"><a href="#DatetimeLikeArray.to_list-134"><span class="linenos">134</span></a><span class="sd">            List[DatetimeLike]: A list of datetime objects with their original timezone restored.</span>
</span><span id="DatetimeLikeArray.to_list-135"><a href="#DatetimeLikeArray.to_list-135"><span class="linenos">135</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray.to_list-136"><a href="#DatetimeLikeArray.to_list-136"><span class="linenos">136</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.to_list-137"><a href="#DatetimeLikeArray.to_list-137"><span class="linenos">137</span></a>        <span class="n">arr</span><span class="p">[:]</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="DatetimeLikeArray.to_list-138"><a href="#DatetimeLikeArray.to_list-138"><span class="linenos">138</span></a>
</span><span id="DatetimeLikeArray.to_list-139"><a href="#DatetimeLikeArray.to_list-139"><span class="linenos">139</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="p">:</span>
</span><span id="DatetimeLikeArray.to_list-140"><a href="#DatetimeLikeArray.to_list-140"><span class="linenos">140</span></a>            <span class="k">return</span> <span class="n">arr</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="DatetimeLikeArray.to_list-141"><a href="#DatetimeLikeArray.to_list-141"><span class="linenos">141</span></a>
</span><span id="DatetimeLikeArray.to_list-142"><a href="#DatetimeLikeArray.to_list-142"><span class="linenos">142</span></a>        <span class="c1"># Check if it&#39;s None for type-checking</span>
</span><span id="DatetimeLikeArray.to_list-143"><a href="#DatetimeLikeArray.to_list-143"><span class="linenos">143</span></a>        <span class="n">tz_offset</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tz_offset</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tz_offset</span> <span class="k">else</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.to_list-144"><a href="#DatetimeLikeArray.to_list-144"><span class="linenos">144</span></a>        <span class="n">np_offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tz_offset</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">())),</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.to_list-145"><a href="#DatetimeLikeArray.to_list-145"><span class="linenos">145</span></a>
</span><span id="DatetimeLikeArray.to_list-146"><a href="#DatetimeLikeArray.to_list-146"><span class="linenos">146</span></a>        <span class="k">if</span> <span class="n">tz_offset</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DatetimeLikeArray.to_list-147"><a href="#DatetimeLikeArray.to_list-147"><span class="linenos">147</span></a>            <span class="n">offset_arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">-</span> <span class="n">np_offset</span>
</span><span id="DatetimeLikeArray.to_list-148"><a href="#DatetimeLikeArray.to_list-148"><span class="linenos">148</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DatetimeLikeArray.to_list-149"><a href="#DatetimeLikeArray.to_list-149"><span class="linenos">149</span></a>            <span class="n">offset_arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">+</span> <span class="n">np_offset</span>
</span><span id="DatetimeLikeArray.to_list-150"><a href="#DatetimeLikeArray.to_list-150"><span class="linenos">150</span></a>
</span><span id="DatetimeLikeArray.to_list-151"><a href="#DatetimeLikeArray.to_list-151"><span class="linenos">151</span></a>        <span class="n">list_arr</span> <span class="o">=</span> <span class="n">offset_arr</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="DatetimeLikeArray.to_list-152"><a href="#DatetimeLikeArray.to_list-152"><span class="linenos">152</span></a>        <span class="n">converted_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="p">)</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">list_arr</span><span class="p">]</span>
</span><span id="DatetimeLikeArray.to_list-153"><a href="#DatetimeLikeArray.to_list-153"><span class="linenos">153</span></a>
</span><span id="DatetimeLikeArray.to_list-154"><a href="#DatetimeLikeArray.to_list-154"><span class="linenos">154</span></a>        <span class="k">return</span> <span class="n">converted_arr</span>
</span></pre></div>


            <div class="docstring"><p>Convert the array back to a list of datetime-like objects with timezone information.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>List[DatetimeLike]: A list of datetime objects with their original timezone restored.</p>
</blockquote>
</div>


                            </div>
                            <div id="DatetimeLikeArray.to_file" class="classattr">
                                        <input id="DatetimeLikeArray.to_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_file</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">IO</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span>,</span><span class="param">	<span class="n">tz</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DatetimeLikeArray.to_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DatetimeLikeArray.to_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DatetimeLikeArray.to_file-156"><a href="#DatetimeLikeArray.to_file-156"><span class="linenos">156</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">IO</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="n">tz</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="DatetimeLikeArray.to_file-157"><a href="#DatetimeLikeArray.to_file-157"><span class="linenos">157</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray.to_file-158"><a href="#DatetimeLikeArray.to_file-158"><span class="linenos">158</span></a><span class="sd">        Save a DatetimeLikeArray instance to a text file.</span>
</span><span id="DatetimeLikeArray.to_file-159"><a href="#DatetimeLikeArray.to_file-159"><span class="linenos">159</span></a>
</span><span id="DatetimeLikeArray.to_file-160"><a href="#DatetimeLikeArray.to_file-160"><span class="linenos">160</span></a><span class="sd">        Args:</span>
</span><span id="DatetimeLikeArray.to_file-161"><a href="#DatetimeLikeArray.to_file-161"><span class="linenos">161</span></a><span class="sd">            fp (Union[IO, str, Path]): File path or file-like object to write to.</span>
</span><span id="DatetimeLikeArray.to_file-162"><a href="#DatetimeLikeArray.to_file-162"><span class="linenos">162</span></a><span class="sd">            tz (datetime.tzinfo, optional): Timezone in which to write the data.</span>
</span><span id="DatetimeLikeArray.to_file-163"><a href="#DatetimeLikeArray.to_file-163"><span class="linenos">163</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray.to_file-164"><a href="#DatetimeLikeArray.to_file-164"><span class="linenos">164</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.to_file-165"><a href="#DatetimeLikeArray.to_file-165"><span class="linenos">165</span></a>        <span class="n">arr</span><span class="p">[:]</span> <span class="o">=</span> <span class="bp">self</span>
</span><span id="DatetimeLikeArray.to_file-166"><a href="#DatetimeLikeArray.to_file-166"><span class="linenos">166</span></a>
</span><span id="DatetimeLikeArray.to_file-167"><a href="#DatetimeLikeArray.to_file-167"><span class="linenos">167</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="p">:</span>
</span><span id="DatetimeLikeArray.to_file-168"><a href="#DatetimeLikeArray.to_file-168"><span class="linenos">168</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.to_file-169"><a href="#DatetimeLikeArray.to_file-169"><span class="linenos">169</span></a>            <span class="k">return</span>
</span><span id="DatetimeLikeArray.to_file-170"><a href="#DatetimeLikeArray.to_file-170"><span class="linenos">170</span></a>
</span><span id="DatetimeLikeArray.to_file-171"><a href="#DatetimeLikeArray.to_file-171"><span class="linenos">171</span></a>        <span class="n">tz_offset</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="p">)</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">()</span>
</span><span id="DatetimeLikeArray.to_file-172"><a href="#DatetimeLikeArray.to_file-172"><span class="linenos">172</span></a>        <span class="n">seconds_offset</span> <span class="o">=</span> <span class="n">tz_offset</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="k">if</span> <span class="n">tz_offset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="DatetimeLikeArray.to_file-173"><a href="#DatetimeLikeArray.to_file-173"><span class="linenos">173</span></a>        <span class="n">np_offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">seconds_offset</span><span class="p">)),</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.to_file-174"><a href="#DatetimeLikeArray.to_file-174"><span class="linenos">174</span></a>
</span><span id="DatetimeLikeArray.to_file-175"><a href="#DatetimeLikeArray.to_file-175"><span class="linenos">175</span></a>        <span class="k">if</span> <span class="n">seconds_offset</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DatetimeLikeArray.to_file-176"><a href="#DatetimeLikeArray.to_file-176"><span class="linenos">176</span></a>            <span class="n">offset_arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">-</span> <span class="n">np_offset</span>
</span><span id="DatetimeLikeArray.to_file-177"><a href="#DatetimeLikeArray.to_file-177"><span class="linenos">177</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DatetimeLikeArray.to_file-178"><a href="#DatetimeLikeArray.to_file-178"><span class="linenos">178</span></a>            <span class="n">offset_arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">+</span> <span class="n">np_offset</span>
</span><span id="DatetimeLikeArray.to_file-179"><a href="#DatetimeLikeArray.to_file-179"><span class="linenos">179</span></a>
</span><span id="DatetimeLikeArray.to_file-180"><a href="#DatetimeLikeArray.to_file-180"><span class="linenos">180</span></a>        <span class="n">offset_arr</span> <span class="o">=</span> <span class="n">offset_arr</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="DatetimeLikeArray.to_file-181"><a href="#DatetimeLikeArray.to_file-181"><span class="linenos">181</span></a>        <span class="n">replaced_arr</span> <span class="o">=</span> <span class="p">[</span><span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">offset_arr</span><span class="p">]</span>
</span><span id="DatetimeLikeArray.to_file-182"><a href="#DatetimeLikeArray.to_file-182"><span class="linenos">182</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">replaced_arr</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Save a DatetimeLikeArray instance to a text file.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>fp (Union[IO, str, Path]):</strong>  File path or file-like object to write to.</li>
<li><strong>tz (datetime.tzinfo, optional):</strong>  Timezone in which to write the data.</li>
</ul>
</div>


                            </div>
                            <div id="DatetimeLikeArray.from_array" class="classattr">
                                        <input id="DatetimeLikeArray.from_array-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_array</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">input_array</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">datetime64</span><span class="p">]]]</span>,</span><span class="param">	<span class="n">tz</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DatetimeLikeArray.from_array-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DatetimeLikeArray.from_array"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DatetimeLikeArray.from_array-184"><a href="#DatetimeLikeArray.from_array-184"><span class="linenos">184</span></a>    <span class="nd">@classmethod</span>
</span><span id="DatetimeLikeArray.from_array-185"><a href="#DatetimeLikeArray.from_array-185"><span class="linenos">185</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_array</span><span class="p">(</span>
</span><span id="DatetimeLikeArray.from_array-186"><a href="#DatetimeLikeArray.from_array-186"><span class="linenos">186</span></a>        <span class="bp">cls</span><span class="p">,</span>
</span><span id="DatetimeLikeArray.from_array-187"><a href="#DatetimeLikeArray.from_array-187"><span class="linenos">187</span></a>        <span class="n">input_array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">]],</span>
</span><span id="DatetimeLikeArray.from_array-188"><a href="#DatetimeLikeArray.from_array-188"><span class="linenos">188</span></a>        <span class="n">tz</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DatetimeLikeArray.from_array-189"><a href="#DatetimeLikeArray.from_array-189"><span class="linenos">189</span></a>    <span class="p">):</span>
</span><span id="DatetimeLikeArray.from_array-190"><a href="#DatetimeLikeArray.from_array-190"><span class="linenos">190</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray.from_array-191"><a href="#DatetimeLikeArray.from_array-191"><span class="linenos">191</span></a><span class="sd">        Convert a numpy array to a DatetimeLikeArray instance.</span>
</span><span id="DatetimeLikeArray.from_array-192"><a href="#DatetimeLikeArray.from_array-192"><span class="linenos">192</span></a><span class="sd">        </span>
</span><span id="DatetimeLikeArray.from_array-193"><a href="#DatetimeLikeArray.from_array-193"><span class="linenos">193</span></a><span class="sd">        Args:</span>
</span><span id="DatetimeLikeArray.from_array-194"><a href="#DatetimeLikeArray.from_array-194"><span class="linenos">194</span></a><span class="sd">            input_array (np.ndarray): NumPy array containing datetime values.</span>
</span><span id="DatetimeLikeArray.from_array-195"><a href="#DatetimeLikeArray.from_array-195"><span class="linenos">195</span></a><span class="sd">            tz (datetime.tzinfo, optional): Timezone of the input datetime values.</span>
</span><span id="DatetimeLikeArray.from_array-196"><a href="#DatetimeLikeArray.from_array-196"><span class="linenos">196</span></a>
</span><span id="DatetimeLikeArray.from_array-197"><a href="#DatetimeLikeArray.from_array-197"><span class="linenos">197</span></a><span class="sd">        Returns:</span>
</span><span id="DatetimeLikeArray.from_array-198"><a href="#DatetimeLikeArray.from_array-198"><span class="linenos">198</span></a><span class="sd">            DatetimeLikeArray: A new instance with timezone awareness.</span>
</span><span id="DatetimeLikeArray.from_array-199"><a href="#DatetimeLikeArray.from_array-199"><span class="linenos">199</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray.from_array-200"><a href="#DatetimeLikeArray.from_array-200"><span class="linenos">200</span></a>        <span class="n">array</span> <span class="o">=</span> <span class="n">input_array</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="DatetimeLikeArray.from_array-201"><a href="#DatetimeLikeArray.from_array-201"><span class="linenos">201</span></a>
</span><span id="DatetimeLikeArray.from_array-202"><a href="#DatetimeLikeArray.from_array-202"><span class="linenos">202</span></a>        <span class="k">if</span> <span class="n">tz</span><span class="p">:</span>
</span><span id="DatetimeLikeArray.from_array-203"><a href="#DatetimeLikeArray.from_array-203"><span class="linenos">203</span></a>            <span class="n">array</span> <span class="o">=</span> <span class="p">[</span><span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="n">tz</span><span class="p">)</span> <span class="k">for</span> <span class="n">dt</span> <span class="ow">in</span> <span class="n">array</span><span class="p">]</span>
</span><span id="DatetimeLikeArray.from_array-204"><a href="#DatetimeLikeArray.from_array-204"><span class="linenos">204</span></a>
</span><span id="DatetimeLikeArray.from_array-205"><a href="#DatetimeLikeArray.from_array-205"><span class="linenos">205</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">input_array</span><span class="o">=</span><span class="n">array</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">input_array</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Convert a numpy array to a DatetimeLikeArray instance.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>input_array (np.ndarray):</strong>  NumPy array containing datetime values.</li>
<li><strong>tz (datetime.tzinfo, optional):</strong>  Timezone of the input datetime values.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>DatetimeLikeArray: A new instance with timezone awareness.</p>
</blockquote>
</div>


                            </div>
                            <div id="DatetimeLikeArray.from_fp" class="classattr">
                                        <input id="DatetimeLikeArray.from_fp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_fp</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">IO</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span>,</span><span class="param">	<span class="n">dtype</span><span class="p">:</span> <span class="n">Type</span>,</span><span class="param">	<span class="n">tz</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DatetimeLikeArray.from_fp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DatetimeLikeArray.from_fp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DatetimeLikeArray.from_fp-207"><a href="#DatetimeLikeArray.from_fp-207"><span class="linenos">207</span></a>    <span class="nd">@classmethod</span>
</span><span id="DatetimeLikeArray.from_fp-208"><a href="#DatetimeLikeArray.from_fp-208"><span class="linenos">208</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_fp</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">IO</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="n">tz</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="DatetimeLikeArray.from_fp-209"><a href="#DatetimeLikeArray.from_fp-209"><span class="linenos">209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray.from_fp-210"><a href="#DatetimeLikeArray.from_fp-210"><span class="linenos">210</span></a><span class="sd">        Load a text file and convert it to a DatetimeLikeArray instance.</span>
</span><span id="DatetimeLikeArray.from_fp-211"><a href="#DatetimeLikeArray.from_fp-211"><span class="linenos">211</span></a>
</span><span id="DatetimeLikeArray.from_fp-212"><a href="#DatetimeLikeArray.from_fp-212"><span class="linenos">212</span></a><span class="sd">        Args:</span>
</span><span id="DatetimeLikeArray.from_fp-213"><a href="#DatetimeLikeArray.from_fp-213"><span class="linenos">213</span></a><span class="sd">            fp (Union[IO, str, Path]): File path or file-like object to read from.</span>
</span><span id="DatetimeLikeArray.from_fp-214"><a href="#DatetimeLikeArray.from_fp-214"><span class="linenos">214</span></a><span class="sd">            dtype (Type): Data type of the values in the file.</span>
</span><span id="DatetimeLikeArray.from_fp-215"><a href="#DatetimeLikeArray.from_fp-215"><span class="linenos">215</span></a><span class="sd">            tz (datetime.tzinfo, optional): Timezone to assign to the loaded data.</span>
</span><span id="DatetimeLikeArray.from_fp-216"><a href="#DatetimeLikeArray.from_fp-216"><span class="linenos">216</span></a><span class="sd">        </span>
</span><span id="DatetimeLikeArray.from_fp-217"><a href="#DatetimeLikeArray.from_fp-217"><span class="linenos">217</span></a><span class="sd">        Returns:</span>
</span><span id="DatetimeLikeArray.from_fp-218"><a href="#DatetimeLikeArray.from_fp-218"><span class="linenos">218</span></a><span class="sd">            DatetimeLikeArray: A new instance with timezone awareness.</span>
</span><span id="DatetimeLikeArray.from_fp-219"><a href="#DatetimeLikeArray.from_fp-219"><span class="linenos">219</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray.from_fp-220"><a href="#DatetimeLikeArray.from_fp-220"><span class="linenos">220</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">tz</span><span class="p">:</span>
</span><span id="DatetimeLikeArray.from_fp-221"><a href="#DatetimeLikeArray.from_fp-221"><span class="linenos">221</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.from_fp-222"><a href="#DatetimeLikeArray.from_fp-222"><span class="linenos">222</span></a>            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">input_array</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.from_fp-223"><a href="#DatetimeLikeArray.from_fp-223"><span class="linenos">223</span></a>
</span><span id="DatetimeLikeArray.from_fp-224"><a href="#DatetimeLikeArray.from_fp-224"><span class="linenos">224</span></a>        <span class="n">dtype_</span> <span class="o">=</span> <span class="s1">&#39;datetime64[s]&#39;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">dtype</span> <span class="k">else</span> <span class="n">dtype</span>
</span><span id="DatetimeLikeArray.from_fp-225"><a href="#DatetimeLikeArray.from_fp-225"><span class="linenos">225</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype_</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.from_fp-226"><a href="#DatetimeLikeArray.from_fp-226"><span class="linenos">226</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">input_array</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">tz</span><span class="o">=</span><span class="n">tz</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Load a text file and convert it to a DatetimeLikeArray instance.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>fp (Union[IO, str, Path]):</strong>  File path or file-like object to read from.</li>
<li><strong>dtype (Type):</strong>  Data type of the values in the file.</li>
<li><strong>tz (datetime.tzinfo, optional):</strong>  Timezone to assign to the loaded data.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>DatetimeLikeArray: A new instance with timezone awareness.</p>
</blockquote>
</div>


                            </div>
                            <div id="DatetimeLikeArray.from_iter" class="classattr">
                                        <input id="DatetimeLikeArray.from_iter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_iter</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">gen</span><span class="p">:</span> <span class="n">Generator</span><span class="p">[</span><span class="o">~</span><span class="n">DatetimeLike</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span>,</span><span class="param">	<span class="n">dtype</span><span class="p">:</span> <span class="n">Type</span>,</span><span class="param">	<span class="n">tz</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="DatetimeLikeArray.from_iter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DatetimeLikeArray.from_iter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DatetimeLikeArray.from_iter-228"><a href="#DatetimeLikeArray.from_iter-228"><span class="linenos">228</span></a>    <span class="nd">@classmethod</span> 
</span><span id="DatetimeLikeArray.from_iter-229"><a href="#DatetimeLikeArray.from_iter-229"><span class="linenos">229</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_iter</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">gen</span><span class="p">:</span> <span class="n">Generator</span><span class="p">[</span><span class="n">DatetimeLike</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="n">tz</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="DatetimeLikeArray.from_iter-230"><a href="#DatetimeLikeArray.from_iter-230"><span class="linenos">230</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray.from_iter-231"><a href="#DatetimeLikeArray.from_iter-231"><span class="linenos">231</span></a><span class="sd">        </span>
</span><span id="DatetimeLikeArray.from_iter-232"><a href="#DatetimeLikeArray.from_iter-232"><span class="linenos">232</span></a><span class="sd">        Create a DatetimeLikeArray object from an Iterable with DatetimeLike yields</span>
</span><span id="DatetimeLikeArray.from_iter-233"><a href="#DatetimeLikeArray.from_iter-233"><span class="linenos">233</span></a>
</span><span id="DatetimeLikeArray.from_iter-234"><a href="#DatetimeLikeArray.from_iter-234"><span class="linenos">234</span></a><span class="sd">        Args:</span>
</span><span id="DatetimeLikeArray.from_iter-235"><a href="#DatetimeLikeArray.from_iter-235"><span class="linenos">235</span></a><span class="sd">            gen (Generator[DatetimeLike, None, None]): A generator that yields DatetimeLike values</span>
</span><span id="DatetimeLikeArray.from_iter-236"><a href="#DatetimeLikeArray.from_iter-236"><span class="linenos">236</span></a><span class="sd">            dtype (Type): Data type of the values in the file.</span>
</span><span id="DatetimeLikeArray.from_iter-237"><a href="#DatetimeLikeArray.from_iter-237"><span class="linenos">237</span></a><span class="sd">            tz (datetime.tzinfo, optional): Timezone to assign to the loaded data.</span>
</span><span id="DatetimeLikeArray.from_iter-238"><a href="#DatetimeLikeArray.from_iter-238"><span class="linenos">238</span></a><span class="sd">        </span>
</span><span id="DatetimeLikeArray.from_iter-239"><a href="#DatetimeLikeArray.from_iter-239"><span class="linenos">239</span></a><span class="sd">        Returns:</span>
</span><span id="DatetimeLikeArray.from_iter-240"><a href="#DatetimeLikeArray.from_iter-240"><span class="linenos">240</span></a><span class="sd">            DatetimeLikeArray: A new instance with timezone awareness.</span>
</span><span id="DatetimeLikeArray.from_iter-241"><a href="#DatetimeLikeArray.from_iter-241"><span class="linenos">241</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DatetimeLikeArray.from_iter-242"><a href="#DatetimeLikeArray.from_iter-242"><span class="linenos">242</span></a>
</span><span id="DatetimeLikeArray.from_iter-243"><a href="#DatetimeLikeArray.from_iter-243"><span class="linenos">243</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper_gen</span><span class="p">(</span><span class="n">gen</span><span class="p">):</span> 
</span><span id="DatetimeLikeArray.from_iter-244"><a href="#DatetimeLikeArray.from_iter-244"><span class="linenos">244</span></a>            
</span><span id="DatetimeLikeArray.from_iter-245"><a href="#DatetimeLikeArray.from_iter-245"><span class="linenos">245</span></a>            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">:</span> 
</span><span id="DatetimeLikeArray.from_iter-246"><a href="#DatetimeLikeArray.from_iter-246"><span class="linenos">246</span></a>                
</span><span id="DatetimeLikeArray.from_iter-247"><a href="#DatetimeLikeArray.from_iter-247"><span class="linenos">247</span></a>                <span class="c1"># If it is timezone-aware, remove the timezone</span>
</span><span id="DatetimeLikeArray.from_iter-248"><a href="#DatetimeLikeArray.from_iter-248"><span class="linenos">248</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span> 
</span><span id="DatetimeLikeArray.from_iter-249"><a href="#DatetimeLikeArray.from_iter-249"><span class="linenos">249</span></a>                    <span class="n">a</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.from_iter-250"><a href="#DatetimeLikeArray.from_iter-250"><span class="linenos">250</span></a>                    <span class="k">yield</span> <span class="n">a</span>
</span><span id="DatetimeLikeArray.from_iter-251"><a href="#DatetimeLikeArray.from_iter-251"><span class="linenos">251</span></a>                
</span><span id="DatetimeLikeArray.from_iter-252"><a href="#DatetimeLikeArray.from_iter-252"><span class="linenos">252</span></a>                <span class="k">else</span><span class="p">:</span> 
</span><span id="DatetimeLikeArray.from_iter-253"><a href="#DatetimeLikeArray.from_iter-253"><span class="linenos">253</span></a>                    <span class="k">yield</span> <span class="n">value</span>
</span><span id="DatetimeLikeArray.from_iter-254"><a href="#DatetimeLikeArray.from_iter-254"><span class="linenos">254</span></a>        
</span><span id="DatetimeLikeArray.from_iter-255"><a href="#DatetimeLikeArray.from_iter-255"><span class="linenos">255</span></a>        <span class="n">naive_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(</span><span class="n">wrapper_gen</span><span class="p">(</span><span class="n">gen</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.from_iter-256"><a href="#DatetimeLikeArray.from_iter-256"><span class="linenos">256</span></a>        
</span><span id="DatetimeLikeArray.from_iter-257"><a href="#DatetimeLikeArray.from_iter-257"><span class="linenos">257</span></a>        <span class="k">if</span> <span class="n">tz</span><span class="p">:</span>
</span><span id="DatetimeLikeArray.from_iter-258"><a href="#DatetimeLikeArray.from_iter-258"><span class="linenos">258</span></a>            <span class="n">tz_offset_</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="p">)</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">()</span>
</span><span id="DatetimeLikeArray.from_iter-259"><a href="#DatetimeLikeArray.from_iter-259"><span class="linenos">259</span></a>            <span class="n">seconds_offset</span> <span class="o">=</span> <span class="n">tz_offset_</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="k">if</span> <span class="n">tz_offset_</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="DatetimeLikeArray.from_iter-260"><a href="#DatetimeLikeArray.from_iter-260"><span class="linenos">260</span></a>            <span class="n">np_offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">seconds_offset</span><span class="p">)),</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.from_iter-261"><a href="#DatetimeLikeArray.from_iter-261"><span class="linenos">261</span></a>            
</span><span id="DatetimeLikeArray.from_iter-262"><a href="#DatetimeLikeArray.from_iter-262"><span class="linenos">262</span></a>            <span class="k">if</span> <span class="n">seconds_offset</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="DatetimeLikeArray.from_iter-263"><a href="#DatetimeLikeArray.from_iter-263"><span class="linenos">263</span></a>                <span class="n">naive_array</span> <span class="o">+=</span> <span class="n">np_offset</span>
</span><span id="DatetimeLikeArray.from_iter-264"><a href="#DatetimeLikeArray.from_iter-264"><span class="linenos">264</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="DatetimeLikeArray.from_iter-265"><a href="#DatetimeLikeArray.from_iter-265"><span class="linenos">265</span></a>                <span class="n">naive_array</span> <span class="o">-=</span> <span class="n">np_offset</span>
</span><span id="DatetimeLikeArray.from_iter-266"><a href="#DatetimeLikeArray.from_iter-266"><span class="linenos">266</span></a>            
</span><span id="DatetimeLikeArray.from_iter-267"><a href="#DatetimeLikeArray.from_iter-267"><span class="linenos">267</span></a>            <span class="c1"># Initialize an NDArray and populate with the datetime values</span>
</span><span id="DatetimeLikeArray.from_iter-268"><a href="#DatetimeLikeArray.from_iter-268"><span class="linenos">268</span></a>            <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">naive_array</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.from_iter-269"><a href="#DatetimeLikeArray.from_iter-269"><span class="linenos">269</span></a>            <span class="n">obj</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">naive_array</span>
</span><span id="DatetimeLikeArray.from_iter-270"><a href="#DatetimeLikeArray.from_iter-270"><span class="linenos">270</span></a>            
</span><span id="DatetimeLikeArray.from_iter-271"><a href="#DatetimeLikeArray.from_iter-271"><span class="linenos">271</span></a>            <span class="c1"># Set the timezone and offset of the array</span>
</span><span id="DatetimeLikeArray.from_iter-272"><a href="#DatetimeLikeArray.from_iter-272"><span class="linenos">272</span></a>            <span class="n">obj</span><span class="o">.</span><span class="n">tz</span> <span class="o">=</span> <span class="n">tz</span>
</span><span id="DatetimeLikeArray.from_iter-273"><a href="#DatetimeLikeArray.from_iter-273"><span class="linenos">273</span></a>            <span class="n">obj</span><span class="o">.</span><span class="n">tz_offset</span> <span class="o">=</span> <span class="n">tz_offset_</span> <span class="k">if</span> <span class="n">tz_offset_</span> <span class="k">else</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.from_iter-274"><a href="#DatetimeLikeArray.from_iter-274"><span class="linenos">274</span></a>            <span class="k">return</span> <span class="n">obj</span>
</span><span id="DatetimeLikeArray.from_iter-275"><a href="#DatetimeLikeArray.from_iter-275"><span class="linenos">275</span></a>        
</span><span id="DatetimeLikeArray.from_iter-276"><a href="#DatetimeLikeArray.from_iter-276"><span class="linenos">276</span></a>        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">naive_array</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
</span><span id="DatetimeLikeArray.from_iter-277"><a href="#DatetimeLikeArray.from_iter-277"><span class="linenos">277</span></a>        <span class="n">obj</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">naive_array</span>
</span><span id="DatetimeLikeArray.from_iter-278"><a href="#DatetimeLikeArray.from_iter-278"><span class="linenos">278</span></a>        <span class="k">return</span> <span class="n">obj</span>
</span></pre></div>


            <div class="docstring"><p>Create a DatetimeLikeArray object from an Iterable with DatetimeLike yields</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>gen (Generator[DatetimeLike, None, None]):</strong>  A generator that yields DatetimeLike values</li>
<li><strong>dtype (Type):</strong>  Data type of the values in the file.</li>
<li><strong>tz (datetime.tzinfo, optional):</strong>  Timezone to assign to the loaded data.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>DatetimeLikeArray: A new instance with timezone awareness.</p>
</blockquote>
</div>


                            </div>
                </section>
    </main>
<!-- End of C:/CodingGeneral/chicagoClubManagement/aqua-blue/_build/aqua_blue/datetimelikearray.html -->
<!-- Start of C:/CodingGeneral/chicagoClubManagement/aqua-blue/_build/aqua_blue/models.html -->
<nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../aqua_blue.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;aqua_blue</a>

            <img src="https://raw.githubusercontent.com/Chicago-Club-Management-Company/aqua-blue/refs/heads/main/assets/blue.jpg" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#logger">logger</a>
            </li>
            <li>
                    <a class="class" href="#Model">Model</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Model.__init__">Model</a>
                        </li>
                        <li>
                                <a class="variable" href="#Model.reservoir">reservoir</a>
                        </li>
                        <li>
                                <a class="variable" href="#Model.readout">readout</a>
                        </li>
                        <li>
                                <a class="variable" href="#Model.final_time">final_time</a>
                        </li>
                        <li>
                                <a class="variable" href="#Model.timestep">timestep</a>
                        </li>
                        <li>
                                <a class="variable" href="#Model.initial_guess">initial_guess</a>
                        </li>
                        <li>
                                <a class="variable" href="#Model.tz">tz</a>
                        </li>
                        <li>
                                <a class="function" href="#Model.train">train</a>
                        </li>
                        <li>
                                <a class="function" href="#Model.predict">predict</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../aqua_blue.html">aqua_blue</a><wbr>.models    </h1>

                        <div class="docstring"><p>Module defining models, i.e., compositions of reservoir(s) and readout layers.</p>

<p>This module implements the <code><a href="#Model">Model</a></code> class, which integrates a reservoir and a readout
layer to process time series data. The model enables training using input time series
data and forecasting future values based on learned patterns.</p>

<h6 id="classes">Classes:</h6>

<blockquote>
  <ul>
  <li>Model: Represents an Echo State Network (ESN)-based model that learns from
  input time series data and makes future predictions.</li>
  </ul>
</blockquote>
</div>

                        <input id="mod-models-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-models-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">Module defining models, i.e., compositions of reservoir(s) and readout layers.</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">This module implements the `Model` class, which integrates a reservoir and a readout</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">layer to process time series data. The model enables training using input time series</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">data and forecasting future values based on learned patterns.</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">Classes:</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">    - Model: Represents an Echo State Network (ESN)-based model that learns from</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="sd">      input time series data and makes future predictions.</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Generic</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.reservoirs</span><span class="w"> </span><span class="kn">import</span> <span class="n">Reservoir</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.readouts</span><span class="w"> </span><span class="kn">import</span> <span class="n">Readout</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.time_series</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeries</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.datetimelikearray</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatetimeLikeArray</span><span class="p">,</span> <span class="n">DatetimeLike</span><span class="p">,</span> <span class="n">TimeDeltaLike</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="nd">@dataclass</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Model</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">DatetimeLike</span><span class="p">,</span> <span class="n">TimeDeltaLike</span><span class="p">]):</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">    A machine learning model that integrates a reservoir with a readout layer for</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">    time series forecasting.</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">    This class implements an Echo State Network (ESN) approach, where the reservoir</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">    serves as a high-dimensional dynamic system, and the readout layer maps reservoir</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">    states to output values.</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">    Attributes:</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">        reservoir (Reservoir):</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">            The reservoir component, defining the input-to-reservoir mapping.</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">        readout (Readout):</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">            The readout layer, mapping reservoir states to output values.</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">        final_time (float):</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">            The last timestamp seen during training. This is set automatically after training.</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">        timestep (float):</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">            The fixed time interval between consecutive steps in the input time series,</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">            set during training.</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">        initial_guess (np.ndarray):</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">            The last observed state of the system during training, used as an initial</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">            condition for predictions.</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">        tz (Union[datetime.tzinfo, None]):</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">            The timezone associated with the time series. Set to `None` if the `DatetimeLikeArray`</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">            is incompatible.</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>    <span class="n">reservoir</span><span class="p">:</span> <span class="n">Reservoir</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The reservoir component that defines the input-to-reservoir mapping.&quot;&quot;&quot;</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>    <span class="n">readout</span><span class="p">:</span> <span class="n">Readout</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The readout component that defines the reservoir-to-output mapping.&quot;&quot;&quot;</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>    <span class="n">final_time</span><span class="p">:</span> <span class="n">DatetimeLike</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The final timestamp encountered in the training dataset (set during training).&quot;&quot;&quot;</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>    <span class="n">timestep</span><span class="p">:</span> <span class="n">TimeDeltaLike</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The fixed time step interval of the training dataset (set during training).&quot;&quot;&quot;</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>    <span class="n">initial_guess</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The last observed state of the system, used for future predictions (set during training).&quot;&quot;&quot;</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>    <span class="n">tz</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The timezone associated with the independent variable. Set to `None` if unsupported.&quot;&quot;&quot;</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>        <span class="n">input_time_series</span><span class="p">:</span> <span class="n">TimeSeries</span><span class="p">,</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>        <span class="n">warmup</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>    <span class="p">):</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">        Trains the model on the provided time series data.</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">        This method fits the readout layer using reservoir states obtained from the</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">        input time series data. A warmup period can be specified to exclude initial</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">        steps from training.</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">        Args:</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">            input_time_series (TimeSeries):</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">                The time series instance used for training.</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">            warmup (int):</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">                The number of initial steps to ignore in training (default: 0).</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">        Raises:</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">            ValueError: If `warmup` is greater than or equal to the number of timesteps</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">                        in the input time series.</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>        <span class="k">if</span> <span class="n">warmup</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_time_series</span><span class="o">.</span><span class="n">times</span><span class="p">):</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;warmup must be smaller than number of timesteps (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">input_time_series</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>        <span class="n">time_series_array</span> <span class="o">=</span> <span class="n">input_time_series</span><span class="o">.</span><span class="n">dependent_variable</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>        <span class="n">independent_variables</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">time_series_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">reservoir_dimensionality</span><span class="p">))</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">independent_variables</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>            <span class="n">independent_variables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">update_reservoir</span><span class="p">(</span><span class="n">time_series_array</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>        <span class="n">dependent_variables</span> <span class="o">=</span> <span class="n">time_series_array</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>        <span class="k">if</span> <span class="n">warmup</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>            <span class="n">independent_variables</span> <span class="o">=</span> <span class="n">independent_variables</span><span class="p">[</span><span class="n">warmup</span><span class="p">:]</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>            <span class="n">dependent_variables</span> <span class="o">=</span> <span class="n">dependent_variables</span><span class="p">[</span><span class="n">warmup</span><span class="p">:]</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">readout</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">independent_variables</span><span class="p">,</span> <span class="n">dependent_variables</span><span class="p">)</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timestep</span> <span class="o">=</span> <span class="n">input_time_series</span><span class="o">.</span><span class="n">timestep</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.timestep set to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">final_time</span> <span class="o">=</span> <span class="n">input_time_series</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.final_time set to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">final_time</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tz</span> <span class="o">=</span> <span class="n">input_time_series</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">tz</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.tz set to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">times_dtype</span> <span class="o">=</span> <span class="n">input_time_series</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">dtype</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.times_detype set to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">times_dtype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initial_guess</span> <span class="o">=</span> <span class="n">time_series_array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimeSeries</span><span class="p">:</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="sd">        Generates future predictions for a specified time horizon.</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a><span class="sd">        This method uses the trained model to generate future values based on the</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a><span class="sd">        learned dynamics of the input time series.</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="sd">        Args:</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a><span class="sd">            horizon (int):</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="sd">                The number of steps to forecast into the future.</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a><span class="sd">        Returns:</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a><span class="sd">            TimeSeries: A `TimeSeries` instance containing the predicted values and</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="sd">            corresponding timestamps.</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">horizon</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">input_dimensionality</span><span class="p">))</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">horizon</span><span class="p">):</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>                <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readout</span><span class="o">.</span><span class="n">reservoir_to_output</span><span class="p">(</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">res_state</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>                <span class="p">)</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>                <span class="k">continue</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>            <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readout</span><span class="o">.</span><span class="n">reservoir_to_output</span><span class="p">(</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">update_reservoir</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>            <span class="p">)</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_time</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_time</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">)</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_time</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">):</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">)</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>        <span class="n">times</span> <span class="o">=</span> <span class="n">DatetimeLikeArray</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>                <span class="n">start</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">final_time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>                <span class="n">stop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">final_time</span> <span class="o">+</span> <span class="p">(</span><span class="n">horizon</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>                <span class="n">step</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>                <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">times_dtype</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>            <span class="p">),</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>            <span class="n">tz</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="p">,</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>        <span class="p">)</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>        <span class="k">return</span> <span class="n">TimeSeries</span><span class="p">(</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>            <span class="n">dependent_variable</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>            <span class="n">times</span><span class="o">=</span><span class="n">times</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>        <span class="p">)</span>
</span></pre></div>


            </section>
                <section id="logger">
                    <div class="attr variable">
            <span class="name">logger</span>        =
<span class="default_value">&lt;Logger <a href="">aqua_blue.models</a> (WARNING)&gt;</span>

        
    </div>
    <a class="headerlink" href="#logger"></a>
    
    

                </section>
                <section id="Model">
                            <input id="Model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">Model</span><wbr>(<span class="base">typing.Generic[~DatetimeLike, ~TimeDeltaLike]</span>):

                <label class="view-source-button" for="Model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Model-30"><a href="#Model-30"><span class="linenos"> 30</span></a><span class="nd">@dataclass</span>
</span><span id="Model-31"><a href="#Model-31"><span class="linenos"> 31</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Model</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">DatetimeLike</span><span class="p">,</span> <span class="n">TimeDeltaLike</span><span class="p">]):</span>
</span><span id="Model-32"><a href="#Model-32"><span class="linenos"> 32</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Model-33"><a href="#Model-33"><span class="linenos"> 33</span></a><span class="sd">    A machine learning model that integrates a reservoir with a readout layer for</span>
</span><span id="Model-34"><a href="#Model-34"><span class="linenos"> 34</span></a><span class="sd">    time series forecasting.</span>
</span><span id="Model-35"><a href="#Model-35"><span class="linenos"> 35</span></a>
</span><span id="Model-36"><a href="#Model-36"><span class="linenos"> 36</span></a><span class="sd">    This class implements an Echo State Network (ESN) approach, where the reservoir</span>
</span><span id="Model-37"><a href="#Model-37"><span class="linenos"> 37</span></a><span class="sd">    serves as a high-dimensional dynamic system, and the readout layer maps reservoir</span>
</span><span id="Model-38"><a href="#Model-38"><span class="linenos"> 38</span></a><span class="sd">    states to output values.</span>
</span><span id="Model-39"><a href="#Model-39"><span class="linenos"> 39</span></a>
</span><span id="Model-40"><a href="#Model-40"><span class="linenos"> 40</span></a><span class="sd">    Attributes:</span>
</span><span id="Model-41"><a href="#Model-41"><span class="linenos"> 41</span></a><span class="sd">        reservoir (Reservoir):</span>
</span><span id="Model-42"><a href="#Model-42"><span class="linenos"> 42</span></a><span class="sd">            The reservoir component, defining the input-to-reservoir mapping.</span>
</span><span id="Model-43"><a href="#Model-43"><span class="linenos"> 43</span></a><span class="sd">        readout (Readout):</span>
</span><span id="Model-44"><a href="#Model-44"><span class="linenos"> 44</span></a><span class="sd">            The readout layer, mapping reservoir states to output values.</span>
</span><span id="Model-45"><a href="#Model-45"><span class="linenos"> 45</span></a><span class="sd">        final_time (float):</span>
</span><span id="Model-46"><a href="#Model-46"><span class="linenos"> 46</span></a><span class="sd">            The last timestamp seen during training. This is set automatically after training.</span>
</span><span id="Model-47"><a href="#Model-47"><span class="linenos"> 47</span></a><span class="sd">        timestep (float):</span>
</span><span id="Model-48"><a href="#Model-48"><span class="linenos"> 48</span></a><span class="sd">            The fixed time interval between consecutive steps in the input time series,</span>
</span><span id="Model-49"><a href="#Model-49"><span class="linenos"> 49</span></a><span class="sd">            set during training.</span>
</span><span id="Model-50"><a href="#Model-50"><span class="linenos"> 50</span></a><span class="sd">        initial_guess (np.ndarray):</span>
</span><span id="Model-51"><a href="#Model-51"><span class="linenos"> 51</span></a><span class="sd">            The last observed state of the system during training, used as an initial</span>
</span><span id="Model-52"><a href="#Model-52"><span class="linenos"> 52</span></a><span class="sd">            condition for predictions.</span>
</span><span id="Model-53"><a href="#Model-53"><span class="linenos"> 53</span></a><span class="sd">        tz (Union[datetime.tzinfo, None]):</span>
</span><span id="Model-54"><a href="#Model-54"><span class="linenos"> 54</span></a><span class="sd">            The timezone associated with the time series. Set to `None` if the `DatetimeLikeArray`</span>
</span><span id="Model-55"><a href="#Model-55"><span class="linenos"> 55</span></a><span class="sd">            is incompatible.</span>
</span><span id="Model-56"><a href="#Model-56"><span class="linenos"> 56</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Model-57"><a href="#Model-57"><span class="linenos"> 57</span></a>
</span><span id="Model-58"><a href="#Model-58"><span class="linenos"> 58</span></a>    <span class="n">reservoir</span><span class="p">:</span> <span class="n">Reservoir</span>
</span><span id="Model-59"><a href="#Model-59"><span class="linenos"> 59</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The reservoir component that defines the input-to-reservoir mapping.&quot;&quot;&quot;</span>
</span><span id="Model-60"><a href="#Model-60"><span class="linenos"> 60</span></a>
</span><span id="Model-61"><a href="#Model-61"><span class="linenos"> 61</span></a>    <span class="n">readout</span><span class="p">:</span> <span class="n">Readout</span>
</span><span id="Model-62"><a href="#Model-62"><span class="linenos"> 62</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The readout component that defines the reservoir-to-output mapping.&quot;&quot;&quot;</span>
</span><span id="Model-63"><a href="#Model-63"><span class="linenos"> 63</span></a>
</span><span id="Model-64"><a href="#Model-64"><span class="linenos"> 64</span></a>    <span class="n">final_time</span><span class="p">:</span> <span class="n">DatetimeLike</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Model-65"><a href="#Model-65"><span class="linenos"> 65</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The final timestamp encountered in the training dataset (set during training).&quot;&quot;&quot;</span>
</span><span id="Model-66"><a href="#Model-66"><span class="linenos"> 66</span></a>
</span><span id="Model-67"><a href="#Model-67"><span class="linenos"> 67</span></a>    <span class="n">timestep</span><span class="p">:</span> <span class="n">TimeDeltaLike</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Model-68"><a href="#Model-68"><span class="linenos"> 68</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The fixed time step interval of the training dataset (set during training).&quot;&quot;&quot;</span>
</span><span id="Model-69"><a href="#Model-69"><span class="linenos"> 69</span></a>
</span><span id="Model-70"><a href="#Model-70"><span class="linenos"> 70</span></a>    <span class="n">initial_guess</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Model-71"><a href="#Model-71"><span class="linenos"> 71</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The last observed state of the system, used for future predictions (set during training).&quot;&quot;&quot;</span>
</span><span id="Model-72"><a href="#Model-72"><span class="linenos"> 72</span></a>
</span><span id="Model-73"><a href="#Model-73"><span class="linenos"> 73</span></a>    <span class="n">tz</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">tzinfo</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Model-74"><a href="#Model-74"><span class="linenos"> 74</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The timezone associated with the independent variable. Set to `None` if unsupported.&quot;&quot;&quot;</span>
</span><span id="Model-75"><a href="#Model-75"><span class="linenos"> 75</span></a>
</span><span id="Model-76"><a href="#Model-76"><span class="linenos"> 76</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span>
</span><span id="Model-77"><a href="#Model-77"><span class="linenos"> 77</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Model-78"><a href="#Model-78"><span class="linenos"> 78</span></a>        <span class="n">input_time_series</span><span class="p">:</span> <span class="n">TimeSeries</span><span class="p">,</span>
</span><span id="Model-79"><a href="#Model-79"><span class="linenos"> 79</span></a>        <span class="n">warmup</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Model-80"><a href="#Model-80"><span class="linenos"> 80</span></a>    <span class="p">):</span>
</span><span id="Model-81"><a href="#Model-81"><span class="linenos"> 81</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Model-82"><a href="#Model-82"><span class="linenos"> 82</span></a><span class="sd">        Trains the model on the provided time series data.</span>
</span><span id="Model-83"><a href="#Model-83"><span class="linenos"> 83</span></a>
</span><span id="Model-84"><a href="#Model-84"><span class="linenos"> 84</span></a><span class="sd">        This method fits the readout layer using reservoir states obtained from the</span>
</span><span id="Model-85"><a href="#Model-85"><span class="linenos"> 85</span></a><span class="sd">        input time series data. A warmup period can be specified to exclude initial</span>
</span><span id="Model-86"><a href="#Model-86"><span class="linenos"> 86</span></a><span class="sd">        steps from training.</span>
</span><span id="Model-87"><a href="#Model-87"><span class="linenos"> 87</span></a>
</span><span id="Model-88"><a href="#Model-88"><span class="linenos"> 88</span></a><span class="sd">        Args:</span>
</span><span id="Model-89"><a href="#Model-89"><span class="linenos"> 89</span></a><span class="sd">            input_time_series (TimeSeries):</span>
</span><span id="Model-90"><a href="#Model-90"><span class="linenos"> 90</span></a><span class="sd">                The time series instance used for training.</span>
</span><span id="Model-91"><a href="#Model-91"><span class="linenos"> 91</span></a><span class="sd">            warmup (int):</span>
</span><span id="Model-92"><a href="#Model-92"><span class="linenos"> 92</span></a><span class="sd">                The number of initial steps to ignore in training (default: 0).</span>
</span><span id="Model-93"><a href="#Model-93"><span class="linenos"> 93</span></a>
</span><span id="Model-94"><a href="#Model-94"><span class="linenos"> 94</span></a><span class="sd">        Raises:</span>
</span><span id="Model-95"><a href="#Model-95"><span class="linenos"> 95</span></a><span class="sd">            ValueError: If `warmup` is greater than or equal to the number of timesteps</span>
</span><span id="Model-96"><a href="#Model-96"><span class="linenos"> 96</span></a><span class="sd">                        in the input time series.</span>
</span><span id="Model-97"><a href="#Model-97"><span class="linenos"> 97</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Model-98"><a href="#Model-98"><span class="linenos"> 98</span></a>        <span class="k">if</span> <span class="n">warmup</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_time_series</span><span class="o">.</span><span class="n">times</span><span class="p">):</span>
</span><span id="Model-99"><a href="#Model-99"><span class="linenos"> 99</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;warmup must be smaller than number of timesteps (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">input_time_series</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="Model-100"><a href="#Model-100"><span class="linenos">100</span></a>
</span><span id="Model-101"><a href="#Model-101"><span class="linenos">101</span></a>        <span class="n">time_series_array</span> <span class="o">=</span> <span class="n">input_time_series</span><span class="o">.</span><span class="n">dependent_variable</span>
</span><span id="Model-102"><a href="#Model-102"><span class="linenos">102</span></a>        <span class="n">independent_variables</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">time_series_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">reservoir_dimensionality</span><span class="p">))</span>
</span><span id="Model-103"><a href="#Model-103"><span class="linenos">103</span></a>
</span><span id="Model-104"><a href="#Model-104"><span class="linenos">104</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">independent_variables</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="Model-105"><a href="#Model-105"><span class="linenos">105</span></a>            <span class="n">independent_variables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">update_reservoir</span><span class="p">(</span><span class="n">time_series_array</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="Model-106"><a href="#Model-106"><span class="linenos">106</span></a>
</span><span id="Model-107"><a href="#Model-107"><span class="linenos">107</span></a>        <span class="n">dependent_variables</span> <span class="o">=</span> <span class="n">time_series_array</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="Model-108"><a href="#Model-108"><span class="linenos">108</span></a>        <span class="k">if</span> <span class="n">warmup</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Model-109"><a href="#Model-109"><span class="linenos">109</span></a>            <span class="n">independent_variables</span> <span class="o">=</span> <span class="n">independent_variables</span><span class="p">[</span><span class="n">warmup</span><span class="p">:]</span>
</span><span id="Model-110"><a href="#Model-110"><span class="linenos">110</span></a>            <span class="n">dependent_variables</span> <span class="o">=</span> <span class="n">dependent_variables</span><span class="p">[</span><span class="n">warmup</span><span class="p">:]</span>
</span><span id="Model-111"><a href="#Model-111"><span class="linenos">111</span></a>
</span><span id="Model-112"><a href="#Model-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">readout</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">independent_variables</span><span class="p">,</span> <span class="n">dependent_variables</span><span class="p">)</span>
</span><span id="Model-113"><a href="#Model-113"><span class="linenos">113</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timestep</span> <span class="o">=</span> <span class="n">input_time_series</span><span class="o">.</span><span class="n">timestep</span>
</span><span id="Model-114"><a href="#Model-114"><span class="linenos">114</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.timestep set to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Model-115"><a href="#Model-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">final_time</span> <span class="o">=</span> <span class="n">input_time_series</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Model-116"><a href="#Model-116"><span class="linenos">116</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.final_time set to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">final_time</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Model-117"><a href="#Model-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tz</span> <span class="o">=</span> <span class="n">input_time_series</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">tz</span>
</span><span id="Model-118"><a href="#Model-118"><span class="linenos">118</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.tz set to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Model-119"><a href="#Model-119"><span class="linenos">119</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">times_dtype</span> <span class="o">=</span> <span class="n">input_time_series</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">dtype</span>
</span><span id="Model-120"><a href="#Model-120"><span class="linenos">120</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.times_detype set to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">times_dtype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Model-121"><a href="#Model-121"><span class="linenos">121</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initial_guess</span> <span class="o">=</span> <span class="n">time_series_array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Model-122"><a href="#Model-122"><span class="linenos">122</span></a>
</span><span id="Model-123"><a href="#Model-123"><span class="linenos">123</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimeSeries</span><span class="p">:</span>
</span><span id="Model-124"><a href="#Model-124"><span class="linenos">124</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Model-125"><a href="#Model-125"><span class="linenos">125</span></a><span class="sd">        Generates future predictions for a specified time horizon.</span>
</span><span id="Model-126"><a href="#Model-126"><span class="linenos">126</span></a>
</span><span id="Model-127"><a href="#Model-127"><span class="linenos">127</span></a><span class="sd">        This method uses the trained model to generate future values based on the</span>
</span><span id="Model-128"><a href="#Model-128"><span class="linenos">128</span></a><span class="sd">        learned dynamics of the input time series.</span>
</span><span id="Model-129"><a href="#Model-129"><span class="linenos">129</span></a>
</span><span id="Model-130"><a href="#Model-130"><span class="linenos">130</span></a><span class="sd">        Args:</span>
</span><span id="Model-131"><a href="#Model-131"><span class="linenos">131</span></a><span class="sd">            horizon (int):</span>
</span><span id="Model-132"><a href="#Model-132"><span class="linenos">132</span></a><span class="sd">                The number of steps to forecast into the future.</span>
</span><span id="Model-133"><a href="#Model-133"><span class="linenos">133</span></a>
</span><span id="Model-134"><a href="#Model-134"><span class="linenos">134</span></a><span class="sd">        Returns:</span>
</span><span id="Model-135"><a href="#Model-135"><span class="linenos">135</span></a><span class="sd">            TimeSeries: A `TimeSeries` instance containing the predicted values and</span>
</span><span id="Model-136"><a href="#Model-136"><span class="linenos">136</span></a><span class="sd">            corresponding timestamps.</span>
</span><span id="Model-137"><a href="#Model-137"><span class="linenos">137</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Model-138"><a href="#Model-138"><span class="linenos">138</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">horizon</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">input_dimensionality</span><span class="p">))</span>
</span><span id="Model-139"><a href="#Model-139"><span class="linenos">139</span></a>
</span><span id="Model-140"><a href="#Model-140"><span class="linenos">140</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">horizon</span><span class="p">):</span>
</span><span id="Model-141"><a href="#Model-141"><span class="linenos">141</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Model-142"><a href="#Model-142"><span class="linenos">142</span></a>                <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readout</span><span class="o">.</span><span class="n">reservoir_to_output</span><span class="p">(</span>
</span><span id="Model-143"><a href="#Model-143"><span class="linenos">143</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">res_state</span>
</span><span id="Model-144"><a href="#Model-144"><span class="linenos">144</span></a>                <span class="p">)</span>
</span><span id="Model-145"><a href="#Model-145"><span class="linenos">145</span></a>                <span class="k">continue</span>
</span><span id="Model-146"><a href="#Model-146"><span class="linenos">146</span></a>            <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readout</span><span class="o">.</span><span class="n">reservoir_to_output</span><span class="p">(</span>
</span><span id="Model-147"><a href="#Model-147"><span class="linenos">147</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">update_reservoir</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="Model-148"><a href="#Model-148"><span class="linenos">148</span></a>            <span class="p">)</span>
</span><span id="Model-149"><a href="#Model-149"><span class="linenos">149</span></a>
</span><span id="Model-150"><a href="#Model-150"><span class="linenos">150</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_time</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="Model-151"><a href="#Model-151"><span class="linenos">151</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
</span><span id="Model-152"><a href="#Model-152"><span class="linenos">152</span></a>
</span><span id="Model-153"><a href="#Model-153"><span class="linenos">153</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_time</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
</span><span id="Model-154"><a href="#Model-154"><span class="linenos">154</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">)</span>
</span><span id="Model-155"><a href="#Model-155"><span class="linenos">155</span></a>
</span><span id="Model-156"><a href="#Model-156"><span class="linenos">156</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_time</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">):</span>
</span><span id="Model-157"><a href="#Model-157"><span class="linenos">157</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">)</span>
</span><span id="Model-158"><a href="#Model-158"><span class="linenos">158</span></a>
</span><span id="Model-159"><a href="#Model-159"><span class="linenos">159</span></a>        <span class="n">times</span> <span class="o">=</span> <span class="n">DatetimeLikeArray</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span>
</span><span id="Model-160"><a href="#Model-160"><span class="linenos">160</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
</span><span id="Model-161"><a href="#Model-161"><span class="linenos">161</span></a>                <span class="n">start</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">final_time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span>
</span><span id="Model-162"><a href="#Model-162"><span class="linenos">162</span></a>                <span class="n">stop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">final_time</span> <span class="o">+</span> <span class="p">(</span><span class="n">horizon</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span>
</span><span id="Model-163"><a href="#Model-163"><span class="linenos">163</span></a>                <span class="n">step</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span>
</span><span id="Model-164"><a href="#Model-164"><span class="linenos">164</span></a>                <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">times_dtype</span>
</span><span id="Model-165"><a href="#Model-165"><span class="linenos">165</span></a>            <span class="p">),</span>
</span><span id="Model-166"><a href="#Model-166"><span class="linenos">166</span></a>            <span class="n">tz</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="p">,</span>
</span><span id="Model-167"><a href="#Model-167"><span class="linenos">167</span></a>        <span class="p">)</span>
</span><span id="Model-168"><a href="#Model-168"><span class="linenos">168</span></a>
</span><span id="Model-169"><a href="#Model-169"><span class="linenos">169</span></a>        <span class="k">return</span> <span class="n">TimeSeries</span><span class="p">(</span>
</span><span id="Model-170"><a href="#Model-170"><span class="linenos">170</span></a>            <span class="n">dependent_variable</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span>
</span><span id="Model-171"><a href="#Model-171"><span class="linenos">171</span></a>            <span class="n">times</span><span class="o">=</span><span class="n">times</span>
</span><span id="Model-172"><a href="#Model-172"><span class="linenos">172</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A machine learning model that integrates a reservoir with a readout layer for
time series forecasting.</p>

<p>This class implements an Echo State Network (ESN) approach, where the reservoir
serves as a high-dimensional dynamic system, and the readout layer maps reservoir
states to output values.</p>

<h6 id="attributes">Attributes:</h6>

<ul>
<li><strong>reservoir (Reservoir):</strong>  The reservoir component, defining the input-to-reservoir mapping.</li>
<li><strong>readout (Readout):</strong>  The readout layer, mapping reservoir states to output values.</li>
<li><strong>final_time (float):</strong>  The last timestamp seen during training. This is set automatically after training.</li>
<li><strong>timestep (float):</strong>  The fixed time interval between consecutive steps in the input time series,
set during training.</li>
<li><strong>initial_guess (np.ndarray):</strong>  The last observed state of the system during training, used as an initial
condition for predictions.</li>
<li><strong>tz (Union[datetime.tzinfo, None]):</strong>  The timezone associated with the time series. Set to <code>None</code> if the <code>DatetimeLikeArray</code>
is incompatible.</li>
</ul>
</div>


                            <div id="Model.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">Model</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">reservoir</span><span class="p">:</span> <span class="n"><a href="reservoirs.html#Reservoir">aqua_blue.reservoirs.Reservoir</a></span>,</span><span class="param">	<span class="n">readout</span><span class="p">:</span> <span class="n"><a href="readouts.html#Readout">aqua_blue.readouts.Readout</a></span></span>)</span>

        
    </div>
    <a class="headerlink" href="#Model.__init__"></a>
    
    

                            </div>
                            <div id="Model.reservoir" class="classattr">
                                <div class="attr variable">
            <span class="name">reservoir</span><span class="annotation">: <a href="reservoirs.html#Reservoir">aqua_blue.reservoirs.Reservoir</a></span>

        
    </div>
    <a class="headerlink" href="#Model.reservoir"></a>
    
            <div class="docstring"><p>The reservoir component that defines the input-to-reservoir mapping.</p>
</div>


                            </div>
                            <div id="Model.readout" class="classattr">
                                <div class="attr variable">
            <span class="name">readout</span><span class="annotation">: <a href="readouts.html#Readout">aqua_blue.readouts.Readout</a></span>

        
    </div>
    <a class="headerlink" href="#Model.readout"></a>
    
            <div class="docstring"><p>The readout component that defines the reservoir-to-output mapping.</p>
</div>


                            </div>
                            <div id="Model.final_time" class="classattr">
                                <div class="attr variable">
            <span class="name">final_time</span><span class="annotation">: ~DatetimeLike</span>

        
    </div>
    <a class="headerlink" href="#Model.final_time"></a>
    
            <div class="docstring"><p>The final timestamp encountered in the training dataset (set during training).</p>
</div>


                            </div>
                            <div id="Model.timestep" class="classattr">
                                <div class="attr variable">
            <span class="name">timestep</span><span class="annotation">: ~TimeDeltaLike</span>

        
    </div>
    <a class="headerlink" href="#Model.timestep"></a>
    
            <div class="docstring"><p>The fixed time step interval of the training dataset (set during training).</p>
</div>


                            </div>
                            <div id="Model.initial_guess" class="classattr">
                                <div class="attr variable">
            <span class="name">initial_guess</span><span class="annotation">: numpy.ndarray[typing.Any, numpy.dtype[numpy.floating]]</span>

        
    </div>
    <a class="headerlink" href="#Model.initial_guess"></a>
    
            <div class="docstring"><p>The last observed state of the system, used for future predictions (set during training).</p>
</div>


                            </div>
                            <div id="Model.tz" class="classattr">
                                <div class="attr variable">
            <span class="name">tz</span><span class="annotation">: Optional[datetime.tzinfo]</span>

        
    </div>
    <a class="headerlink" href="#Model.tz"></a>
    
            <div class="docstring"><p>The timezone associated with the independent variable. Set to <code>None</code> if unsupported.</p>
</div>


                            </div>
                            <div id="Model.train" class="classattr">
                                        <input id="Model.train-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">train</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">input_time_series</span><span class="p">:</span> <span class="n"><a href="time_series.html#TimeSeries">aqua_blue.time_series.TimeSeries</a></span>,</span><span class="param">	<span class="n">warmup</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Model.train-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Model.train"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Model.train-76"><a href="#Model.train-76"><span class="linenos"> 76</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span>
</span><span id="Model.train-77"><a href="#Model.train-77"><span class="linenos"> 77</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Model.train-78"><a href="#Model.train-78"><span class="linenos"> 78</span></a>        <span class="n">input_time_series</span><span class="p">:</span> <span class="n">TimeSeries</span><span class="p">,</span>
</span><span id="Model.train-79"><a href="#Model.train-79"><span class="linenos"> 79</span></a>        <span class="n">warmup</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Model.train-80"><a href="#Model.train-80"><span class="linenos"> 80</span></a>    <span class="p">):</span>
</span><span id="Model.train-81"><a href="#Model.train-81"><span class="linenos"> 81</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Model.train-82"><a href="#Model.train-82"><span class="linenos"> 82</span></a><span class="sd">        Trains the model on the provided time series data.</span>
</span><span id="Model.train-83"><a href="#Model.train-83"><span class="linenos"> 83</span></a>
</span><span id="Model.train-84"><a href="#Model.train-84"><span class="linenos"> 84</span></a><span class="sd">        This method fits the readout layer using reservoir states obtained from the</span>
</span><span id="Model.train-85"><a href="#Model.train-85"><span class="linenos"> 85</span></a><span class="sd">        input time series data. A warmup period can be specified to exclude initial</span>
</span><span id="Model.train-86"><a href="#Model.train-86"><span class="linenos"> 86</span></a><span class="sd">        steps from training.</span>
</span><span id="Model.train-87"><a href="#Model.train-87"><span class="linenos"> 87</span></a>
</span><span id="Model.train-88"><a href="#Model.train-88"><span class="linenos"> 88</span></a><span class="sd">        Args:</span>
</span><span id="Model.train-89"><a href="#Model.train-89"><span class="linenos"> 89</span></a><span class="sd">            input_time_series (TimeSeries):</span>
</span><span id="Model.train-90"><a href="#Model.train-90"><span class="linenos"> 90</span></a><span class="sd">                The time series instance used for training.</span>
</span><span id="Model.train-91"><a href="#Model.train-91"><span class="linenos"> 91</span></a><span class="sd">            warmup (int):</span>
</span><span id="Model.train-92"><a href="#Model.train-92"><span class="linenos"> 92</span></a><span class="sd">                The number of initial steps to ignore in training (default: 0).</span>
</span><span id="Model.train-93"><a href="#Model.train-93"><span class="linenos"> 93</span></a>
</span><span id="Model.train-94"><a href="#Model.train-94"><span class="linenos"> 94</span></a><span class="sd">        Raises:</span>
</span><span id="Model.train-95"><a href="#Model.train-95"><span class="linenos"> 95</span></a><span class="sd">            ValueError: If `warmup` is greater than or equal to the number of timesteps</span>
</span><span id="Model.train-96"><a href="#Model.train-96"><span class="linenos"> 96</span></a><span class="sd">                        in the input time series.</span>
</span><span id="Model.train-97"><a href="#Model.train-97"><span class="linenos"> 97</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Model.train-98"><a href="#Model.train-98"><span class="linenos"> 98</span></a>        <span class="k">if</span> <span class="n">warmup</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_time_series</span><span class="o">.</span><span class="n">times</span><span class="p">):</span>
</span><span id="Model.train-99"><a href="#Model.train-99"><span class="linenos"> 99</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;warmup must be smaller than number of timesteps (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">input_time_series</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="Model.train-100"><a href="#Model.train-100"><span class="linenos">100</span></a>
</span><span id="Model.train-101"><a href="#Model.train-101"><span class="linenos">101</span></a>        <span class="n">time_series_array</span> <span class="o">=</span> <span class="n">input_time_series</span><span class="o">.</span><span class="n">dependent_variable</span>
</span><span id="Model.train-102"><a href="#Model.train-102"><span class="linenos">102</span></a>        <span class="n">independent_variables</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">time_series_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">reservoir_dimensionality</span><span class="p">))</span>
</span><span id="Model.train-103"><a href="#Model.train-103"><span class="linenos">103</span></a>
</span><span id="Model.train-104"><a href="#Model.train-104"><span class="linenos">104</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">independent_variables</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="Model.train-105"><a href="#Model.train-105"><span class="linenos">105</span></a>            <span class="n">independent_variables</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">update_reservoir</span><span class="p">(</span><span class="n">time_series_array</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="Model.train-106"><a href="#Model.train-106"><span class="linenos">106</span></a>
</span><span id="Model.train-107"><a href="#Model.train-107"><span class="linenos">107</span></a>        <span class="n">dependent_variables</span> <span class="o">=</span> <span class="n">time_series_array</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="Model.train-108"><a href="#Model.train-108"><span class="linenos">108</span></a>        <span class="k">if</span> <span class="n">warmup</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Model.train-109"><a href="#Model.train-109"><span class="linenos">109</span></a>            <span class="n">independent_variables</span> <span class="o">=</span> <span class="n">independent_variables</span><span class="p">[</span><span class="n">warmup</span><span class="p">:]</span>
</span><span id="Model.train-110"><a href="#Model.train-110"><span class="linenos">110</span></a>            <span class="n">dependent_variables</span> <span class="o">=</span> <span class="n">dependent_variables</span><span class="p">[</span><span class="n">warmup</span><span class="p">:]</span>
</span><span id="Model.train-111"><a href="#Model.train-111"><span class="linenos">111</span></a>
</span><span id="Model.train-112"><a href="#Model.train-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">readout</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">independent_variables</span><span class="p">,</span> <span class="n">dependent_variables</span><span class="p">)</span>
</span><span id="Model.train-113"><a href="#Model.train-113"><span class="linenos">113</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timestep</span> <span class="o">=</span> <span class="n">input_time_series</span><span class="o">.</span><span class="n">timestep</span>
</span><span id="Model.train-114"><a href="#Model.train-114"><span class="linenos">114</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.timestep set to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Model.train-115"><a href="#Model.train-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">final_time</span> <span class="o">=</span> <span class="n">input_time_series</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Model.train-116"><a href="#Model.train-116"><span class="linenos">116</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.final_time set to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">final_time</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Model.train-117"><a href="#Model.train-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tz</span> <span class="o">=</span> <span class="n">input_time_series</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">tz</span>
</span><span id="Model.train-118"><a href="#Model.train-118"><span class="linenos">118</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.tz set to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Model.train-119"><a href="#Model.train-119"><span class="linenos">119</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">times_dtype</span> <span class="o">=</span> <span class="n">input_time_series</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">dtype</span>
</span><span id="Model.train-120"><a href="#Model.train-120"><span class="linenos">120</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.times_detype set to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">times_dtype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Model.train-121"><a href="#Model.train-121"><span class="linenos">121</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initial_guess</span> <span class="o">=</span> <span class="n">time_series_array</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span></pre></div>


            <div class="docstring"><p>Trains the model on the provided time series data.</p>

<p>This method fits the readout layer using reservoir states obtained from the
input time series data. A warmup period can be specified to exclude initial
steps from training.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>input_time_series (TimeSeries):</strong>  The time series instance used for training.</li>
<li><strong>warmup (int):</strong>  The number of initial steps to ignore in training (default: 0).</li>
</ul>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If <code>warmup</code> is greater than or equal to the number of timesteps
in the input time series.</li>
</ul>
</div>


                            </div>
                            <div id="Model.predict" class="classattr">
                                        <input id="Model.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="n"><a href="time_series.html#TimeSeries">aqua_blue.time_series.TimeSeries</a></span>:</span></span>

                <label class="view-source-button" for="Model.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Model.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Model.predict-123"><a href="#Model.predict-123"><span class="linenos">123</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimeSeries</span><span class="p">:</span>
</span><span id="Model.predict-124"><a href="#Model.predict-124"><span class="linenos">124</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Model.predict-125"><a href="#Model.predict-125"><span class="linenos">125</span></a><span class="sd">        Generates future predictions for a specified time horizon.</span>
</span><span id="Model.predict-126"><a href="#Model.predict-126"><span class="linenos">126</span></a>
</span><span id="Model.predict-127"><a href="#Model.predict-127"><span class="linenos">127</span></a><span class="sd">        This method uses the trained model to generate future values based on the</span>
</span><span id="Model.predict-128"><a href="#Model.predict-128"><span class="linenos">128</span></a><span class="sd">        learned dynamics of the input time series.</span>
</span><span id="Model.predict-129"><a href="#Model.predict-129"><span class="linenos">129</span></a>
</span><span id="Model.predict-130"><a href="#Model.predict-130"><span class="linenos">130</span></a><span class="sd">        Args:</span>
</span><span id="Model.predict-131"><a href="#Model.predict-131"><span class="linenos">131</span></a><span class="sd">            horizon (int):</span>
</span><span id="Model.predict-132"><a href="#Model.predict-132"><span class="linenos">132</span></a><span class="sd">                The number of steps to forecast into the future.</span>
</span><span id="Model.predict-133"><a href="#Model.predict-133"><span class="linenos">133</span></a>
</span><span id="Model.predict-134"><a href="#Model.predict-134"><span class="linenos">134</span></a><span class="sd">        Returns:</span>
</span><span id="Model.predict-135"><a href="#Model.predict-135"><span class="linenos">135</span></a><span class="sd">            TimeSeries: A `TimeSeries` instance containing the predicted values and</span>
</span><span id="Model.predict-136"><a href="#Model.predict-136"><span class="linenos">136</span></a><span class="sd">            corresponding timestamps.</span>
</span><span id="Model.predict-137"><a href="#Model.predict-137"><span class="linenos">137</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Model.predict-138"><a href="#Model.predict-138"><span class="linenos">138</span></a>        <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">horizon</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">input_dimensionality</span><span class="p">))</span>
</span><span id="Model.predict-139"><a href="#Model.predict-139"><span class="linenos">139</span></a>
</span><span id="Model.predict-140"><a href="#Model.predict-140"><span class="linenos">140</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">horizon</span><span class="p">):</span>
</span><span id="Model.predict-141"><a href="#Model.predict-141"><span class="linenos">141</span></a>            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Model.predict-142"><a href="#Model.predict-142"><span class="linenos">142</span></a>                <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readout</span><span class="o">.</span><span class="n">reservoir_to_output</span><span class="p">(</span>
</span><span id="Model.predict-143"><a href="#Model.predict-143"><span class="linenos">143</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">res_state</span>
</span><span id="Model.predict-144"><a href="#Model.predict-144"><span class="linenos">144</span></a>                <span class="p">)</span>
</span><span id="Model.predict-145"><a href="#Model.predict-145"><span class="linenos">145</span></a>                <span class="k">continue</span>
</span><span id="Model.predict-146"><a href="#Model.predict-146"><span class="linenos">146</span></a>            <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readout</span><span class="o">.</span><span class="n">reservoir_to_output</span><span class="p">(</span>
</span><span id="Model.predict-147"><a href="#Model.predict-147"><span class="linenos">147</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">reservoir</span><span class="o">.</span><span class="n">update_reservoir</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="Model.predict-148"><a href="#Model.predict-148"><span class="linenos">148</span></a>            <span class="p">)</span>
</span><span id="Model.predict-149"><a href="#Model.predict-149"><span class="linenos">149</span></a>
</span><span id="Model.predict-150"><a href="#Model.predict-150"><span class="linenos">150</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_time</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="Model.predict-151"><a href="#Model.predict-151"><span class="linenos">151</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
</span><span id="Model.predict-152"><a href="#Model.predict-152"><span class="linenos">152</span></a>
</span><span id="Model.predict-153"><a href="#Model.predict-153"><span class="linenos">153</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_time</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
</span><span id="Model.predict-154"><a href="#Model.predict-154"><span class="linenos">154</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">)</span>
</span><span id="Model.predict-155"><a href="#Model.predict-155"><span class="linenos">155</span></a>
</span><span id="Model.predict-156"><a href="#Model.predict-156"><span class="linenos">156</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">final_time</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">):</span>
</span><span id="Model.predict-157"><a href="#Model.predict-157"><span class="linenos">157</span></a>            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">)</span>
</span><span id="Model.predict-158"><a href="#Model.predict-158"><span class="linenos">158</span></a>
</span><span id="Model.predict-159"><a href="#Model.predict-159"><span class="linenos">159</span></a>        <span class="n">times</span> <span class="o">=</span> <span class="n">DatetimeLikeArray</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span>
</span><span id="Model.predict-160"><a href="#Model.predict-160"><span class="linenos">160</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
</span><span id="Model.predict-161"><a href="#Model.predict-161"><span class="linenos">161</span></a>                <span class="n">start</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">final_time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span>
</span><span id="Model.predict-162"><a href="#Model.predict-162"><span class="linenos">162</span></a>                <span class="n">stop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">final_time</span> <span class="o">+</span> <span class="p">(</span><span class="n">horizon</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span>
</span><span id="Model.predict-163"><a href="#Model.predict-163"><span class="linenos">163</span></a>                <span class="n">step</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="p">,</span>
</span><span id="Model.predict-164"><a href="#Model.predict-164"><span class="linenos">164</span></a>                <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">times_dtype</span>
</span><span id="Model.predict-165"><a href="#Model.predict-165"><span class="linenos">165</span></a>            <span class="p">),</span>
</span><span id="Model.predict-166"><a href="#Model.predict-166"><span class="linenos">166</span></a>            <span class="n">tz</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tz</span><span class="p">,</span>
</span><span id="Model.predict-167"><a href="#Model.predict-167"><span class="linenos">167</span></a>        <span class="p">)</span>
</span><span id="Model.predict-168"><a href="#Model.predict-168"><span class="linenos">168</span></a>
</span><span id="Model.predict-169"><a href="#Model.predict-169"><span class="linenos">169</span></a>        <span class="k">return</span> <span class="n">TimeSeries</span><span class="p">(</span>
</span><span id="Model.predict-170"><a href="#Model.predict-170"><span class="linenos">170</span></a>            <span class="n">dependent_variable</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span>
</span><span id="Model.predict-171"><a href="#Model.predict-171"><span class="linenos">171</span></a>            <span class="n">times</span><span class="o">=</span><span class="n">times</span>
</span><span id="Model.predict-172"><a href="#Model.predict-172"><span class="linenos">172</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Generates future predictions for a specified time horizon.</p>

<p>This method uses the trained model to generate future values based on the
learned dynamics of the input time series.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>horizon (int):</strong>  The number of steps to forecast into the future.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>TimeSeries: A <code>TimeSeries</code> instance containing the predicted values and
  corresponding timestamps.</p>
</blockquote>
</div>


                            </div>
                </section>
    </main>
<!-- End of C:/CodingGeneral/chicagoClubManagement/aqua-blue/_build/aqua_blue/models.html -->
<!-- Start of C:/CodingGeneral/chicagoClubManagement/aqua-blue/_build/aqua_blue/readouts.html -->
<nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../aqua_blue.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;aqua_blue</a>

            <img src="https://raw.githubusercontent.com/Chicago-Club-Management-Company/aqua-blue/refs/heads/main/assets/blue.jpg" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#logger">logger</a>
            </li>
            <li>
                    <a class="class" href="#Readout">Readout</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#Readout.coefficients">coefficients</a>
                        </li>
                        <li>
                                <a class="function" href="#Readout.train">train</a>
                        </li>
                        <li>
                                <a class="function" href="#Readout.reservoir_to_output">reservoir_to_output</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#LinearReadout">LinearReadout</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#LinearReadout.__init__">LinearReadout</a>
                        </li>
                        <li>
                                <a class="variable" href="#LinearReadout.rcond">rcond</a>
                        </li>
                        <li>
                                <a class="function" href="#LinearReadout.train">train</a>
                        </li>
                        <li>
                                <a class="function" href="#LinearReadout.reservoir_to_output">reservoir_to_output</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../aqua_blue.html">aqua_blue</a><wbr>.readouts    </h1>

                        <div class="docstring"><p>Module defining readout layers.</p>

<p>This module provides the abstract <code><a href="#Readout">Readout</a></code> class and its concrete implementation,
<code><a href="#LinearReadout">LinearReadout</a></code>. Readout layers map the internal reservoir states of an Echo State
Network (ESN) to output values.</p>

<h6 id="classes">Classes:</h6>

<blockquote>
  <ul>
  <li>Readout: Abstract base class defining the interface for readout layers.</li>
  <li>LinearReadout: A linear mapping readout layer that transforms reservoir states
  into output values using learned coefficients.</li>
  </ul>
</blockquote>
</div>

                        <input id="mod-readouts-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-readouts-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">Module defining readout layers.</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">This module provides the abstract `Readout` class and its concrete implementation,</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">`LinearReadout`. Readout layers map the internal reservoir states of an Echo State</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">Network (ESN) to output values.</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">Classes:</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">    - Readout: Abstract base class defining the interface for readout layers.</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="sd">    - LinearReadout: A linear mapping readout layer that transforms reservoir states</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="sd">      into output values using learned coefficients.</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="nd">@dataclass</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Readout</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">    Abstract base class for readout layers in Echo State Networks (ESNs).</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">    Readout layers transform the high-dimensional reservoir states into output</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">    predictions. The transformation is typically learned during training.</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">    Attributes:</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">        coefficients (np.ndarray):</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">            The learned weights for mapping reservoir states to output values.</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">            This is set after training.</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>    <span class="n">coefficients</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The learned weight matrix for the readout layer, initialized during training.&quot;&quot;&quot;</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>        <span class="n">independent_variables</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">],</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>        <span class="n">dependent_variables</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>    <span class="p">):</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">        Trains the readout layer by learning the mapping from reservoir states to output values.</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">        This method takes independent input variables (reservoir states) and corresponding</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">        dependent variables (target outputs) to compute the optimal readout weights.</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">        Args:</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">            independent_variables (np.ndarray):</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">                The reservoir state matrix used as input for training.</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">            dependent_variables (np.ndarray):</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">                The expected output values corresponding to the input states.</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>        <span class="k">pass</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">reservoir_to_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reservoir_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]:</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">        Maps a given reservoir state to an output value.</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">        Args:</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">            reservoir_state (np.ndarray):</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">                The current state of the reservoir.</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">        Returns:</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">            np.ndarray: The predicted output corresponding to the given reservoir state.</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>        <span class="k">pass</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="nd">@dataclass</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="k">class</span><span class="w"> </span><span class="nc">LinearReadout</span><span class="p">(</span><span class="n">Readout</span><span class="p">):</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">    A linear readout layer that applies a learned linear transformation to reservoir states.</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">    This readout layer learns a set of coefficients during training and applies a</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">    simple linear mapping to transform reservoir states into output predictions.</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">    Attributes:</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">        rcond (float):</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">            A regularization parameter used in the pseudo-inverse calculation to</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">            prevent numerical instability in the least squares solution.</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>    <span class="n">rcond</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0e-10</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">    Regularization parameter for pseudo-inverse computation.</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">    This controls the minimum singular value considered for the pseudo-inverse </span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">    computation. A lower value ensures more stable training.</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>        <span class="n">independent_variables</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">],</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>        <span class="n">dependent_variables</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>    <span class="p">):</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">        Trains the linear readout layer by solving the least-squares optimization problem.</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="sd">        The training process determines the optimal readout coefficients $W^*$ by solving the optimization problem</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">        below:</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">        $$W^* = \lim_{\lambda\to 0^+} \arg\min_W \| XW - Y\|_F^2 + \lambda \|W\|_F^2$$</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">        where $X$ is the matrix of reservoir states (independent variables)</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="sd">        and $Y$ is the matrix of target output values (dependent variables).</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="sd">        Args:</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">            independent_variables (np.ndarray):</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a><span class="sd">                The reservoir state matrix used for training.</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a><span class="sd">            dependent_variables (np.ndarray):</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a><span class="sd">                The target output values corresponding to the reservoir states.</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>        <span class="n">coeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">independent_variables</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rcond</span><span class="p">)</span> <span class="o">@</span> <span class="n">dependent_variables</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>        <span class="k">if</span> <span class="n">logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">):</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">independent_variables</span> <span class="o">@</span> <span class="n">coeff</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>            <span class="n">inaccuracy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">predictions</span> <span class="o">-</span> <span class="n">dependent_variables</span><span class="p">)</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>            <span class="n">inaccuracy</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dependent_variables</span> <span class="o">-</span> <span class="n">dependent_variables</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>            <span class="n">pcc</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">inaccuracy</span> <span class="o">**</span> <span class="mi">2</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> layer trained. Inaccuracy = </span><span class="si">{</span><span class="n">inaccuracy</span><span class="si">}</span><span class="s2"> and pcc = </span><span class="si">{</span><span class="n">pcc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span> <span class="o">=</span> <span class="n">coeff</span><span class="o">.</span><span class="n">T</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">reservoir_to_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reservoir_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]:</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="sd">        Computes the output from a given reservoir state using a learned linear mapping.</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a><span class="sd">        This method applies the learned weight matrix (`self.coefficients`) to map</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="sd">        the reservoir state to an output value.</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="sd">        Args:</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="sd">            reservoir_state (np.ndarray):</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="sd">                The reservoir state to be mapped to an output value.</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a><span class="sd">        Returns:</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="sd">            np.ndarray: The predicted output value.</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="sd">        Raises:</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a><span class="sd">            ValueError: If the readout layer has not been trained (i.e., coefficients are not set).</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;coefficients&quot;</span><span class="p">):</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Need to train readout before using it&quot;</span><span class="p">)</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span> <span class="o">@</span> <span class="n">reservoir_state</span>
</span></pre></div>


            </section>
                <section id="logger">
                    <div class="attr variable">
            <span class="name">logger</span>        =
<span class="default_value">&lt;Logger <a href="">aqua_blue.readouts</a> (WARNING)&gt;</span>

        
    </div>
    <a class="headerlink" href="#logger"></a>
    
    

                </section>
                <section id="Readout">
                            <input id="Readout-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">Readout</span><wbr>(<span class="base">abc.ABC</span>):

                <label class="view-source-button" for="Readout-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Readout"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Readout-25"><a href="#Readout-25"><span class="linenos">25</span></a><span class="nd">@dataclass</span>
</span><span id="Readout-26"><a href="#Readout-26"><span class="linenos">26</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Readout</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="Readout-27"><a href="#Readout-27"><span class="linenos">27</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Readout-28"><a href="#Readout-28"><span class="linenos">28</span></a><span class="sd">    Abstract base class for readout layers in Echo State Networks (ESNs).</span>
</span><span id="Readout-29"><a href="#Readout-29"><span class="linenos">29</span></a>
</span><span id="Readout-30"><a href="#Readout-30"><span class="linenos">30</span></a><span class="sd">    Readout layers transform the high-dimensional reservoir states into output</span>
</span><span id="Readout-31"><a href="#Readout-31"><span class="linenos">31</span></a><span class="sd">    predictions. The transformation is typically learned during training.</span>
</span><span id="Readout-32"><a href="#Readout-32"><span class="linenos">32</span></a>
</span><span id="Readout-33"><a href="#Readout-33"><span class="linenos">33</span></a><span class="sd">    Attributes:</span>
</span><span id="Readout-34"><a href="#Readout-34"><span class="linenos">34</span></a><span class="sd">        coefficients (np.ndarray):</span>
</span><span id="Readout-35"><a href="#Readout-35"><span class="linenos">35</span></a><span class="sd">            The learned weights for mapping reservoir states to output values.</span>
</span><span id="Readout-36"><a href="#Readout-36"><span class="linenos">36</span></a><span class="sd">            This is set after training.</span>
</span><span id="Readout-37"><a href="#Readout-37"><span class="linenos">37</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Readout-38"><a href="#Readout-38"><span class="linenos">38</span></a>
</span><span id="Readout-39"><a href="#Readout-39"><span class="linenos">39</span></a>    <span class="n">coefficients</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Readout-40"><a href="#Readout-40"><span class="linenos">40</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The learned weight matrix for the readout layer, initialized during training.&quot;&quot;&quot;</span>
</span><span id="Readout-41"><a href="#Readout-41"><span class="linenos">41</span></a>
</span><span id="Readout-42"><a href="#Readout-42"><span class="linenos">42</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="Readout-43"><a href="#Readout-43"><span class="linenos">43</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span>
</span><span id="Readout-44"><a href="#Readout-44"><span class="linenos">44</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Readout-45"><a href="#Readout-45"><span class="linenos">45</span></a>        <span class="n">independent_variables</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">],</span>
</span><span id="Readout-46"><a href="#Readout-46"><span class="linenos">46</span></a>        <span class="n">dependent_variables</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span>
</span><span id="Readout-47"><a href="#Readout-47"><span class="linenos">47</span></a>    <span class="p">):</span>
</span><span id="Readout-48"><a href="#Readout-48"><span class="linenos">48</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Readout-49"><a href="#Readout-49"><span class="linenos">49</span></a><span class="sd">        Trains the readout layer by learning the mapping from reservoir states to output values.</span>
</span><span id="Readout-50"><a href="#Readout-50"><span class="linenos">50</span></a>
</span><span id="Readout-51"><a href="#Readout-51"><span class="linenos">51</span></a><span class="sd">        This method takes independent input variables (reservoir states) and corresponding</span>
</span><span id="Readout-52"><a href="#Readout-52"><span class="linenos">52</span></a><span class="sd">        dependent variables (target outputs) to compute the optimal readout weights.</span>
</span><span id="Readout-53"><a href="#Readout-53"><span class="linenos">53</span></a>
</span><span id="Readout-54"><a href="#Readout-54"><span class="linenos">54</span></a><span class="sd">        Args:</span>
</span><span id="Readout-55"><a href="#Readout-55"><span class="linenos">55</span></a><span class="sd">            independent_variables (np.ndarray):</span>
</span><span id="Readout-56"><a href="#Readout-56"><span class="linenos">56</span></a><span class="sd">                The reservoir state matrix used as input for training.</span>
</span><span id="Readout-57"><a href="#Readout-57"><span class="linenos">57</span></a><span class="sd">            dependent_variables (np.ndarray):</span>
</span><span id="Readout-58"><a href="#Readout-58"><span class="linenos">58</span></a><span class="sd">                The expected output values corresponding to the input states.</span>
</span><span id="Readout-59"><a href="#Readout-59"><span class="linenos">59</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Readout-60"><a href="#Readout-60"><span class="linenos">60</span></a>
</span><span id="Readout-61"><a href="#Readout-61"><span class="linenos">61</span></a>        <span class="k">pass</span>
</span><span id="Readout-62"><a href="#Readout-62"><span class="linenos">62</span></a>
</span><span id="Readout-63"><a href="#Readout-63"><span class="linenos">63</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="Readout-64"><a href="#Readout-64"><span class="linenos">64</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">reservoir_to_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reservoir_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]:</span>
</span><span id="Readout-65"><a href="#Readout-65"><span class="linenos">65</span></a>
</span><span id="Readout-66"><a href="#Readout-66"><span class="linenos">66</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Readout-67"><a href="#Readout-67"><span class="linenos">67</span></a><span class="sd">        Maps a given reservoir state to an output value.</span>
</span><span id="Readout-68"><a href="#Readout-68"><span class="linenos">68</span></a>
</span><span id="Readout-69"><a href="#Readout-69"><span class="linenos">69</span></a><span class="sd">        Args:</span>
</span><span id="Readout-70"><a href="#Readout-70"><span class="linenos">70</span></a><span class="sd">            reservoir_state (np.ndarray):</span>
</span><span id="Readout-71"><a href="#Readout-71"><span class="linenos">71</span></a><span class="sd">                The current state of the reservoir.</span>
</span><span id="Readout-72"><a href="#Readout-72"><span class="linenos">72</span></a>
</span><span id="Readout-73"><a href="#Readout-73"><span class="linenos">73</span></a><span class="sd">        Returns:</span>
</span><span id="Readout-74"><a href="#Readout-74"><span class="linenos">74</span></a><span class="sd">            np.ndarray: The predicted output corresponding to the given reservoir state.</span>
</span><span id="Readout-75"><a href="#Readout-75"><span class="linenos">75</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Readout-76"><a href="#Readout-76"><span class="linenos">76</span></a>
</span><span id="Readout-77"><a href="#Readout-77"><span class="linenos">77</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Abstract base class for readout layers in Echo State Networks (ESNs).</p>

<p>Readout layers transform the high-dimensional reservoir states into output
predictions. The transformation is typically learned during training.</p>

<h6 id="attributes">Attributes:</h6>

<ul>
<li><strong>coefficients (np.ndarray):</strong>  The learned weights for mapping reservoir states to output values.
This is set after training.</li>
</ul>
</div>


                            <div id="Readout.coefficients" class="classattr">
                                <div class="attr variable">
            <span class="name">coefficients</span><span class="annotation">: numpy.ndarray[typing.Any, numpy.dtype[numpy.floating]]</span>

        
    </div>
    <a class="headerlink" href="#Readout.coefficients"></a>
    
            <div class="docstring"><p>The learned weight matrix for the readout layer, initialized during training.</p>
</div>


                            </div>
                            <div id="Readout.train" class="classattr">
                                        <input id="Readout.train-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">train</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">independent_variables</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span>,</span><span class="param">	<span class="n">dependent_variables</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Readout.train-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Readout.train"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Readout.train-42"><a href="#Readout.train-42"><span class="linenos">42</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="Readout.train-43"><a href="#Readout.train-43"><span class="linenos">43</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span>
</span><span id="Readout.train-44"><a href="#Readout.train-44"><span class="linenos">44</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="Readout.train-45"><a href="#Readout.train-45"><span class="linenos">45</span></a>        <span class="n">independent_variables</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">],</span>
</span><span id="Readout.train-46"><a href="#Readout.train-46"><span class="linenos">46</span></a>        <span class="n">dependent_variables</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span>
</span><span id="Readout.train-47"><a href="#Readout.train-47"><span class="linenos">47</span></a>    <span class="p">):</span>
</span><span id="Readout.train-48"><a href="#Readout.train-48"><span class="linenos">48</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Readout.train-49"><a href="#Readout.train-49"><span class="linenos">49</span></a><span class="sd">        Trains the readout layer by learning the mapping from reservoir states to output values.</span>
</span><span id="Readout.train-50"><a href="#Readout.train-50"><span class="linenos">50</span></a>
</span><span id="Readout.train-51"><a href="#Readout.train-51"><span class="linenos">51</span></a><span class="sd">        This method takes independent input variables (reservoir states) and corresponding</span>
</span><span id="Readout.train-52"><a href="#Readout.train-52"><span class="linenos">52</span></a><span class="sd">        dependent variables (target outputs) to compute the optimal readout weights.</span>
</span><span id="Readout.train-53"><a href="#Readout.train-53"><span class="linenos">53</span></a>
</span><span id="Readout.train-54"><a href="#Readout.train-54"><span class="linenos">54</span></a><span class="sd">        Args:</span>
</span><span id="Readout.train-55"><a href="#Readout.train-55"><span class="linenos">55</span></a><span class="sd">            independent_variables (np.ndarray):</span>
</span><span id="Readout.train-56"><a href="#Readout.train-56"><span class="linenos">56</span></a><span class="sd">                The reservoir state matrix used as input for training.</span>
</span><span id="Readout.train-57"><a href="#Readout.train-57"><span class="linenos">57</span></a><span class="sd">            dependent_variables (np.ndarray):</span>
</span><span id="Readout.train-58"><a href="#Readout.train-58"><span class="linenos">58</span></a><span class="sd">                The expected output values corresponding to the input states.</span>
</span><span id="Readout.train-59"><a href="#Readout.train-59"><span class="linenos">59</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Readout.train-60"><a href="#Readout.train-60"><span class="linenos">60</span></a>
</span><span id="Readout.train-61"><a href="#Readout.train-61"><span class="linenos">61</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Trains the readout layer by learning the mapping from reservoir states to output values.</p>

<p>This method takes independent input variables (reservoir states) and corresponding
dependent variables (target outputs) to compute the optimal readout weights.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>independent_variables (np.ndarray):</strong>  The reservoir state matrix used as input for training.</li>
<li><strong>dependent_variables (np.ndarray):</strong>  The expected output values corresponding to the input states.</li>
</ul>
</div>


                            </div>
                            <div id="Readout.reservoir_to_output" class="classattr">
                                        <input id="Readout.reservoir_to_output-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">reservoir_to_output</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">reservoir_state</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="Readout.reservoir_to_output-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Readout.reservoir_to_output"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Readout.reservoir_to_output-63"><a href="#Readout.reservoir_to_output-63"><span class="linenos">63</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="Readout.reservoir_to_output-64"><a href="#Readout.reservoir_to_output-64"><span class="linenos">64</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">reservoir_to_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reservoir_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]:</span>
</span><span id="Readout.reservoir_to_output-65"><a href="#Readout.reservoir_to_output-65"><span class="linenos">65</span></a>
</span><span id="Readout.reservoir_to_output-66"><a href="#Readout.reservoir_to_output-66"><span class="linenos">66</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Readout.reservoir_to_output-67"><a href="#Readout.reservoir_to_output-67"><span class="linenos">67</span></a><span class="sd">        Maps a given reservoir state to an output value.</span>
</span><span id="Readout.reservoir_to_output-68"><a href="#Readout.reservoir_to_output-68"><span class="linenos">68</span></a>
</span><span id="Readout.reservoir_to_output-69"><a href="#Readout.reservoir_to_output-69"><span class="linenos">69</span></a><span class="sd">        Args:</span>
</span><span id="Readout.reservoir_to_output-70"><a href="#Readout.reservoir_to_output-70"><span class="linenos">70</span></a><span class="sd">            reservoir_state (np.ndarray):</span>
</span><span id="Readout.reservoir_to_output-71"><a href="#Readout.reservoir_to_output-71"><span class="linenos">71</span></a><span class="sd">                The current state of the reservoir.</span>
</span><span id="Readout.reservoir_to_output-72"><a href="#Readout.reservoir_to_output-72"><span class="linenos">72</span></a>
</span><span id="Readout.reservoir_to_output-73"><a href="#Readout.reservoir_to_output-73"><span class="linenos">73</span></a><span class="sd">        Returns:</span>
</span><span id="Readout.reservoir_to_output-74"><a href="#Readout.reservoir_to_output-74"><span class="linenos">74</span></a><span class="sd">            np.ndarray: The predicted output corresponding to the given reservoir state.</span>
</span><span id="Readout.reservoir_to_output-75"><a href="#Readout.reservoir_to_output-75"><span class="linenos">75</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Readout.reservoir_to_output-76"><a href="#Readout.reservoir_to_output-76"><span class="linenos">76</span></a>
</span><span id="Readout.reservoir_to_output-77"><a href="#Readout.reservoir_to_output-77"><span class="linenos">77</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Maps a given reservoir state to an output value.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>reservoir_state (np.ndarray):</strong>  The current state of the reservoir.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>np.ndarray: The predicted output corresponding to the given reservoir state.</p>
</blockquote>
</div>


                            </div>
                </section>
                <section id="LinearReadout">
                            <input id="LinearReadout-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">LinearReadout</span><wbr>(<span class="base"><a href="#Readout">Readout</a></span>):

                <label class="view-source-button" for="LinearReadout-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LinearReadout"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LinearReadout-80"><a href="#LinearReadout-80"><span class="linenos"> 80</span></a><span class="nd">@dataclass</span>
</span><span id="LinearReadout-81"><a href="#LinearReadout-81"><span class="linenos"> 81</span></a><span class="k">class</span><span class="w"> </span><span class="nc">LinearReadout</span><span class="p">(</span><span class="n">Readout</span><span class="p">):</span>
</span><span id="LinearReadout-82"><a href="#LinearReadout-82"><span class="linenos"> 82</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LinearReadout-83"><a href="#LinearReadout-83"><span class="linenos"> 83</span></a><span class="sd">    A linear readout layer that applies a learned linear transformation to reservoir states.</span>
</span><span id="LinearReadout-84"><a href="#LinearReadout-84"><span class="linenos"> 84</span></a>
</span><span id="LinearReadout-85"><a href="#LinearReadout-85"><span class="linenos"> 85</span></a><span class="sd">    This readout layer learns a set of coefficients during training and applies a</span>
</span><span id="LinearReadout-86"><a href="#LinearReadout-86"><span class="linenos"> 86</span></a><span class="sd">    simple linear mapping to transform reservoir states into output predictions.</span>
</span><span id="LinearReadout-87"><a href="#LinearReadout-87"><span class="linenos"> 87</span></a>
</span><span id="LinearReadout-88"><a href="#LinearReadout-88"><span class="linenos"> 88</span></a><span class="sd">    Attributes:</span>
</span><span id="LinearReadout-89"><a href="#LinearReadout-89"><span class="linenos"> 89</span></a><span class="sd">        rcond (float):</span>
</span><span id="LinearReadout-90"><a href="#LinearReadout-90"><span class="linenos"> 90</span></a><span class="sd">            A regularization parameter used in the pseudo-inverse calculation to</span>
</span><span id="LinearReadout-91"><a href="#LinearReadout-91"><span class="linenos"> 91</span></a><span class="sd">            prevent numerical instability in the least squares solution.</span>
</span><span id="LinearReadout-92"><a href="#LinearReadout-92"><span class="linenos"> 92</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="LinearReadout-93"><a href="#LinearReadout-93"><span class="linenos"> 93</span></a>
</span><span id="LinearReadout-94"><a href="#LinearReadout-94"><span class="linenos"> 94</span></a>    <span class="n">rcond</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0e-10</span>
</span><span id="LinearReadout-95"><a href="#LinearReadout-95"><span class="linenos"> 95</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LinearReadout-96"><a href="#LinearReadout-96"><span class="linenos"> 96</span></a><span class="sd">    Regularization parameter for pseudo-inverse computation.</span>
</span><span id="LinearReadout-97"><a href="#LinearReadout-97"><span class="linenos"> 97</span></a>
</span><span id="LinearReadout-98"><a href="#LinearReadout-98"><span class="linenos"> 98</span></a><span class="sd">    This controls the minimum singular value considered for the pseudo-inverse </span>
</span><span id="LinearReadout-99"><a href="#LinearReadout-99"><span class="linenos"> 99</span></a><span class="sd">    computation. A lower value ensures more stable training.</span>
</span><span id="LinearReadout-100"><a href="#LinearReadout-100"><span class="linenos">100</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="LinearReadout-101"><a href="#LinearReadout-101"><span class="linenos">101</span></a>
</span><span id="LinearReadout-102"><a href="#LinearReadout-102"><span class="linenos">102</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span>
</span><span id="LinearReadout-103"><a href="#LinearReadout-103"><span class="linenos">103</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="LinearReadout-104"><a href="#LinearReadout-104"><span class="linenos">104</span></a>        <span class="n">independent_variables</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">],</span>
</span><span id="LinearReadout-105"><a href="#LinearReadout-105"><span class="linenos">105</span></a>        <span class="n">dependent_variables</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span>
</span><span id="LinearReadout-106"><a href="#LinearReadout-106"><span class="linenos">106</span></a>    <span class="p">):</span>
</span><span id="LinearReadout-107"><a href="#LinearReadout-107"><span class="linenos">107</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LinearReadout-108"><a href="#LinearReadout-108"><span class="linenos">108</span></a><span class="sd">        Trains the linear readout layer by solving the least-squares optimization problem.</span>
</span><span id="LinearReadout-109"><a href="#LinearReadout-109"><span class="linenos">109</span></a>
</span><span id="LinearReadout-110"><a href="#LinearReadout-110"><span class="linenos">110</span></a><span class="sd">        The training process determines the optimal readout coefficients $W^*$ by solving the optimization problem</span>
</span><span id="LinearReadout-111"><a href="#LinearReadout-111"><span class="linenos">111</span></a><span class="sd">        below:</span>
</span><span id="LinearReadout-112"><a href="#LinearReadout-112"><span class="linenos">112</span></a>
</span><span id="LinearReadout-113"><a href="#LinearReadout-113"><span class="linenos">113</span></a><span class="sd">        $$W^* = \lim_{\lambda\to 0^+} \arg\min_W \| XW - Y\|_F^2 + \lambda \|W\|_F^2$$</span>
</span><span id="LinearReadout-114"><a href="#LinearReadout-114"><span class="linenos">114</span></a>
</span><span id="LinearReadout-115"><a href="#LinearReadout-115"><span class="linenos">115</span></a><span class="sd">        where $X$ is the matrix of reservoir states (independent variables)</span>
</span><span id="LinearReadout-116"><a href="#LinearReadout-116"><span class="linenos">116</span></a><span class="sd">        and $Y$ is the matrix of target output values (dependent variables).</span>
</span><span id="LinearReadout-117"><a href="#LinearReadout-117"><span class="linenos">117</span></a>
</span><span id="LinearReadout-118"><a href="#LinearReadout-118"><span class="linenos">118</span></a><span class="sd">        Args:</span>
</span><span id="LinearReadout-119"><a href="#LinearReadout-119"><span class="linenos">119</span></a><span class="sd">            independent_variables (np.ndarray):</span>
</span><span id="LinearReadout-120"><a href="#LinearReadout-120"><span class="linenos">120</span></a><span class="sd">                The reservoir state matrix used for training.</span>
</span><span id="LinearReadout-121"><a href="#LinearReadout-121"><span class="linenos">121</span></a><span class="sd">            dependent_variables (np.ndarray):</span>
</span><span id="LinearReadout-122"><a href="#LinearReadout-122"><span class="linenos">122</span></a><span class="sd">                The target output values corresponding to the reservoir states.</span>
</span><span id="LinearReadout-123"><a href="#LinearReadout-123"><span class="linenos">123</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LinearReadout-124"><a href="#LinearReadout-124"><span class="linenos">124</span></a>        <span class="n">coeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">independent_variables</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rcond</span><span class="p">)</span> <span class="o">@</span> <span class="n">dependent_variables</span>
</span><span id="LinearReadout-125"><a href="#LinearReadout-125"><span class="linenos">125</span></a>        <span class="k">if</span> <span class="n">logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">):</span>
</span><span id="LinearReadout-126"><a href="#LinearReadout-126"><span class="linenos">126</span></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">independent_variables</span> <span class="o">@</span> <span class="n">coeff</span>
</span><span id="LinearReadout-127"><a href="#LinearReadout-127"><span class="linenos">127</span></a>            <span class="n">inaccuracy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">predictions</span> <span class="o">-</span> <span class="n">dependent_variables</span><span class="p">)</span>
</span><span id="LinearReadout-128"><a href="#LinearReadout-128"><span class="linenos">128</span></a>            <span class="n">inaccuracy</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dependent_variables</span> <span class="o">-</span> <span class="n">dependent_variables</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</span><span id="LinearReadout-129"><a href="#LinearReadout-129"><span class="linenos">129</span></a>            <span class="n">pcc</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">inaccuracy</span> <span class="o">**</span> <span class="mi">2</span>
</span><span id="LinearReadout-130"><a href="#LinearReadout-130"><span class="linenos">130</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> layer trained. Inaccuracy = </span><span class="si">{</span><span class="n">inaccuracy</span><span class="si">}</span><span class="s2"> and pcc = </span><span class="si">{</span><span class="n">pcc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="LinearReadout-131"><a href="#LinearReadout-131"><span class="linenos">131</span></a>
</span><span id="LinearReadout-132"><a href="#LinearReadout-132"><span class="linenos">132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span> <span class="o">=</span> <span class="n">coeff</span><span class="o">.</span><span class="n">T</span>
</span><span id="LinearReadout-133"><a href="#LinearReadout-133"><span class="linenos">133</span></a>
</span><span id="LinearReadout-134"><a href="#LinearReadout-134"><span class="linenos">134</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">reservoir_to_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reservoir_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]:</span>
</span><span id="LinearReadout-135"><a href="#LinearReadout-135"><span class="linenos">135</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LinearReadout-136"><a href="#LinearReadout-136"><span class="linenos">136</span></a><span class="sd">        Computes the output from a given reservoir state using a learned linear mapping.</span>
</span><span id="LinearReadout-137"><a href="#LinearReadout-137"><span class="linenos">137</span></a>
</span><span id="LinearReadout-138"><a href="#LinearReadout-138"><span class="linenos">138</span></a><span class="sd">        This method applies the learned weight matrix (`self.coefficients`) to map</span>
</span><span id="LinearReadout-139"><a href="#LinearReadout-139"><span class="linenos">139</span></a><span class="sd">        the reservoir state to an output value.</span>
</span><span id="LinearReadout-140"><a href="#LinearReadout-140"><span class="linenos">140</span></a>
</span><span id="LinearReadout-141"><a href="#LinearReadout-141"><span class="linenos">141</span></a><span class="sd">        Args:</span>
</span><span id="LinearReadout-142"><a href="#LinearReadout-142"><span class="linenos">142</span></a><span class="sd">            reservoir_state (np.ndarray):</span>
</span><span id="LinearReadout-143"><a href="#LinearReadout-143"><span class="linenos">143</span></a><span class="sd">                The reservoir state to be mapped to an output value.</span>
</span><span id="LinearReadout-144"><a href="#LinearReadout-144"><span class="linenos">144</span></a>
</span><span id="LinearReadout-145"><a href="#LinearReadout-145"><span class="linenos">145</span></a><span class="sd">        Returns:</span>
</span><span id="LinearReadout-146"><a href="#LinearReadout-146"><span class="linenos">146</span></a><span class="sd">            np.ndarray: The predicted output value.</span>
</span><span id="LinearReadout-147"><a href="#LinearReadout-147"><span class="linenos">147</span></a>
</span><span id="LinearReadout-148"><a href="#LinearReadout-148"><span class="linenos">148</span></a><span class="sd">        Raises:</span>
</span><span id="LinearReadout-149"><a href="#LinearReadout-149"><span class="linenos">149</span></a><span class="sd">            ValueError: If the readout layer has not been trained (i.e., coefficients are not set).</span>
</span><span id="LinearReadout-150"><a href="#LinearReadout-150"><span class="linenos">150</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LinearReadout-151"><a href="#LinearReadout-151"><span class="linenos">151</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;coefficients&quot;</span><span class="p">):</span>
</span><span id="LinearReadout-152"><a href="#LinearReadout-152"><span class="linenos">152</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Need to train readout before using it&quot;</span><span class="p">)</span>
</span><span id="LinearReadout-153"><a href="#LinearReadout-153"><span class="linenos">153</span></a>
</span><span id="LinearReadout-154"><a href="#LinearReadout-154"><span class="linenos">154</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span> <span class="o">@</span> <span class="n">reservoir_state</span>
</span></pre></div>


            <div class="docstring"><p>A linear readout layer that applies a learned linear transformation to reservoir states.</p>

<p>This readout layer learns a set of coefficients during training and applies a
simple linear mapping to transform reservoir states into output predictions.</p>

<h6 id="attributes">Attributes:</h6>

<ul>
<li><strong>rcond (float):</strong>  A regularization parameter used in the pseudo-inverse calculation to
prevent numerical instability in the least squares solution.</li>
</ul>
</div>


                            <div id="LinearReadout.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">LinearReadout</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">rcond</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-10</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#LinearReadout.__init__"></a>
    
    

                            </div>
                            <div id="LinearReadout.rcond" class="classattr">
                                <div class="attr variable">
            <span class="name">rcond</span><span class="annotation">: float</span>        =
<span class="default_value">1e-10</span>

        
    </div>
    <a class="headerlink" href="#LinearReadout.rcond"></a>
    
            <div class="docstring"><p>Regularization parameter for pseudo-inverse computation.</p>

<p>This controls the minimum singular value considered for the pseudo-inverse 
computation. A lower value ensures more stable training.</p>
</div>


                            </div>
                            <div id="LinearReadout.train" class="classattr">
                                        <input id="LinearReadout.train-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">train</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">independent_variables</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span>,</span><span class="param">	<span class="n">dependent_variables</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="LinearReadout.train-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LinearReadout.train"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LinearReadout.train-102"><a href="#LinearReadout.train-102"><span class="linenos">102</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span>
</span><span id="LinearReadout.train-103"><a href="#LinearReadout.train-103"><span class="linenos">103</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="LinearReadout.train-104"><a href="#LinearReadout.train-104"><span class="linenos">104</span></a>        <span class="n">independent_variables</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">],</span>
</span><span id="LinearReadout.train-105"><a href="#LinearReadout.train-105"><span class="linenos">105</span></a>        <span class="n">dependent_variables</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span>
</span><span id="LinearReadout.train-106"><a href="#LinearReadout.train-106"><span class="linenos">106</span></a>    <span class="p">):</span>
</span><span id="LinearReadout.train-107"><a href="#LinearReadout.train-107"><span class="linenos">107</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LinearReadout.train-108"><a href="#LinearReadout.train-108"><span class="linenos">108</span></a><span class="sd">        Trains the linear readout layer by solving the least-squares optimization problem.</span>
</span><span id="LinearReadout.train-109"><a href="#LinearReadout.train-109"><span class="linenos">109</span></a>
</span><span id="LinearReadout.train-110"><a href="#LinearReadout.train-110"><span class="linenos">110</span></a><span class="sd">        The training process determines the optimal readout coefficients $W^*$ by solving the optimization problem</span>
</span><span id="LinearReadout.train-111"><a href="#LinearReadout.train-111"><span class="linenos">111</span></a><span class="sd">        below:</span>
</span><span id="LinearReadout.train-112"><a href="#LinearReadout.train-112"><span class="linenos">112</span></a>
</span><span id="LinearReadout.train-113"><a href="#LinearReadout.train-113"><span class="linenos">113</span></a><span class="sd">        $$W^* = \lim_{\lambda\to 0^+} \arg\min_W \| XW - Y\|_F^2 + \lambda \|W\|_F^2$$</span>
</span><span id="LinearReadout.train-114"><a href="#LinearReadout.train-114"><span class="linenos">114</span></a>
</span><span id="LinearReadout.train-115"><a href="#LinearReadout.train-115"><span class="linenos">115</span></a><span class="sd">        where $X$ is the matrix of reservoir states (independent variables)</span>
</span><span id="LinearReadout.train-116"><a href="#LinearReadout.train-116"><span class="linenos">116</span></a><span class="sd">        and $Y$ is the matrix of target output values (dependent variables).</span>
</span><span id="LinearReadout.train-117"><a href="#LinearReadout.train-117"><span class="linenos">117</span></a>
</span><span id="LinearReadout.train-118"><a href="#LinearReadout.train-118"><span class="linenos">118</span></a><span class="sd">        Args:</span>
</span><span id="LinearReadout.train-119"><a href="#LinearReadout.train-119"><span class="linenos">119</span></a><span class="sd">            independent_variables (np.ndarray):</span>
</span><span id="LinearReadout.train-120"><a href="#LinearReadout.train-120"><span class="linenos">120</span></a><span class="sd">                The reservoir state matrix used for training.</span>
</span><span id="LinearReadout.train-121"><a href="#LinearReadout.train-121"><span class="linenos">121</span></a><span class="sd">            dependent_variables (np.ndarray):</span>
</span><span id="LinearReadout.train-122"><a href="#LinearReadout.train-122"><span class="linenos">122</span></a><span class="sd">                The target output values corresponding to the reservoir states.</span>
</span><span id="LinearReadout.train-123"><a href="#LinearReadout.train-123"><span class="linenos">123</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LinearReadout.train-124"><a href="#LinearReadout.train-124"><span class="linenos">124</span></a>        <span class="n">coeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">independent_variables</span><span class="p">,</span> <span class="n">rcond</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rcond</span><span class="p">)</span> <span class="o">@</span> <span class="n">dependent_variables</span>
</span><span id="LinearReadout.train-125"><a href="#LinearReadout.train-125"><span class="linenos">125</span></a>        <span class="k">if</span> <span class="n">logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">):</span>
</span><span id="LinearReadout.train-126"><a href="#LinearReadout.train-126"><span class="linenos">126</span></a>            <span class="n">predictions</span> <span class="o">=</span> <span class="n">independent_variables</span> <span class="o">@</span> <span class="n">coeff</span>
</span><span id="LinearReadout.train-127"><a href="#LinearReadout.train-127"><span class="linenos">127</span></a>            <span class="n">inaccuracy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">predictions</span> <span class="o">-</span> <span class="n">dependent_variables</span><span class="p">)</span>
</span><span id="LinearReadout.train-128"><a href="#LinearReadout.train-128"><span class="linenos">128</span></a>            <span class="n">inaccuracy</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dependent_variables</span> <span class="o">-</span> <span class="n">dependent_variables</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</span><span id="LinearReadout.train-129"><a href="#LinearReadout.train-129"><span class="linenos">129</span></a>            <span class="n">pcc</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">inaccuracy</span> <span class="o">**</span> <span class="mi">2</span>
</span><span id="LinearReadout.train-130"><a href="#LinearReadout.train-130"><span class="linenos">130</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> layer trained. Inaccuracy = </span><span class="si">{</span><span class="n">inaccuracy</span><span class="si">}</span><span class="s2"> and pcc = </span><span class="si">{</span><span class="n">pcc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="LinearReadout.train-131"><a href="#LinearReadout.train-131"><span class="linenos">131</span></a>
</span><span id="LinearReadout.train-132"><a href="#LinearReadout.train-132"><span class="linenos">132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span> <span class="o">=</span> <span class="n">coeff</span><span class="o">.</span><span class="n">T</span>
</span></pre></div>


            <div class="docstring"><p>Trains the linear readout layer by solving the least-squares optimization problem.</p>

<p>The training process determines the optimal readout coefficients $W^*$ by solving the optimization problem
below:</p>

<p>$$W^* = \lim_{\lambda\to 0^+} \arg\min_W \| XW - Y\|_F^2 + \lambda \|W\|_F^2$$</p>

<p>where $X$ is the matrix of reservoir states (independent variables)
and $Y$ is the matrix of target output values (dependent variables).</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>independent_variables (np.ndarray):</strong>  The reservoir state matrix used for training.</li>
<li><strong>dependent_variables (np.ndarray):</strong>  The target output values corresponding to the reservoir states.</li>
</ul>
</div>


                            </div>
                            <div id="LinearReadout.reservoir_to_output" class="classattr">
                                        <input id="LinearReadout.reservoir_to_output-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">reservoir_to_output</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">reservoir_state</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="LinearReadout.reservoir_to_output-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LinearReadout.reservoir_to_output"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LinearReadout.reservoir_to_output-134"><a href="#LinearReadout.reservoir_to_output-134"><span class="linenos">134</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">reservoir_to_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reservoir_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]:</span>
</span><span id="LinearReadout.reservoir_to_output-135"><a href="#LinearReadout.reservoir_to_output-135"><span class="linenos">135</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LinearReadout.reservoir_to_output-136"><a href="#LinearReadout.reservoir_to_output-136"><span class="linenos">136</span></a><span class="sd">        Computes the output from a given reservoir state using a learned linear mapping.</span>
</span><span id="LinearReadout.reservoir_to_output-137"><a href="#LinearReadout.reservoir_to_output-137"><span class="linenos">137</span></a>
</span><span id="LinearReadout.reservoir_to_output-138"><a href="#LinearReadout.reservoir_to_output-138"><span class="linenos">138</span></a><span class="sd">        This method applies the learned weight matrix (`self.coefficients`) to map</span>
</span><span id="LinearReadout.reservoir_to_output-139"><a href="#LinearReadout.reservoir_to_output-139"><span class="linenos">139</span></a><span class="sd">        the reservoir state to an output value.</span>
</span><span id="LinearReadout.reservoir_to_output-140"><a href="#LinearReadout.reservoir_to_output-140"><span class="linenos">140</span></a>
</span><span id="LinearReadout.reservoir_to_output-141"><a href="#LinearReadout.reservoir_to_output-141"><span class="linenos">141</span></a><span class="sd">        Args:</span>
</span><span id="LinearReadout.reservoir_to_output-142"><a href="#LinearReadout.reservoir_to_output-142"><span class="linenos">142</span></a><span class="sd">            reservoir_state (np.ndarray):</span>
</span><span id="LinearReadout.reservoir_to_output-143"><a href="#LinearReadout.reservoir_to_output-143"><span class="linenos">143</span></a><span class="sd">                The reservoir state to be mapped to an output value.</span>
</span><span id="LinearReadout.reservoir_to_output-144"><a href="#LinearReadout.reservoir_to_output-144"><span class="linenos">144</span></a>
</span><span id="LinearReadout.reservoir_to_output-145"><a href="#LinearReadout.reservoir_to_output-145"><span class="linenos">145</span></a><span class="sd">        Returns:</span>
</span><span id="LinearReadout.reservoir_to_output-146"><a href="#LinearReadout.reservoir_to_output-146"><span class="linenos">146</span></a><span class="sd">            np.ndarray: The predicted output value.</span>
</span><span id="LinearReadout.reservoir_to_output-147"><a href="#LinearReadout.reservoir_to_output-147"><span class="linenos">147</span></a>
</span><span id="LinearReadout.reservoir_to_output-148"><a href="#LinearReadout.reservoir_to_output-148"><span class="linenos">148</span></a><span class="sd">        Raises:</span>
</span><span id="LinearReadout.reservoir_to_output-149"><a href="#LinearReadout.reservoir_to_output-149"><span class="linenos">149</span></a><span class="sd">            ValueError: If the readout layer has not been trained (i.e., coefficients are not set).</span>
</span><span id="LinearReadout.reservoir_to_output-150"><a href="#LinearReadout.reservoir_to_output-150"><span class="linenos">150</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LinearReadout.reservoir_to_output-151"><a href="#LinearReadout.reservoir_to_output-151"><span class="linenos">151</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;coefficients&quot;</span><span class="p">):</span>
</span><span id="LinearReadout.reservoir_to_output-152"><a href="#LinearReadout.reservoir_to_output-152"><span class="linenos">152</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Need to train readout before using it&quot;</span><span class="p">)</span>
</span><span id="LinearReadout.reservoir_to_output-153"><a href="#LinearReadout.reservoir_to_output-153"><span class="linenos">153</span></a>
</span><span id="LinearReadout.reservoir_to_output-154"><a href="#LinearReadout.reservoir_to_output-154"><span class="linenos">154</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">coefficients</span> <span class="o">@</span> <span class="n">reservoir_state</span>
</span></pre></div>


            <div class="docstring"><p>Computes the output from a given reservoir state using a learned linear mapping.</p>

<p>This method applies the learned weight matrix (<code>self.coefficients</code>) to map
the reservoir state to an output value.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>reservoir_state (np.ndarray):</strong>  The reservoir state to be mapped to an output value.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>np.ndarray: The predicted output value.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If the readout layer has not been trained (i.e., coefficients are not set).</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Readout">Readout</a></dt>
                                <dd id="LinearReadout.coefficients" class="variable"><a href="#Readout.coefficients">coefficients</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<!-- End of C:/CodingGeneral/chicagoClubManagement/aqua-blue/_build/aqua_blue/readouts.html -->
<!-- Start of C:/CodingGeneral/chicagoClubManagement/aqua-blue/_build/aqua_blue/reservoirs.html -->
<nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../aqua_blue.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;aqua_blue</a>

            <img src="https://raw.githubusercontent.com/Chicago-Club-Management-Company/aqua-blue/refs/heads/main/assets/blue.jpg" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#ActivationFunction">ActivationFunction</a>
            </li>
            <li>
                    <a class="variable" href="#logger">logger</a>
            </li>
            <li>
                    <a class="class" href="#Reservoir">Reservoir</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#Reservoir.input_dimensionality">input_dimensionality</a>
                        </li>
                        <li>
                                <a class="variable" href="#Reservoir.reservoir_dimensionality">reservoir_dimensionality</a>
                        </li>
                        <li>
                                <a class="variable" href="#Reservoir.res_state">res_state</a>
                        </li>
                        <li>
                                <a class="function" href="#Reservoir.update_reservoir">update_reservoir</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#DynamicalReservoir">DynamicalReservoir</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DynamicalReservoir.__init__">DynamicalReservoir</a>
                        </li>
                        <li>
                                <a class="variable" href="#DynamicalReservoir.generator">generator</a>
                        </li>
                        <li>
                                <a class="variable" href="#DynamicalReservoir.w_in">w_in</a>
                        </li>
                        <li>
                                <a class="variable" href="#DynamicalReservoir.w_res">w_res</a>
                        </li>
                        <li>
                                <a class="variable" href="#DynamicalReservoir.activation_function">activation_function</a>
                        </li>
                        <li>
                                <a class="variable" href="#DynamicalReservoir.leaking_rate">leaking_rate</a>
                        </li>
                        <li>
                                <a class="variable" href="#DynamicalReservoir.sparsity">sparsity</a>
                        </li>
                        <li>
                                <a class="variable" href="#DynamicalReservoir.spectral_radius">spectral_radius</a>
                        </li>
                        <li>
                                <a class="function" href="#DynamicalReservoir.update_reservoir">update_reservoir</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../aqua_blue.html">aqua_blue</a><wbr>.reservoirs    </h1>

                        <div class="docstring"><p>Module defining reservoirs.</p>

<p>This module contains the base <code><a href="#Reservoir">Reservoir</a></code> class and its concrete implementation,
<code><a href="#DynamicalReservoir">DynamicalReservoir</a></code>. Reservoirs serve as dynamic memory structures in Echo State
Networks (ESNs) by transforming input signals into high-dimensional representations.</p>

<h6 id="classes">Classes:</h6>

<blockquote>
  <ul>
  <li>Reservoir: Abstract base class defining the structure of a reservoir.</li>
  <li>DynamicalReservoir: A specific implementation of a reservoir with tunable
  dynamics and activation functions.</li>
  </ul>
</blockquote>
</div>

                        <input id="mod-reservoirs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-reservoirs-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">Module defining reservoirs.</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">This module contains the base `Reservoir` class and its concrete implementation,</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">`DynamicalReservoir`. Reservoirs serve as dynamic memory structures in Echo State</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">Networks (ESNs) by transforming input signals into high-dimensional representations.</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">Classes:</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">    - Reservoir: Abstract base class defining the structure of a reservoir.</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="sd">    - DynamicalReservoir: A specific implementation of a reservoir with tunable</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="sd">      dynamics and activation functions.</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Callable</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.utilities</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_sparse</span><span class="p">,</span> <span class="n">set_spectral</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="n">ActivationFunction</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]],</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">&quot;&quot;&quot;activation function, taking in a numpy array and returning a numpy array of the same shape&quot;&quot;&quot;</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="nd">@dataclass</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Reservoir</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="w">    </span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">    Abstract base class defining a reservoir in an Echo State Network (ESN).</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">    Reservoirs are responsible for transforming input signals into high-dimensional</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">    representations, which are then used by the readout layer for predictions.</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">    Attributes:</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">        input_dimensionality (int):</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">            The number of input features.</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">        reservoir_dimensionality (int):</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">            The number of reservoir neurons (i.e., the size of the reservoir).</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">        res_state (np.ndarray):</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">            The current state of the reservoir, which is updated at each time step.</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>    
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>    <span class="n">input_dimensionality</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dimensionality of the input state.&quot;&quot;&quot;</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>    <span class="n">reservoir_dimensionality</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dimensionality of the reservoir state, equivalently the reservoir size.&quot;&quot;&quot;</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>    <span class="n">res_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reservoir state, necessary property when performing training loop.&quot;&quot;&quot;</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_reservoir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]:</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">        Updates the reservoir state given an input state.</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">        This method defines the transformation applied to an input vector when passed</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">        through the reservoir.</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>        <span class="k">pass</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="nd">@dataclass</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="k">class</span><span class="w"> </span><span class="nc">DynamicalReservoir</span><span class="p">(</span><span class="n">Reservoir</span><span class="p">):</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="w">    </span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">    A dynamical reservoir with tunable properties.</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">    This reservoir is defined by the equation:</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">    $$y_t = (1 - \alpha) y_{t-1} + \alpha f(W_\text{in} x_t + W_\text{res} y_{t-1})$$</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">    where $x_t$ is the input at time step $t$, $y_t$ is the reservoir state at time $t$,</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">    $W_\text{in}$ is the input weight matrix, $W_\text{res}$ is the reservoir weight matrix,</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">    $\alpha$ (leaking_rate) controls how much of the previous state influences the next state,</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">    and $f$ is a nonlinear activation function.</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">    Attributes:</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">        generator (Optional[np.random.Generator]):</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">            Random number generator for weight initialization.</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">        w_in (Optional[np.ndarray]):</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">            Input weight matrix of shape `(reservoir_dimensionality, input_dimensionality)`.</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">            Auto-generated if not provided.</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">        w_res (Optional[np.ndarray]):</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">            Reservoir weight matrix of shape `(reservoir_dimensionality, reservoir_dimensionality)`.</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">            Auto-generated if not provided.</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">        activation_function (ActivationFunction):</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">            Activation function applied to the reservoir state. Defaults to `np.tanh`.</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">        leaking_rate (float):</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">            Leaking rate that controls the contribution of the previous state.</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>    
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>    <span class="n">generator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Generator</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">    Random generator for initializing weights.</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">    Defaults to `np.random.default_rng(seed=0)` if not specified.</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>    
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>    <span class="n">w_in</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="sd">    Input weight matrix.</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">    Must have shape `(reservoir_dimensionality, input_dimensionality)`.</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="sd">    If not provided, it is auto-generated with values in `[-0.5, 0.5]`.</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>    <span class="n">w_res</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">    Reservoir weight matrix.</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="sd">    Must have shape `(reservoir_dimensionality, reservoir_dimensionality)`.</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">    If not provided, it is auto-generated and normalized to have a spectral radius of 0.95.</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>    <span class="n">activation_function</span><span class="p">:</span> <span class="n">ActivationFunction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a><span class="sd">    Nonlinear activation function applied to the reservoir state.</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="sd">    Defaults to `np.tanh`, but can be replaced with other functions like ReLU.</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>    <span class="n">leaking_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="sd">    Leaking rate (\(\alpha\)) that controls how much of the previous state contributes to the next.</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a><span class="sd">    Defaults to `1.0`, meaning the state is fully updated at each time step.</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>    
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>    <span class="n">sparsity</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="sd">    sparsity of the reservoir weight matrix. (0, 1] </span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>    
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>    <span class="n">spectral_radius</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.95</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="sd">    spectral radius of reservoir weight matrix.</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="sd">    Recommended values - [0.9, 1.2] </span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="sd">        Initializes the reservoir by generating input and reservoir weight matrices (if not provided).</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a><span class="sd">        Ensures that:</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a><span class="sd">        - The reservoir weight matrix has a spectral radius of approximately 0.95.</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a><span class="sd">        - The reservoir state is initialized to zero.</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">w_in</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">w_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>                <span class="n">low</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>                <span class="n">high</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>                <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reservoir_dimensionality</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_dimensionality</span><span class="p">)</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>            <span class="p">)</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">w_res</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">w_res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>                <span class="n">low</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>                <span class="n">high</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>                <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reservoir_dimensionality</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir_dimensionality</span><span class="p">)</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>            <span class="p">)</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sparsity</span><span class="p">:</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">w_res</span> <span class="o">=</span> <span class="n">make_sparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w_res</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sparsity</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="p">)</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>        <span class="k">if</span> <span class="n">logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">):</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.w_res sparsity set to </span><span class="si">{</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">w_res</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">w_res</span> <span class="o">=</span> <span class="n">set_spectral</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w_res</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectral_radius</span><span class="p">)</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>        <span class="k">if</span> <span class="n">logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">):</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.w_res spectral radius set to </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w_res</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>        
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">res_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reservoir_dimensionality</span><span class="p">)</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_reservoir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]:</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a><span class="sd">        Updates the reservoir state given an input.</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a><span class="sd">        This method applies the state update equation:</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a><span class="sd">        $$y_t = (1 - \alpha) y_{t-1} + \alpha f(W_\text{in} x_t + W_\text{res} y_{t-1})$$</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a><span class="sd">        Args:</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a><span class="sd">            input_state (np.ndarray):</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a><span class="sd">                The input state vector.</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a><span class="sd">        Returns:</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a><span class="sd">            np.ndarray: The updated reservoir state.</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w_in</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w_res</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">res_state</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaking_rate</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">res_state</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaking_rate</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">activation_function</span><span class="p">(</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">w_in</span> <span class="o">@</span> <span class="n">input_state</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w_res</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">res_state</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>        <span class="p">)</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">res_state</span>
</span></pre></div>


            </section>
                <section id="ActivationFunction">
                    <div class="attr variable">
            <span class="name">ActivationFunction</span>        =
<input id="ActivationFunction-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="ActivationFunction-view-value"></label><span class="default_value">typing.Callable[[numpy.ndarray[typing.Any, numpy.dtype[numpy.floating]]], numpy.ndarray[typing.Any, numpy.dtype[numpy.floating]]]</span>

        
    </div>
    <a class="headerlink" href="#ActivationFunction"></a>
    
            <div class="docstring"><p>activation function, taking in a numpy array and returning a numpy array of the same shape</p>
</div>


                </section>
                <section id="logger">
                    <div class="attr variable">
            <span class="name">logger</span>        =
<span class="default_value">&lt;Logger <a href="">aqua_blue.reservoirs</a> (WARNING)&gt;</span>

        
    </div>
    <a class="headerlink" href="#logger"></a>
    
    

                </section>
                <section id="Reservoir">
                            <input id="Reservoir-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">Reservoir</span><wbr>(<span class="base">abc.ABC</span>):

                <label class="view-source-button" for="Reservoir-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Reservoir"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Reservoir-32"><a href="#Reservoir-32"><span class="linenos">32</span></a><span class="nd">@dataclass</span>
</span><span id="Reservoir-33"><a href="#Reservoir-33"><span class="linenos">33</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Reservoir</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="Reservoir-34"><a href="#Reservoir-34"><span class="linenos">34</span></a><span class="w">    </span>
</span><span id="Reservoir-35"><a href="#Reservoir-35"><span class="linenos">35</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Reservoir-36"><a href="#Reservoir-36"><span class="linenos">36</span></a><span class="sd">    Abstract base class defining a reservoir in an Echo State Network (ESN).</span>
</span><span id="Reservoir-37"><a href="#Reservoir-37"><span class="linenos">37</span></a>
</span><span id="Reservoir-38"><a href="#Reservoir-38"><span class="linenos">38</span></a><span class="sd">    Reservoirs are responsible for transforming input signals into high-dimensional</span>
</span><span id="Reservoir-39"><a href="#Reservoir-39"><span class="linenos">39</span></a><span class="sd">    representations, which are then used by the readout layer for predictions.</span>
</span><span id="Reservoir-40"><a href="#Reservoir-40"><span class="linenos">40</span></a>
</span><span id="Reservoir-41"><a href="#Reservoir-41"><span class="linenos">41</span></a><span class="sd">    Attributes:</span>
</span><span id="Reservoir-42"><a href="#Reservoir-42"><span class="linenos">42</span></a><span class="sd">        input_dimensionality (int):</span>
</span><span id="Reservoir-43"><a href="#Reservoir-43"><span class="linenos">43</span></a><span class="sd">            The number of input features.</span>
</span><span id="Reservoir-44"><a href="#Reservoir-44"><span class="linenos">44</span></a><span class="sd">        reservoir_dimensionality (int):</span>
</span><span id="Reservoir-45"><a href="#Reservoir-45"><span class="linenos">45</span></a><span class="sd">            The number of reservoir neurons (i.e., the size of the reservoir).</span>
</span><span id="Reservoir-46"><a href="#Reservoir-46"><span class="linenos">46</span></a><span class="sd">        res_state (np.ndarray):</span>
</span><span id="Reservoir-47"><a href="#Reservoir-47"><span class="linenos">47</span></a><span class="sd">            The current state of the reservoir, which is updated at each time step.</span>
</span><span id="Reservoir-48"><a href="#Reservoir-48"><span class="linenos">48</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Reservoir-49"><a href="#Reservoir-49"><span class="linenos">49</span></a>    
</span><span id="Reservoir-50"><a href="#Reservoir-50"><span class="linenos">50</span></a>    <span class="n">input_dimensionality</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="Reservoir-51"><a href="#Reservoir-51"><span class="linenos">51</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dimensionality of the input state.&quot;&quot;&quot;</span>
</span><span id="Reservoir-52"><a href="#Reservoir-52"><span class="linenos">52</span></a>
</span><span id="Reservoir-53"><a href="#Reservoir-53"><span class="linenos">53</span></a>    <span class="n">reservoir_dimensionality</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="Reservoir-54"><a href="#Reservoir-54"><span class="linenos">54</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Dimensionality of the reservoir state, equivalently the reservoir size.&quot;&quot;&quot;</span>
</span><span id="Reservoir-55"><a href="#Reservoir-55"><span class="linenos">55</span></a>
</span><span id="Reservoir-56"><a href="#Reservoir-56"><span class="linenos">56</span></a>    <span class="n">res_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Reservoir-57"><a href="#Reservoir-57"><span class="linenos">57</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Reservoir state, necessary property when performing training loop.&quot;&quot;&quot;</span>
</span><span id="Reservoir-58"><a href="#Reservoir-58"><span class="linenos">58</span></a>
</span><span id="Reservoir-59"><a href="#Reservoir-59"><span class="linenos">59</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="Reservoir-60"><a href="#Reservoir-60"><span class="linenos">60</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_reservoir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]:</span>
</span><span id="Reservoir-61"><a href="#Reservoir-61"><span class="linenos">61</span></a>
</span><span id="Reservoir-62"><a href="#Reservoir-62"><span class="linenos">62</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Reservoir-63"><a href="#Reservoir-63"><span class="linenos">63</span></a><span class="sd">        Updates the reservoir state given an input state.</span>
</span><span id="Reservoir-64"><a href="#Reservoir-64"><span class="linenos">64</span></a>
</span><span id="Reservoir-65"><a href="#Reservoir-65"><span class="linenos">65</span></a><span class="sd">        This method defines the transformation applied to an input vector when passed</span>
</span><span id="Reservoir-66"><a href="#Reservoir-66"><span class="linenos">66</span></a><span class="sd">        through the reservoir.</span>
</span><span id="Reservoir-67"><a href="#Reservoir-67"><span class="linenos">67</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Reservoir-68"><a href="#Reservoir-68"><span class="linenos">68</span></a>
</span><span id="Reservoir-69"><a href="#Reservoir-69"><span class="linenos">69</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Abstract base class defining a reservoir in an Echo State Network (ESN).</p>

<p>Reservoirs are responsible for transforming input signals into high-dimensional
representations, which are then used by the readout layer for predictions.</p>

<h6 id="attributes">Attributes:</h6>

<ul>
<li><strong>input_dimensionality (int):</strong>  The number of input features.</li>
<li><strong>reservoir_dimensionality (int):</strong>  The number of reservoir neurons (i.e., the size of the reservoir).</li>
<li><strong>res_state (np.ndarray):</strong>  The current state of the reservoir, which is updated at each time step.</li>
</ul>
</div>


                            <div id="Reservoir.input_dimensionality" class="classattr">
                                <div class="attr variable">
            <span class="name">input_dimensionality</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#Reservoir.input_dimensionality"></a>
    
            <div class="docstring"><p>Dimensionality of the input state.</p>
</div>


                            </div>
                            <div id="Reservoir.reservoir_dimensionality" class="classattr">
                                <div class="attr variable">
            <span class="name">reservoir_dimensionality</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#Reservoir.reservoir_dimensionality"></a>
    
            <div class="docstring"><p>Dimensionality of the reservoir state, equivalently the reservoir size.</p>
</div>


                            </div>
                            <div id="Reservoir.res_state" class="classattr">
                                <div class="attr variable">
            <span class="name">res_state</span><span class="annotation">: numpy.ndarray[typing.Any, numpy.dtype[numpy.floating]]</span>

        
    </div>
    <a class="headerlink" href="#Reservoir.res_state"></a>
    
            <div class="docstring"><p>Reservoir state, necessary property when performing training loop.</p>
</div>


                            </div>
                            <div id="Reservoir.update_reservoir" class="classattr">
                                        <input id="Reservoir.update_reservoir-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-abstractmethod">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">update_reservoir</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">input_state</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="Reservoir.update_reservoir-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Reservoir.update_reservoir"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Reservoir.update_reservoir-59"><a href="#Reservoir.update_reservoir-59"><span class="linenos">59</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="Reservoir.update_reservoir-60"><a href="#Reservoir.update_reservoir-60"><span class="linenos">60</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_reservoir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]:</span>
</span><span id="Reservoir.update_reservoir-61"><a href="#Reservoir.update_reservoir-61"><span class="linenos">61</span></a>
</span><span id="Reservoir.update_reservoir-62"><a href="#Reservoir.update_reservoir-62"><span class="linenos">62</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Reservoir.update_reservoir-63"><a href="#Reservoir.update_reservoir-63"><span class="linenos">63</span></a><span class="sd">        Updates the reservoir state given an input state.</span>
</span><span id="Reservoir.update_reservoir-64"><a href="#Reservoir.update_reservoir-64"><span class="linenos">64</span></a>
</span><span id="Reservoir.update_reservoir-65"><a href="#Reservoir.update_reservoir-65"><span class="linenos">65</span></a><span class="sd">        This method defines the transformation applied to an input vector when passed</span>
</span><span id="Reservoir.update_reservoir-66"><a href="#Reservoir.update_reservoir-66"><span class="linenos">66</span></a><span class="sd">        through the reservoir.</span>
</span><span id="Reservoir.update_reservoir-67"><a href="#Reservoir.update_reservoir-67"><span class="linenos">67</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Reservoir.update_reservoir-68"><a href="#Reservoir.update_reservoir-68"><span class="linenos">68</span></a>
</span><span id="Reservoir.update_reservoir-69"><a href="#Reservoir.update_reservoir-69"><span class="linenos">69</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Updates the reservoir state given an input state.</p>

<p>This method defines the transformation applied to an input vector when passed
through the reservoir.</p>
</div>


                            </div>
                </section>
                <section id="DynamicalReservoir">
                            <input id="DynamicalReservoir-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">DynamicalReservoir</span><wbr>(<span class="base"><a href="#Reservoir">Reservoir</a></span>):

                <label class="view-source-button" for="DynamicalReservoir-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DynamicalReservoir"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DynamicalReservoir-72"><a href="#DynamicalReservoir-72"><span class="linenos"> 72</span></a><span class="nd">@dataclass</span>
</span><span id="DynamicalReservoir-73"><a href="#DynamicalReservoir-73"><span class="linenos"> 73</span></a><span class="k">class</span><span class="w"> </span><span class="nc">DynamicalReservoir</span><span class="p">(</span><span class="n">Reservoir</span><span class="p">):</span>
</span><span id="DynamicalReservoir-74"><a href="#DynamicalReservoir-74"><span class="linenos"> 74</span></a><span class="w">    </span>
</span><span id="DynamicalReservoir-75"><a href="#DynamicalReservoir-75"><span class="linenos"> 75</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DynamicalReservoir-76"><a href="#DynamicalReservoir-76"><span class="linenos"> 76</span></a><span class="sd">    A dynamical reservoir with tunable properties.</span>
</span><span id="DynamicalReservoir-77"><a href="#DynamicalReservoir-77"><span class="linenos"> 77</span></a>
</span><span id="DynamicalReservoir-78"><a href="#DynamicalReservoir-78"><span class="linenos"> 78</span></a><span class="sd">    This reservoir is defined by the equation:</span>
</span><span id="DynamicalReservoir-79"><a href="#DynamicalReservoir-79"><span class="linenos"> 79</span></a>
</span><span id="DynamicalReservoir-80"><a href="#DynamicalReservoir-80"><span class="linenos"> 80</span></a><span class="sd">    $$y_t = (1 - \alpha) y_{t-1} + \alpha f(W_\text{in} x_t + W_\text{res} y_{t-1})$$</span>
</span><span id="DynamicalReservoir-81"><a href="#DynamicalReservoir-81"><span class="linenos"> 81</span></a>
</span><span id="DynamicalReservoir-82"><a href="#DynamicalReservoir-82"><span class="linenos"> 82</span></a><span class="sd">    where $x_t$ is the input at time step $t$, $y_t$ is the reservoir state at time $t$,</span>
</span><span id="DynamicalReservoir-83"><a href="#DynamicalReservoir-83"><span class="linenos"> 83</span></a><span class="sd">    $W_\text{in}$ is the input weight matrix, $W_\text{res}$ is the reservoir weight matrix,</span>
</span><span id="DynamicalReservoir-84"><a href="#DynamicalReservoir-84"><span class="linenos"> 84</span></a><span class="sd">    $\alpha$ (leaking_rate) controls how much of the previous state influences the next state,</span>
</span><span id="DynamicalReservoir-85"><a href="#DynamicalReservoir-85"><span class="linenos"> 85</span></a><span class="sd">    and $f$ is a nonlinear activation function.</span>
</span><span id="DynamicalReservoir-86"><a href="#DynamicalReservoir-86"><span class="linenos"> 86</span></a>
</span><span id="DynamicalReservoir-87"><a href="#DynamicalReservoir-87"><span class="linenos"> 87</span></a><span class="sd">    Attributes:</span>
</span><span id="DynamicalReservoir-88"><a href="#DynamicalReservoir-88"><span class="linenos"> 88</span></a><span class="sd">        generator (Optional[np.random.Generator]):</span>
</span><span id="DynamicalReservoir-89"><a href="#DynamicalReservoir-89"><span class="linenos"> 89</span></a><span class="sd">            Random number generator for weight initialization.</span>
</span><span id="DynamicalReservoir-90"><a href="#DynamicalReservoir-90"><span class="linenos"> 90</span></a><span class="sd">        w_in (Optional[np.ndarray]):</span>
</span><span id="DynamicalReservoir-91"><a href="#DynamicalReservoir-91"><span class="linenos"> 91</span></a><span class="sd">            Input weight matrix of shape `(reservoir_dimensionality, input_dimensionality)`.</span>
</span><span id="DynamicalReservoir-92"><a href="#DynamicalReservoir-92"><span class="linenos"> 92</span></a><span class="sd">            Auto-generated if not provided.</span>
</span><span id="DynamicalReservoir-93"><a href="#DynamicalReservoir-93"><span class="linenos"> 93</span></a><span class="sd">        w_res (Optional[np.ndarray]):</span>
</span><span id="DynamicalReservoir-94"><a href="#DynamicalReservoir-94"><span class="linenos"> 94</span></a><span class="sd">            Reservoir weight matrix of shape `(reservoir_dimensionality, reservoir_dimensionality)`.</span>
</span><span id="DynamicalReservoir-95"><a href="#DynamicalReservoir-95"><span class="linenos"> 95</span></a><span class="sd">            Auto-generated if not provided.</span>
</span><span id="DynamicalReservoir-96"><a href="#DynamicalReservoir-96"><span class="linenos"> 96</span></a><span class="sd">        activation_function (ActivationFunction):</span>
</span><span id="DynamicalReservoir-97"><a href="#DynamicalReservoir-97"><span class="linenos"> 97</span></a><span class="sd">            Activation function applied to the reservoir state. Defaults to `np.tanh`.</span>
</span><span id="DynamicalReservoir-98"><a href="#DynamicalReservoir-98"><span class="linenos"> 98</span></a><span class="sd">        leaking_rate (float):</span>
</span><span id="DynamicalReservoir-99"><a href="#DynamicalReservoir-99"><span class="linenos"> 99</span></a><span class="sd">            Leaking rate that controls the contribution of the previous state.</span>
</span><span id="DynamicalReservoir-100"><a href="#DynamicalReservoir-100"><span class="linenos">100</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DynamicalReservoir-101"><a href="#DynamicalReservoir-101"><span class="linenos">101</span></a>    
</span><span id="DynamicalReservoir-102"><a href="#DynamicalReservoir-102"><span class="linenos">102</span></a>    <span class="n">generator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Generator</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DynamicalReservoir-103"><a href="#DynamicalReservoir-103"><span class="linenos">103</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DynamicalReservoir-104"><a href="#DynamicalReservoir-104"><span class="linenos">104</span></a><span class="sd">    Random generator for initializing weights.</span>
</span><span id="DynamicalReservoir-105"><a href="#DynamicalReservoir-105"><span class="linenos">105</span></a><span class="sd">    Defaults to `np.random.default_rng(seed=0)` if not specified.</span>
</span><span id="DynamicalReservoir-106"><a href="#DynamicalReservoir-106"><span class="linenos">106</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DynamicalReservoir-107"><a href="#DynamicalReservoir-107"><span class="linenos">107</span></a>    
</span><span id="DynamicalReservoir-108"><a href="#DynamicalReservoir-108"><span class="linenos">108</span></a>    <span class="n">w_in</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DynamicalReservoir-109"><a href="#DynamicalReservoir-109"><span class="linenos">109</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DynamicalReservoir-110"><a href="#DynamicalReservoir-110"><span class="linenos">110</span></a><span class="sd">    Input weight matrix.</span>
</span><span id="DynamicalReservoir-111"><a href="#DynamicalReservoir-111"><span class="linenos">111</span></a><span class="sd">    Must have shape `(reservoir_dimensionality, input_dimensionality)`.</span>
</span><span id="DynamicalReservoir-112"><a href="#DynamicalReservoir-112"><span class="linenos">112</span></a><span class="sd">    If not provided, it is auto-generated with values in `[-0.5, 0.5]`.</span>
</span><span id="DynamicalReservoir-113"><a href="#DynamicalReservoir-113"><span class="linenos">113</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DynamicalReservoir-114"><a href="#DynamicalReservoir-114"><span class="linenos">114</span></a>
</span><span id="DynamicalReservoir-115"><a href="#DynamicalReservoir-115"><span class="linenos">115</span></a>    <span class="n">w_res</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DynamicalReservoir-116"><a href="#DynamicalReservoir-116"><span class="linenos">116</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DynamicalReservoir-117"><a href="#DynamicalReservoir-117"><span class="linenos">117</span></a><span class="sd">    Reservoir weight matrix.</span>
</span><span id="DynamicalReservoir-118"><a href="#DynamicalReservoir-118"><span class="linenos">118</span></a><span class="sd">    Must have shape `(reservoir_dimensionality, reservoir_dimensionality)`.</span>
</span><span id="DynamicalReservoir-119"><a href="#DynamicalReservoir-119"><span class="linenos">119</span></a><span class="sd">    If not provided, it is auto-generated and normalized to have a spectral radius of 0.95.</span>
</span><span id="DynamicalReservoir-120"><a href="#DynamicalReservoir-120"><span class="linenos">120</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DynamicalReservoir-121"><a href="#DynamicalReservoir-121"><span class="linenos">121</span></a>
</span><span id="DynamicalReservoir-122"><a href="#DynamicalReservoir-122"><span class="linenos">122</span></a>    <span class="n">activation_function</span><span class="p">:</span> <span class="n">ActivationFunction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span>
</span><span id="DynamicalReservoir-123"><a href="#DynamicalReservoir-123"><span class="linenos">123</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DynamicalReservoir-124"><a href="#DynamicalReservoir-124"><span class="linenos">124</span></a><span class="sd">    Nonlinear activation function applied to the reservoir state.</span>
</span><span id="DynamicalReservoir-125"><a href="#DynamicalReservoir-125"><span class="linenos">125</span></a><span class="sd">    Defaults to `np.tanh`, but can be replaced with other functions like ReLU.</span>
</span><span id="DynamicalReservoir-126"><a href="#DynamicalReservoir-126"><span class="linenos">126</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DynamicalReservoir-127"><a href="#DynamicalReservoir-127"><span class="linenos">127</span></a>
</span><span id="DynamicalReservoir-128"><a href="#DynamicalReservoir-128"><span class="linenos">128</span></a>    <span class="n">leaking_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="DynamicalReservoir-129"><a href="#DynamicalReservoir-129"><span class="linenos">129</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="DynamicalReservoir-130"><a href="#DynamicalReservoir-130"><span class="linenos">130</span></a><span class="sd">    Leaking rate (\(\alpha\)) that controls how much of the previous state contributes to the next.</span>
</span><span id="DynamicalReservoir-131"><a href="#DynamicalReservoir-131"><span class="linenos">131</span></a><span class="sd">    Defaults to `1.0`, meaning the state is fully updated at each time step.</span>
</span><span id="DynamicalReservoir-132"><a href="#DynamicalReservoir-132"><span class="linenos">132</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DynamicalReservoir-133"><a href="#DynamicalReservoir-133"><span class="linenos">133</span></a>    
</span><span id="DynamicalReservoir-134"><a href="#DynamicalReservoir-134"><span class="linenos">134</span></a>    <span class="n">sparsity</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DynamicalReservoir-135"><a href="#DynamicalReservoir-135"><span class="linenos">135</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DynamicalReservoir-136"><a href="#DynamicalReservoir-136"><span class="linenos">136</span></a><span class="sd">    sparsity of the reservoir weight matrix. (0, 1] </span>
</span><span id="DynamicalReservoir-137"><a href="#DynamicalReservoir-137"><span class="linenos">137</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DynamicalReservoir-138"><a href="#DynamicalReservoir-138"><span class="linenos">138</span></a>    
</span><span id="DynamicalReservoir-139"><a href="#DynamicalReservoir-139"><span class="linenos">139</span></a>    <span class="n">spectral_radius</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.95</span>
</span><span id="DynamicalReservoir-140"><a href="#DynamicalReservoir-140"><span class="linenos">140</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DynamicalReservoir-141"><a href="#DynamicalReservoir-141"><span class="linenos">141</span></a><span class="sd">    spectral radius of reservoir weight matrix.</span>
</span><span id="DynamicalReservoir-142"><a href="#DynamicalReservoir-142"><span class="linenos">142</span></a><span class="sd">    Recommended values - [0.9, 1.2] </span>
</span><span id="DynamicalReservoir-143"><a href="#DynamicalReservoir-143"><span class="linenos">143</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DynamicalReservoir-144"><a href="#DynamicalReservoir-144"><span class="linenos">144</span></a>
</span><span id="DynamicalReservoir-145"><a href="#DynamicalReservoir-145"><span class="linenos">145</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="DynamicalReservoir-146"><a href="#DynamicalReservoir-146"><span class="linenos">146</span></a>
</span><span id="DynamicalReservoir-147"><a href="#DynamicalReservoir-147"><span class="linenos">147</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DynamicalReservoir-148"><a href="#DynamicalReservoir-148"><span class="linenos">148</span></a><span class="sd">        Initializes the reservoir by generating input and reservoir weight matrices (if not provided).</span>
</span><span id="DynamicalReservoir-149"><a href="#DynamicalReservoir-149"><span class="linenos">149</span></a>
</span><span id="DynamicalReservoir-150"><a href="#DynamicalReservoir-150"><span class="linenos">150</span></a><span class="sd">        Ensures that:</span>
</span><span id="DynamicalReservoir-151"><a href="#DynamicalReservoir-151"><span class="linenos">151</span></a><span class="sd">        - The reservoir weight matrix has a spectral radius of approximately 0.95.</span>
</span><span id="DynamicalReservoir-152"><a href="#DynamicalReservoir-152"><span class="linenos">152</span></a><span class="sd">        - The reservoir state is initialized to zero.</span>
</span><span id="DynamicalReservoir-153"><a href="#DynamicalReservoir-153"><span class="linenos">153</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DynamicalReservoir-154"><a href="#DynamicalReservoir-154"><span class="linenos">154</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DynamicalReservoir-155"><a href="#DynamicalReservoir-155"><span class="linenos">155</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DynamicalReservoir-156"><a href="#DynamicalReservoir-156"><span class="linenos">156</span></a>
</span><span id="DynamicalReservoir-157"><a href="#DynamicalReservoir-157"><span class="linenos">157</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">w_in</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DynamicalReservoir-158"><a href="#DynamicalReservoir-158"><span class="linenos">158</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">w_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="DynamicalReservoir-159"><a href="#DynamicalReservoir-159"><span class="linenos">159</span></a>                <span class="n">low</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="DynamicalReservoir-160"><a href="#DynamicalReservoir-160"><span class="linenos">160</span></a>                <span class="n">high</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="DynamicalReservoir-161"><a href="#DynamicalReservoir-161"><span class="linenos">161</span></a>                <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reservoir_dimensionality</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_dimensionality</span><span class="p">)</span>
</span><span id="DynamicalReservoir-162"><a href="#DynamicalReservoir-162"><span class="linenos">162</span></a>            <span class="p">)</span>
</span><span id="DynamicalReservoir-163"><a href="#DynamicalReservoir-163"><span class="linenos">163</span></a>
</span><span id="DynamicalReservoir-164"><a href="#DynamicalReservoir-164"><span class="linenos">164</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">w_res</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DynamicalReservoir-165"><a href="#DynamicalReservoir-165"><span class="linenos">165</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">w_res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
</span><span id="DynamicalReservoir-166"><a href="#DynamicalReservoir-166"><span class="linenos">166</span></a>                <span class="n">low</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="DynamicalReservoir-167"><a href="#DynamicalReservoir-167"><span class="linenos">167</span></a>                <span class="n">high</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="DynamicalReservoir-168"><a href="#DynamicalReservoir-168"><span class="linenos">168</span></a>                <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reservoir_dimensionality</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">reservoir_dimensionality</span><span class="p">)</span>
</span><span id="DynamicalReservoir-169"><a href="#DynamicalReservoir-169"><span class="linenos">169</span></a>            <span class="p">)</span>
</span><span id="DynamicalReservoir-170"><a href="#DynamicalReservoir-170"><span class="linenos">170</span></a>
</span><span id="DynamicalReservoir-171"><a href="#DynamicalReservoir-171"><span class="linenos">171</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sparsity</span><span class="p">:</span>
</span><span id="DynamicalReservoir-172"><a href="#DynamicalReservoir-172"><span class="linenos">172</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">w_res</span> <span class="o">=</span> <span class="n">make_sparse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w_res</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sparsity</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="p">)</span>
</span><span id="DynamicalReservoir-173"><a href="#DynamicalReservoir-173"><span class="linenos">173</span></a>        <span class="k">if</span> <span class="n">logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">):</span>
</span><span id="DynamicalReservoir-174"><a href="#DynamicalReservoir-174"><span class="linenos">174</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.w_res sparsity set to </span><span class="si">{</span><span class="mf">1.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">w_res</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DynamicalReservoir-175"><a href="#DynamicalReservoir-175"><span class="linenos">175</span></a>
</span><span id="DynamicalReservoir-176"><a href="#DynamicalReservoir-176"><span class="linenos">176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">w_res</span> <span class="o">=</span> <span class="n">set_spectral</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w_res</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spectral_radius</span><span class="p">)</span>
</span><span id="DynamicalReservoir-177"><a href="#DynamicalReservoir-177"><span class="linenos">177</span></a>        <span class="k">if</span> <span class="n">logger</span><span class="o">.</span><span class="n">isEnabledFor</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">):</span>
</span><span id="DynamicalReservoir-178"><a href="#DynamicalReservoir-178"><span class="linenos">178</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.w_res spectral radius set to </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w_res</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="DynamicalReservoir-179"><a href="#DynamicalReservoir-179"><span class="linenos">179</span></a>        
</span><span id="DynamicalReservoir-180"><a href="#DynamicalReservoir-180"><span class="linenos">180</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">res_state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reservoir_dimensionality</span><span class="p">)</span>
</span><span id="DynamicalReservoir-181"><a href="#DynamicalReservoir-181"><span class="linenos">181</span></a>
</span><span id="DynamicalReservoir-182"><a href="#DynamicalReservoir-182"><span class="linenos">182</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_reservoir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]:</span>
</span><span id="DynamicalReservoir-183"><a href="#DynamicalReservoir-183"><span class="linenos">183</span></a>
</span><span id="DynamicalReservoir-184"><a href="#DynamicalReservoir-184"><span class="linenos">184</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DynamicalReservoir-185"><a href="#DynamicalReservoir-185"><span class="linenos">185</span></a><span class="sd">        Updates the reservoir state given an input.</span>
</span><span id="DynamicalReservoir-186"><a href="#DynamicalReservoir-186"><span class="linenos">186</span></a>
</span><span id="DynamicalReservoir-187"><a href="#DynamicalReservoir-187"><span class="linenos">187</span></a><span class="sd">        This method applies the state update equation:</span>
</span><span id="DynamicalReservoir-188"><a href="#DynamicalReservoir-188"><span class="linenos">188</span></a>
</span><span id="DynamicalReservoir-189"><a href="#DynamicalReservoir-189"><span class="linenos">189</span></a><span class="sd">        $$y_t = (1 - \alpha) y_{t-1} + \alpha f(W_\text{in} x_t + W_\text{res} y_{t-1})$$</span>
</span><span id="DynamicalReservoir-190"><a href="#DynamicalReservoir-190"><span class="linenos">190</span></a>
</span><span id="DynamicalReservoir-191"><a href="#DynamicalReservoir-191"><span class="linenos">191</span></a><span class="sd">        Args:</span>
</span><span id="DynamicalReservoir-192"><a href="#DynamicalReservoir-192"><span class="linenos">192</span></a><span class="sd">            input_state (np.ndarray):</span>
</span><span id="DynamicalReservoir-193"><a href="#DynamicalReservoir-193"><span class="linenos">193</span></a><span class="sd">                The input state vector.</span>
</span><span id="DynamicalReservoir-194"><a href="#DynamicalReservoir-194"><span class="linenos">194</span></a>
</span><span id="DynamicalReservoir-195"><a href="#DynamicalReservoir-195"><span class="linenos">195</span></a><span class="sd">        Returns:</span>
</span><span id="DynamicalReservoir-196"><a href="#DynamicalReservoir-196"><span class="linenos">196</span></a><span class="sd">            np.ndarray: The updated reservoir state.</span>
</span><span id="DynamicalReservoir-197"><a href="#DynamicalReservoir-197"><span class="linenos">197</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DynamicalReservoir-198"><a href="#DynamicalReservoir-198"><span class="linenos">198</span></a>
</span><span id="DynamicalReservoir-199"><a href="#DynamicalReservoir-199"><span class="linenos">199</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w_in</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
</span><span id="DynamicalReservoir-200"><a href="#DynamicalReservoir-200"><span class="linenos">200</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w_res</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
</span><span id="DynamicalReservoir-201"><a href="#DynamicalReservoir-201"><span class="linenos">201</span></a>
</span><span id="DynamicalReservoir-202"><a href="#DynamicalReservoir-202"><span class="linenos">202</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">res_state</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaking_rate</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">res_state</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaking_rate</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">activation_function</span><span class="p">(</span>
</span><span id="DynamicalReservoir-203"><a href="#DynamicalReservoir-203"><span class="linenos">203</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">w_in</span> <span class="o">@</span> <span class="n">input_state</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w_res</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">res_state</span>
</span><span id="DynamicalReservoir-204"><a href="#DynamicalReservoir-204"><span class="linenos">204</span></a>        <span class="p">)</span>
</span><span id="DynamicalReservoir-205"><a href="#DynamicalReservoir-205"><span class="linenos">205</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">res_state</span>
</span></pre></div>


            <div class="docstring"><p>A dynamical reservoir with tunable properties.</p>

<p>This reservoir is defined by the equation:</p>

<p>$$y_t = (1 - \alpha) y_{t-1} + \alpha f(W_\text{in} x_t + W_\text{res} y_{t-1})$$</p>

<p>where $x_t$ is the input at time step $t$, $y_t$ is the reservoir state at time $t$,
$W_\text{in}$ is the input weight matrix, $W_\text{res}$ is the reservoir weight matrix,
$\alpha$ (leaking_rate) controls how much of the previous state influences the next state,
and $f$ is a nonlinear activation function.</p>

<h6 id="attributes">Attributes:</h6>

<ul>
<li><strong>generator (Optional[np.random.Generator]):</strong>  Random number generator for weight initialization.</li>
<li><strong>w_in (Optional[np.ndarray]):</strong>  Input weight matrix of shape <code>(reservoir_dimensionality, input_dimensionality)</code>.
Auto-generated if not provided.</li>
<li><strong>w_res (Optional[np.ndarray]):</strong>  Reservoir weight matrix of shape <code>(reservoir_dimensionality, reservoir_dimensionality)</code>.
Auto-generated if not provided.</li>
<li><strong>activation_function (ActivationFunction):</strong>  Activation function applied to the reservoir state. Defaults to <code>np.tanh</code>.</li>
<li><strong>leaking_rate (float):</strong>  Leaking rate that controls the contribution of the previous state.</li>
</ul>
</div>


                            <div id="DynamicalReservoir.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">DynamicalReservoir</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">input_dimensionality</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">reservoir_dimensionality</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">generator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">Generator</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">w_in</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">floating</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">w_res</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">floating</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">activation_function</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">floating</span><span class="p">]]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">floating</span><span class="p">]]]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">ufunc</span> <span class="s1">&#39;tanh&#39;</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">leaking_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>,</span><span class="param">	<span class="n">sparsity</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">spectral_radius</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.95</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#DynamicalReservoir.__init__"></a>
    
    

                            </div>
                            <div id="DynamicalReservoir.generator" class="classattr">
                                <div class="attr variable">
            <span class="name">generator</span><span class="annotation">: Optional[numpy.random._generator.Generator]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#DynamicalReservoir.generator"></a>
    
            <div class="docstring"><p>Random generator for initializing weights.
Defaults to <code>np.random.default_rng(seed=0)</code> if not specified.</p>
</div>


                            </div>
                            <div id="DynamicalReservoir.w_in" class="classattr">
                                <div class="attr variable">
            <span class="name">w_in</span><span class="annotation">: Optional[numpy.ndarray[Any, numpy.dtype[numpy.floating]]]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#DynamicalReservoir.w_in"></a>
    
            <div class="docstring"><p>Input weight matrix.
Must have shape <code>(reservoir_dimensionality, input_dimensionality)</code>.
If not provided, it is auto-generated with values in <code>[-0.5, 0.5]</code>.</p>
</div>


                            </div>
                            <div id="DynamicalReservoir.w_res" class="classattr">
                                <div class="attr variable">
            <span class="name">w_res</span><span class="annotation">: Optional[numpy.ndarray[Any, numpy.dtype[numpy.floating]]]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#DynamicalReservoir.w_res"></a>
    
            <div class="docstring"><p>Reservoir weight matrix.
Must have shape <code>(reservoir_dimensionality, reservoir_dimensionality)</code>.
If not provided, it is auto-generated and normalized to have a spectral radius of 0.95.</p>
</div>


                            </div>
                            <div id="DynamicalReservoir.activation_function" class="classattr">
                                <div class="attr variable">
            <span class="name">activation_function</span><span class="annotation">: Callable[[numpy.ndarray[Any, numpy.dtype[numpy.floating]]], numpy.ndarray[Any, numpy.dtype[numpy.floating]]]</span>        =
<span class="default_value">&lt;ufunc &#39;tanh&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#DynamicalReservoir.activation_function"></a>
    
            <div class="docstring"><p>Nonlinear activation function applied to the reservoir state.
Defaults to <code>np.tanh</code>, but can be replaced with other functions like ReLU.</p>
</div>


                            </div>
                            <div id="DynamicalReservoir.leaking_rate" class="classattr">
                                <div class="attr variable">
            <span class="name">leaking_rate</span><span class="annotation">: float</span>        =
<span class="default_value">1.0</span>

        
    </div>
    <a class="headerlink" href="#DynamicalReservoir.leaking_rate"></a>
    
            <div class="docstring"><p>Leaking rate ((\alpha)) that controls how much of the previous state contributes to the next.
Defaults to <code>1.0</code>, meaning the state is fully updated at each time step.</p>
</div>


                            </div>
                            <div id="DynamicalReservoir.sparsity" class="classattr">
                                <div class="attr variable">
            <span class="name">sparsity</span><span class="annotation">: Optional[float]</span>        =
<span class="default_value">None</span>

        
    </div>
    <a class="headerlink" href="#DynamicalReservoir.sparsity"></a>
    
            <div class="docstring"><p>sparsity of the reservoir weight matrix. (0, 1]</p>
</div>


                            </div>
                            <div id="DynamicalReservoir.spectral_radius" class="classattr">
                                <div class="attr variable">
            <span class="name">spectral_radius</span><span class="annotation">: Optional[float]</span>        =
<span class="default_value">0.95</span>

        
    </div>
    <a class="headerlink" href="#DynamicalReservoir.spectral_radius"></a>
    
            <div class="docstring"><p>spectral radius of reservoir weight matrix.
Recommended values - [0.9, 1.2]</p>
</div>


                            </div>
                            <div id="DynamicalReservoir.update_reservoir" class="classattr">
                                        <input id="DynamicalReservoir.update_reservoir-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">update_reservoir</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">input_state</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="DynamicalReservoir.update_reservoir-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DynamicalReservoir.update_reservoir"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DynamicalReservoir.update_reservoir-182"><a href="#DynamicalReservoir.update_reservoir-182"><span class="linenos">182</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_reservoir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]:</span>
</span><span id="DynamicalReservoir.update_reservoir-183"><a href="#DynamicalReservoir.update_reservoir-183"><span class="linenos">183</span></a>
</span><span id="DynamicalReservoir.update_reservoir-184"><a href="#DynamicalReservoir.update_reservoir-184"><span class="linenos">184</span></a><span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DynamicalReservoir.update_reservoir-185"><a href="#DynamicalReservoir.update_reservoir-185"><span class="linenos">185</span></a><span class="sd">        Updates the reservoir state given an input.</span>
</span><span id="DynamicalReservoir.update_reservoir-186"><a href="#DynamicalReservoir.update_reservoir-186"><span class="linenos">186</span></a>
</span><span id="DynamicalReservoir.update_reservoir-187"><a href="#DynamicalReservoir.update_reservoir-187"><span class="linenos">187</span></a><span class="sd">        This method applies the state update equation:</span>
</span><span id="DynamicalReservoir.update_reservoir-188"><a href="#DynamicalReservoir.update_reservoir-188"><span class="linenos">188</span></a>
</span><span id="DynamicalReservoir.update_reservoir-189"><a href="#DynamicalReservoir.update_reservoir-189"><span class="linenos">189</span></a><span class="sd">        $$y_t = (1 - \alpha) y_{t-1} + \alpha f(W_\text{in} x_t + W_\text{res} y_{t-1})$$</span>
</span><span id="DynamicalReservoir.update_reservoir-190"><a href="#DynamicalReservoir.update_reservoir-190"><span class="linenos">190</span></a>
</span><span id="DynamicalReservoir.update_reservoir-191"><a href="#DynamicalReservoir.update_reservoir-191"><span class="linenos">191</span></a><span class="sd">        Args:</span>
</span><span id="DynamicalReservoir.update_reservoir-192"><a href="#DynamicalReservoir.update_reservoir-192"><span class="linenos">192</span></a><span class="sd">            input_state (np.ndarray):</span>
</span><span id="DynamicalReservoir.update_reservoir-193"><a href="#DynamicalReservoir.update_reservoir-193"><span class="linenos">193</span></a><span class="sd">                The input state vector.</span>
</span><span id="DynamicalReservoir.update_reservoir-194"><a href="#DynamicalReservoir.update_reservoir-194"><span class="linenos">194</span></a>
</span><span id="DynamicalReservoir.update_reservoir-195"><a href="#DynamicalReservoir.update_reservoir-195"><span class="linenos">195</span></a><span class="sd">        Returns:</span>
</span><span id="DynamicalReservoir.update_reservoir-196"><a href="#DynamicalReservoir.update_reservoir-196"><span class="linenos">196</span></a><span class="sd">            np.ndarray: The updated reservoir state.</span>
</span><span id="DynamicalReservoir.update_reservoir-197"><a href="#DynamicalReservoir.update_reservoir-197"><span class="linenos">197</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DynamicalReservoir.update_reservoir-198"><a href="#DynamicalReservoir.update_reservoir-198"><span class="linenos">198</span></a>
</span><span id="DynamicalReservoir.update_reservoir-199"><a href="#DynamicalReservoir.update_reservoir-199"><span class="linenos">199</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w_in</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
</span><span id="DynamicalReservoir.update_reservoir-200"><a href="#DynamicalReservoir.update_reservoir-200"><span class="linenos">200</span></a>        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">w_res</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
</span><span id="DynamicalReservoir.update_reservoir-201"><a href="#DynamicalReservoir.update_reservoir-201"><span class="linenos">201</span></a>
</span><span id="DynamicalReservoir.update_reservoir-202"><a href="#DynamicalReservoir.update_reservoir-202"><span class="linenos">202</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">res_state</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaking_rate</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">res_state</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">leaking_rate</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">activation_function</span><span class="p">(</span>
</span><span id="DynamicalReservoir.update_reservoir-203"><a href="#DynamicalReservoir.update_reservoir-203"><span class="linenos">203</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">w_in</span> <span class="o">@</span> <span class="n">input_state</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">w_res</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">res_state</span>
</span><span id="DynamicalReservoir.update_reservoir-204"><a href="#DynamicalReservoir.update_reservoir-204"><span class="linenos">204</span></a>        <span class="p">)</span>
</span><span id="DynamicalReservoir.update_reservoir-205"><a href="#DynamicalReservoir.update_reservoir-205"><span class="linenos">205</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">res_state</span>
</span></pre></div>


            <div class="docstring"><p>Updates the reservoir state given an input.</p>

<p>This method applies the state update equation:</p>

<p>$$y_t = (1 - \alpha) y_{t-1} + \alpha f(W_\text{in} x_t + W_\text{res} y_{t-1})$$</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>input_state (np.ndarray):</strong>  The input state vector.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>np.ndarray: The updated reservoir state.</p>
</blockquote>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Reservoir">Reservoir</a></dt>
                                <dd id="DynamicalReservoir.input_dimensionality" class="variable"><a href="#Reservoir.input_dimensionality">input_dimensionality</a></dd>
                <dd id="DynamicalReservoir.reservoir_dimensionality" class="variable"><a href="#Reservoir.reservoir_dimensionality">reservoir_dimensionality</a></dd>
                <dd id="DynamicalReservoir.res_state" class="variable"><a href="#Reservoir.res_state">res_state</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<!-- End of C:/CodingGeneral/chicagoClubManagement/aqua-blue/_build/aqua_blue/reservoirs.html -->
<!-- Start of C:/CodingGeneral/chicagoClubManagement/aqua-blue/_build/aqua_blue/time_series.html -->
<nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../aqua_blue.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;aqua_blue</a>

            <img src="https://raw.githubusercontent.com/Chicago-Club-Management-Company/aqua-blue/refs/heads/main/assets/blue.jpg" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#logger">logger</a>
            </li>
            <li>
                    <a class="function" href="#parse_time">parse_time</a>
            </li>
            <li>
                    <a class="class" href="#ShapeChangedWarning">ShapeChangedWarning</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#TimeSeriesTypedDict">TimeSeriesTypedDict</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#TimeSeriesTypedDict.dependent_variable">dependent_variable</a>
                        </li>
                        <li>
                                <a class="variable" href="#TimeSeriesTypedDict.times">times</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TimeSeries">TimeSeries</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TimeSeries.__init__">TimeSeries</a>
                        </li>
                        <li>
                                <a class="variable" href="#TimeSeries.dependent_variable">dependent_variable</a>
                        </li>
                        <li>
                                <a class="variable" href="#TimeSeries.times">times</a>
                        </li>
                        <li>
                                <a class="function" href="#TimeSeries.save">save</a>
                        </li>
                        <li>
                                <a class="variable" href="#TimeSeries.num_dims">num_dims</a>
                        </li>
                        <li>
                                <a class="function" href="#TimeSeries.from_csv">from_csv</a>
                        </li>
                        <li>
                                <a class="function" href="#TimeSeries.to_dict">to_dict</a>
                        </li>
                        <li>
                                <a class="variable" href="#TimeSeries.timestep">timestep</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../aqua_blue.html">aqua_blue</a><wbr>.time_series    </h1>

                        <div class="docstring"><p>Module defining the TimeSeries object</p>
</div>

                        <input id="mod-time_series-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-time_series-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">Module defining the TimeSeries object</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">IO</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Generic</span><span class="p">,</span> <span class="n">TypedDict</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Tuple</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">io</span> 
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">csv</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">codecs</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">dateutil</span><span class="w"> </span><span class="kn">import</span> <span class="n">parser</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.datetimelikearray</span><span class="w"> </span><span class="kn">import</span> <span class="n">DatetimeLikeArray</span><span class="p">,</span> <span class="n">TimeDeltaLike</span><span class="p">,</span> <span class="n">DatetimeLike</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="c1"># Default times_conversion function</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="k">def</span><span class="w"> </span><span class="nf">parse_time</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>    <span class="k">try</span><span class="p">:</span> 
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>        <span class="k">return</span> <span class="n">n</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>        <span class="k">return</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="k">class</span><span class="w"> </span><span class="nc">ShapeChangedWarning</span><span class="p">(</span><span class="ne">Warning</span><span class="p">):</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">    Warning for cases where `TimeSeries.__post_init__` alters the shape of the dependent variable.</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="k">class</span><span class="w"> </span><span class="nc">TimeSeriesTypedDict</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">    TypedDict form of a TimeSeries object, useful for turning into json</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>    <span class="n">dependent_variable</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>    <span class="n">times</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="nd">@dataclass</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="k">class</span><span class="w"> </span><span class="nc">TimeSeries</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">TimeDeltaLike</span><span class="p">]):</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">    A class representing a time series, encapsulating dependent variables and corresponding timestamps.</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>    <span class="n">dependent_variable</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Array of dependent variables representing the time series values.&quot;&quot;&quot;</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>    <span class="n">times</span><span class="p">:</span> <span class="n">DatetimeLikeArray</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Array of time values associated with the dependent variable.&quot;&quot;&quot;</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>    
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">        Ensures proper formatting of time values and checks for uniform spacing.</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">        Raises an error if the time values are not uniformly spaced.</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>        <span class="c1"># If List[float | int | datetime] is passed, convert to NDArray, NDArray, or DatetimeLikeArray respectively</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">datetime</span><span class="p">):</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>            <span class="c1"># For some reason, NumPy does not automatically handle datetime object dtypes as np.datetime64.</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>            <span class="n">dtype_</span> <span class="o">=</span> <span class="s1">&#39;datetime64[s]&#39;</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>            <span class="n">dtype_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;times dtype set to </span><span class="si">{</span><span class="n">dtype_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>        
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">times</span> <span class="o">=</span> <span class="n">DatetimeLikeArray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype_</span><span class="p">)</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>        <span class="n">timesteps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">)</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>        
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">timesteps</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)),</span> <span class="mf">0.0</span><span class="p">):</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;TimeSeries.times must be uniformly spaced&quot;</span><span class="p">)</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">timesteps</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)),</span> <span class="mf">0.0</span><span class="p">):</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;TimeSeries.times must have a timestep greater than zero&quot;</span><span class="p">)</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>        
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">)</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.dependent_variable converted to </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>        
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>            <span class="n">num_steps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">)</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">num_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>                <span class="sa">f</span><span class="s2">&quot;TimeSeries.dependent_variable should have shape (number of steps, dimensionality). &quot;</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>                <span class="sa">f</span><span class="s2">&quot;The shape has been changed from </span><span class="si">{</span><span class="p">(</span><span class="n">num_steps</span><span class="p">,)</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>            <span class="p">)</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>    
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">IO</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="n">header</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">):</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">        Saves the time series data to a file.</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">        </span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">        Args:</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">            fp (Union[IO, str, Path]): File path or object where the TimeSeries instance will be saved.</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">            header (str, optional): An optional header. Defaults to an empty string.</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">            delimiter (str, optional): The delimiter used in the output file. Defaults to a comma.</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">            fmt (Tuple(str), optional): Format specifier used for saving the data to fp. Defaults to &#39;%s&#39; (String representation)</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>        
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;object&#39;</span><span class="p">),</span> 
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>        <span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>        
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>            <span class="n">fp</span><span class="p">,</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>            <span class="n">data</span><span class="p">,</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>            <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">,</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>            <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>            <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>            <span class="n">comments</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>        <span class="p">)</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>    
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>    <span class="nd">@property</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">num_dims</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="sd">        Returns the dimensionality of the dependent variable.</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a><span class="sd">        </span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a><span class="sd">        Returns:</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a><span class="sd">            int: Number of dimensions of the time series.</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>    
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_csv</span><span class="p">(</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>        <span class="bp">cls</span><span class="p">,</span> 
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>        <span class="n">fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">IO</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> 
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>        <span class="n">time_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>        <span class="n">times_dtype</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>        <span class="n">dependent_var_cols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>        <span class="n">times_conversion</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">DatetimeLike</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_time</span><span class="p">,</span> 
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>        <span class="n">dep_var_conversion</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>        <span class="n">max_rows</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>    <span class="p">):</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="sd">        Loads time series data from a CSV file.</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a><span class="sd">        </span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="sd">        Args:</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a><span class="sd">            fp (Union[IO, str, Path]): File path or object to read from.</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="sd">            time_col (str): Name of the times column.</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a><span class="sd">            times_dtype (dtype): Type of the times column</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a><span class="sd">            dependent_var_cols (List[str]): Names of the dependent variable columns</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a><span class="sd">            times_conversion (Callable[[str], DatetimeLike]): Function determining how to parse elements of the times column. Defaults to parse_time</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a><span class="sd">            dep_var_conversion (Callable[[str], float]): Function determining how to parse elements of the dependent variable columns. Defaults to float</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a><span class="sd">            max_rows (float): Maximum number of rows that should be parsed. If set to zero, all rows are parsed. Defaults to 0</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a><span class="sd">        </span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a><span class="sd">        Returns:</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a><span class="sd">            TimeSeries: A TimeSeries instance populated by data from the csv file.</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>        <span class="c1"># Helper generator to get a csv.DictReader source from different sources</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">get_reader</span><span class="p">(</span><span class="n">fp_</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>            
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>            <span class="c1"># Checking the input format</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fp_</span><span class="p">,</span> <span class="n">Path</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fp_</span><span class="p">):</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fp_</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>                    <span class="k">yield from</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>        
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fp_</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">):</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>                <span class="c1"># Use codecs, because decoding directly is an eager operation</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>                <span class="n">fp_</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>                <span class="k">yield from</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">codecs</span><span class="o">.</span><span class="n">getreader</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)(</span><span class="n">fp_</span><span class="p">))</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>            
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">):</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>                <span class="n">fp_</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>                <span class="k">yield from</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>            
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>            <span class="k">else</span><span class="p">:</span> 
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">()</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>        
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>        <span class="c1"># Generator for lazy dependent variable processing</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">process_dep</span><span class="p">():</span> 
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>            <span class="n">reader</span> <span class="o">=</span> <span class="n">get_reader</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">reader</span><span class="p">):</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>                <span class="k">if</span> <span class="n">max_rows</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">max_rows</span><span class="p">:</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>                    <span class="k">break</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">dependent_var_cols</span><span class="p">:</span> 
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>                    <span class="k">yield</span> <span class="n">dep_var_conversion</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">col</span><span class="p">])</span> 
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>        
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>        <span class="c1"># Generator for lazy times processing</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">process_times</span><span class="p">():</span> 
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>            <span class="n">reader</span> <span class="o">=</span> <span class="n">get_reader</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">reader</span><span class="p">):</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>                <span class="k">if</span> <span class="n">max_rows</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">max_rows</span><span class="p">:</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>                    <span class="k">break</span> 
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>                <span class="k">yield</span> <span class="n">times_conversion</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">time_col</span><span class="p">])</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>        
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>        <span class="n">dep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(</span><span class="n">process_dep</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dependent_var_cols</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>        
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">DatetimeLikeArray</span><span class="o">.</span><span class="n">from_iter</span><span class="p">(</span><span class="n">process_times</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">times_dtype</span><span class="p">)</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>        
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>            <span class="n">dependent_variable</span><span class="o">=</span><span class="n">dep</span><span class="p">,</span> 
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>            <span class="n">times</span><span class="o">=</span><span class="n">t</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>        <span class="p">)</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>    
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimeSeriesTypedDict</span><span class="p">:</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a><span class="w">        </span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a><span class="sd">        convert to a typed dictionary</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>        <span class="k">return</span> <span class="n">TimeSeriesTypedDict</span><span class="p">(</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>            <span class="n">dependent_variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>            <span class="n">times</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>        <span class="p">)</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>    
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>    <span class="nd">@property</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">timestep</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimeDeltaLike</span><span class="p">:</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a><span class="sd">        Returns the time step between consecutive observations.</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a><span class="sd">        Returns:</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a><span class="sd">            TimeDeltaLike: The timestep of the time series.</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a><span class="sd">        Checks equality between two TimeSeries instances.</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a><span class="sd">        </span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a><span class="sd">        </span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a><span class="sd">        Returns:</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a><span class="sd">            bool: True if both instances have the same times and dependent variables.</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">times</span> <span class="ow">and</span> <span class="nb">bool</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">)))</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a><span class="sd">        Retrieves a subset of the TimeSeries.</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>        <span class="k">return</span> <span class="n">TimeSeries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">        Sets a subset of the TimeSeries.</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">TimeSeries</span><span class="p">):</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Value must be a TimeSeries object&quot;</span><span class="p">)</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)</span> <span class="ow">and</span> <span class="n">key</span><span class="o">.</span><span class="n">stop</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">):</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Slice stop index out of range&quot;</span><span class="p">)</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">):</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Index out of range&quot;</span><span class="p">)</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">dependent_variable</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">times</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a><span class="sd">        Adds two TimeSeries instances element-wise.</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">times</span><span class="p">):</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can only add TimeSeries instances that have the same number of timesteps&quot;</span><span class="p">)</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">times</span><span class="p">):</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can only add TimeSeries instances that span the same times&quot;</span><span class="p">)</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>        <span class="k">return</span> <span class="n">TimeSeries</span><span class="p">(</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>            <span class="n">dependent_variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">,</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>            <span class="n">times</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>        <span class="p">)</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>    
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a><span class="sd">        Subtracts two TimeSeries instances element-wise.</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">times</span><span class="p">):</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can only subtract TimeSeries instances that have the same number of timesteps&quot;</span><span class="p">)</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">times</span><span class="p">):</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can only subtract TimeSeries instances that span the same times&quot;</span><span class="p">)</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>        <span class="k">return</span> <span class="n">TimeSeries</span><span class="p">(</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>            <span class="n">dependent_variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">,</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>            <span class="n">times</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>        <span class="p">)</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__rshift__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a><span class="sd">        Concatenates two non-overlapping TimeSeries instances.</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can only concatenate TimeSeries instances with non-overlapping time values&quot;</span><span class="p">)</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>        <span class="k">return</span> <span class="n">TimeSeries</span><span class="p">(</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>            <span class="n">dependent_variable</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">)),</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>            <span class="n">times</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">times</span><span class="p">))</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>        <span class="p">)</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="sd">        Returns the number of timesteps in the TimeSeries.</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="logger">
                    <div class="attr variable">
            <span class="name">logger</span>        =
<span class="default_value">&lt;Logger <a href="">aqua_blue.time_series</a> (WARNING)&gt;</span>

        
    </div>
    <a class="headerlink" href="#logger"></a>
    
    

                </section>
                <section id="parse_time">
                            <input id="parse_time-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parse_time</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">s</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="parse_time-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#parse_time"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="parse_time-29"><a href="#parse_time-29"><span class="linenos">29</span></a><span class="k">def</span><span class="w"> </span><span class="nf">parse_time</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="parse_time-30"><a href="#parse_time-30"><span class="linenos">30</span></a>    <span class="k">try</span><span class="p">:</span> 
</span><span id="parse_time-31"><a href="#parse_time-31"><span class="linenos">31</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="parse_time-32"><a href="#parse_time-32"><span class="linenos">32</span></a>        <span class="k">return</span> <span class="n">n</span>
</span><span id="parse_time-33"><a href="#parse_time-33"><span class="linenos">33</span></a>    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="parse_time-34"><a href="#parse_time-34"><span class="linenos">34</span></a>        <span class="k">return</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></pre></div>


    

                </section>
                <section id="ShapeChangedWarning">
                            <input id="ShapeChangedWarning-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ShapeChangedWarning</span><wbr>(<span class="base">builtins.Warning</span>):

                <label class="view-source-button" for="ShapeChangedWarning-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ShapeChangedWarning"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ShapeChangedWarning-37"><a href="#ShapeChangedWarning-37"><span class="linenos">37</span></a><span class="k">class</span><span class="w"> </span><span class="nc">ShapeChangedWarning</span><span class="p">(</span><span class="ne">Warning</span><span class="p">):</span>
</span><span id="ShapeChangedWarning-38"><a href="#ShapeChangedWarning-38"><span class="linenos">38</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ShapeChangedWarning-39"><a href="#ShapeChangedWarning-39"><span class="linenos">39</span></a><span class="sd">    Warning for cases where `TimeSeries.__post_init__` alters the shape of the dependent variable.</span>
</span><span id="ShapeChangedWarning-40"><a href="#ShapeChangedWarning-40"><span class="linenos">40</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Warning for cases where <code>TimeSeries.__post_init__</code> alters the shape of the dependent variable.</p>
</div>


                </section>
                <section id="TimeSeriesTypedDict">
                            <input id="TimeSeriesTypedDict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TimeSeriesTypedDict</span><wbr>(<span class="base">typing.TypedDict</span>):

                <label class="view-source-button" for="TimeSeriesTypedDict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TimeSeriesTypedDict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TimeSeriesTypedDict-43"><a href="#TimeSeriesTypedDict-43"><span class="linenos">43</span></a><span class="k">class</span><span class="w"> </span><span class="nc">TimeSeriesTypedDict</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
</span><span id="TimeSeriesTypedDict-44"><a href="#TimeSeriesTypedDict-44"><span class="linenos">44</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TimeSeriesTypedDict-45"><a href="#TimeSeriesTypedDict-45"><span class="linenos">45</span></a><span class="sd">    TypedDict form of a TimeSeries object, useful for turning into json</span>
</span><span id="TimeSeriesTypedDict-46"><a href="#TimeSeriesTypedDict-46"><span class="linenos">46</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="TimeSeriesTypedDict-47"><a href="#TimeSeriesTypedDict-47"><span class="linenos">47</span></a>
</span><span id="TimeSeriesTypedDict-48"><a href="#TimeSeriesTypedDict-48"><span class="linenos">48</span></a>    <span class="n">dependent_variable</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span>
</span><span id="TimeSeriesTypedDict-49"><a href="#TimeSeriesTypedDict-49"><span class="linenos">49</span></a>    <span class="n">times</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
</span></pre></div>


            <div class="docstring"><p>TypedDict form of a TimeSeries object, useful for turning into json</p>
</div>


                            <div id="TimeSeriesTypedDict.dependent_variable" class="classattr">
                                <div class="attr variable">
            <span class="name">dependent_variable</span><span class="annotation">: Sequence[Sequence[float]]</span>

        
    </div>
    <a class="headerlink" href="#TimeSeriesTypedDict.dependent_variable"></a>
    
    

                            </div>
                            <div id="TimeSeriesTypedDict.times" class="classattr">
                                <div class="attr variable">
            <span class="name">times</span><span class="annotation">: Sequence[Union[float, str]]</span>

        
    </div>
    <a class="headerlink" href="#TimeSeriesTypedDict.times"></a>
    
    

                            </div>
                </section>
                <section id="TimeSeries">
                            <input id="TimeSeries-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">TimeSeries</span><wbr>(<span class="base">typing.Generic[~TimeDeltaLike]</span>):

                <label class="view-source-button" for="TimeSeries-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TimeSeries"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TimeSeries-52"><a href="#TimeSeries-52"><span class="linenos"> 52</span></a><span class="nd">@dataclass</span>
</span><span id="TimeSeries-53"><a href="#TimeSeries-53"><span class="linenos"> 53</span></a><span class="k">class</span><span class="w"> </span><span class="nc">TimeSeries</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">TimeDeltaLike</span><span class="p">]):</span>
</span><span id="TimeSeries-54"><a href="#TimeSeries-54"><span class="linenos"> 54</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TimeSeries-55"><a href="#TimeSeries-55"><span class="linenos"> 55</span></a><span class="sd">    A class representing a time series, encapsulating dependent variables and corresponding timestamps.</span>
</span><span id="TimeSeries-56"><a href="#TimeSeries-56"><span class="linenos"> 56</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="TimeSeries-57"><a href="#TimeSeries-57"><span class="linenos"> 57</span></a>
</span><span id="TimeSeries-58"><a href="#TimeSeries-58"><span class="linenos"> 58</span></a>    <span class="n">dependent_variable</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span>
</span><span id="TimeSeries-59"><a href="#TimeSeries-59"><span class="linenos"> 59</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Array of dependent variables representing the time series values.&quot;&quot;&quot;</span>
</span><span id="TimeSeries-60"><a href="#TimeSeries-60"><span class="linenos"> 60</span></a>
</span><span id="TimeSeries-61"><a href="#TimeSeries-61"><span class="linenos"> 61</span></a>    <span class="n">times</span><span class="p">:</span> <span class="n">DatetimeLikeArray</span>
</span><span id="TimeSeries-62"><a href="#TimeSeries-62"><span class="linenos"> 62</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Array of time values associated with the dependent variable.&quot;&quot;&quot;</span>
</span><span id="TimeSeries-63"><a href="#TimeSeries-63"><span class="linenos"> 63</span></a>    
</span><span id="TimeSeries-64"><a href="#TimeSeries-64"><span class="linenos"> 64</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TimeSeries-65"><a href="#TimeSeries-65"><span class="linenos"> 65</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TimeSeries-66"><a href="#TimeSeries-66"><span class="linenos"> 66</span></a><span class="sd">        Ensures proper formatting of time values and checks for uniform spacing.</span>
</span><span id="TimeSeries-67"><a href="#TimeSeries-67"><span class="linenos"> 67</span></a><span class="sd">        Raises an error if the time values are not uniformly spaced.</span>
</span><span id="TimeSeries-68"><a href="#TimeSeries-68"><span class="linenos"> 68</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TimeSeries-69"><a href="#TimeSeries-69"><span class="linenos"> 69</span></a>        <span class="c1"># If List[float | int | datetime] is passed, convert to NDArray, NDArray, or DatetimeLikeArray respectively</span>
</span><span id="TimeSeries-70"><a href="#TimeSeries-70"><span class="linenos"> 70</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">datetime</span><span class="p">):</span>
</span><span id="TimeSeries-71"><a href="#TimeSeries-71"><span class="linenos"> 71</span></a>            <span class="c1"># For some reason, NumPy does not automatically handle datetime object dtypes as np.datetime64.</span>
</span><span id="TimeSeries-72"><a href="#TimeSeries-72"><span class="linenos"> 72</span></a>            <span class="n">dtype_</span> <span class="o">=</span> <span class="s1">&#39;datetime64[s]&#39;</span>
</span><span id="TimeSeries-73"><a href="#TimeSeries-73"><span class="linenos"> 73</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TimeSeries-74"><a href="#TimeSeries-74"><span class="linenos"> 74</span></a>            <span class="n">dtype_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span id="TimeSeries-75"><a href="#TimeSeries-75"><span class="linenos"> 75</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;times dtype set to </span><span class="si">{</span><span class="n">dtype_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TimeSeries-76"><a href="#TimeSeries-76"><span class="linenos"> 76</span></a>        
</span><span id="TimeSeries-77"><a href="#TimeSeries-77"><span class="linenos"> 77</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">times</span> <span class="o">=</span> <span class="n">DatetimeLikeArray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype_</span><span class="p">)</span>
</span><span id="TimeSeries-78"><a href="#TimeSeries-78"><span class="linenos"> 78</span></a>        <span class="n">timesteps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">)</span>
</span><span id="TimeSeries-79"><a href="#TimeSeries-79"><span class="linenos"> 79</span></a>        
</span><span id="TimeSeries-80"><a href="#TimeSeries-80"><span class="linenos"> 80</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">timesteps</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)),</span> <span class="mf">0.0</span><span class="p">):</span>
</span><span id="TimeSeries-81"><a href="#TimeSeries-81"><span class="linenos"> 81</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;TimeSeries.times must be uniformly spaced&quot;</span><span class="p">)</span>
</span><span id="TimeSeries-82"><a href="#TimeSeries-82"><span class="linenos"> 82</span></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">timesteps</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)),</span> <span class="mf">0.0</span><span class="p">):</span>
</span><span id="TimeSeries-83"><a href="#TimeSeries-83"><span class="linenos"> 83</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;TimeSeries.times must have a timestep greater than zero&quot;</span><span class="p">)</span>
</span><span id="TimeSeries-84"><a href="#TimeSeries-84"><span class="linenos"> 84</span></a>        
</span><span id="TimeSeries-85"><a href="#TimeSeries-85"><span class="linenos"> 85</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="TimeSeries-86"><a href="#TimeSeries-86"><span class="linenos"> 86</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">)</span>
</span><span id="TimeSeries-87"><a href="#TimeSeries-87"><span class="linenos"> 87</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.dependent_variable converted to </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="TimeSeries-88"><a href="#TimeSeries-88"><span class="linenos"> 88</span></a>        
</span><span id="TimeSeries-89"><a href="#TimeSeries-89"><span class="linenos"> 89</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="TimeSeries-90"><a href="#TimeSeries-90"><span class="linenos"> 90</span></a>            <span class="n">num_steps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">)</span>
</span><span id="TimeSeries-91"><a href="#TimeSeries-91"><span class="linenos"> 91</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">num_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="TimeSeries-92"><a href="#TimeSeries-92"><span class="linenos"> 92</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="TimeSeries-93"><a href="#TimeSeries-93"><span class="linenos"> 93</span></a>                <span class="sa">f</span><span class="s2">&quot;TimeSeries.dependent_variable should have shape (number of steps, dimensionality). &quot;</span>
</span><span id="TimeSeries-94"><a href="#TimeSeries-94"><span class="linenos"> 94</span></a>                <span class="sa">f</span><span class="s2">&quot;The shape has been changed from </span><span class="si">{</span><span class="p">(</span><span class="n">num_steps</span><span class="p">,)</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="TimeSeries-95"><a href="#TimeSeries-95"><span class="linenos"> 95</span></a>            <span class="p">)</span>
</span><span id="TimeSeries-96"><a href="#TimeSeries-96"><span class="linenos"> 96</span></a>    
</span><span id="TimeSeries-97"><a href="#TimeSeries-97"><span class="linenos"> 97</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">IO</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="n">header</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">):</span>
</span><span id="TimeSeries-98"><a href="#TimeSeries-98"><span class="linenos"> 98</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TimeSeries-99"><a href="#TimeSeries-99"><span class="linenos"> 99</span></a><span class="sd">        Saves the time series data to a file.</span>
</span><span id="TimeSeries-100"><a href="#TimeSeries-100"><span class="linenos">100</span></a><span class="sd">        </span>
</span><span id="TimeSeries-101"><a href="#TimeSeries-101"><span class="linenos">101</span></a><span class="sd">        Args:</span>
</span><span id="TimeSeries-102"><a href="#TimeSeries-102"><span class="linenos">102</span></a><span class="sd">            fp (Union[IO, str, Path]): File path or object where the TimeSeries instance will be saved.</span>
</span><span id="TimeSeries-103"><a href="#TimeSeries-103"><span class="linenos">103</span></a><span class="sd">            header (str, optional): An optional header. Defaults to an empty string.</span>
</span><span id="TimeSeries-104"><a href="#TimeSeries-104"><span class="linenos">104</span></a><span class="sd">            delimiter (str, optional): The delimiter used in the output file. Defaults to a comma.</span>
</span><span id="TimeSeries-105"><a href="#TimeSeries-105"><span class="linenos">105</span></a><span class="sd">            fmt (Tuple(str), optional): Format specifier used for saving the data to fp. Defaults to &#39;%s&#39; (String representation)</span>
</span><span id="TimeSeries-106"><a href="#TimeSeries-106"><span class="linenos">106</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TimeSeries-107"><a href="#TimeSeries-107"><span class="linenos">107</span></a>        
</span><span id="TimeSeries-108"><a href="#TimeSeries-108"><span class="linenos">108</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span>
</span><span id="TimeSeries-109"><a href="#TimeSeries-109"><span class="linenos">109</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;object&#39;</span><span class="p">),</span> 
</span><span id="TimeSeries-110"><a href="#TimeSeries-110"><span class="linenos">110</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
</span><span id="TimeSeries-111"><a href="#TimeSeries-111"><span class="linenos">111</span></a>        <span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="TimeSeries-112"><a href="#TimeSeries-112"><span class="linenos">112</span></a>        
</span><span id="TimeSeries-113"><a href="#TimeSeries-113"><span class="linenos">113</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span>
</span><span id="TimeSeries-114"><a href="#TimeSeries-114"><span class="linenos">114</span></a>            <span class="n">fp</span><span class="p">,</span>
</span><span id="TimeSeries-115"><a href="#TimeSeries-115"><span class="linenos">115</span></a>            <span class="n">data</span><span class="p">,</span>
</span><span id="TimeSeries-116"><a href="#TimeSeries-116"><span class="linenos">116</span></a>            <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">,</span>
</span><span id="TimeSeries-117"><a href="#TimeSeries-117"><span class="linenos">117</span></a>            <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span>
</span><span id="TimeSeries-118"><a href="#TimeSeries-118"><span class="linenos">118</span></a>            <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
</span><span id="TimeSeries-119"><a href="#TimeSeries-119"><span class="linenos">119</span></a>            <span class="n">comments</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
</span><span id="TimeSeries-120"><a href="#TimeSeries-120"><span class="linenos">120</span></a>        <span class="p">)</span>
</span><span id="TimeSeries-121"><a href="#TimeSeries-121"><span class="linenos">121</span></a>    
</span><span id="TimeSeries-122"><a href="#TimeSeries-122"><span class="linenos">122</span></a>    <span class="nd">@property</span>
</span><span id="TimeSeries-123"><a href="#TimeSeries-123"><span class="linenos">123</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">num_dims</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="TimeSeries-124"><a href="#TimeSeries-124"><span class="linenos">124</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TimeSeries-125"><a href="#TimeSeries-125"><span class="linenos">125</span></a><span class="sd">        Returns the dimensionality of the dependent variable.</span>
</span><span id="TimeSeries-126"><a href="#TimeSeries-126"><span class="linenos">126</span></a><span class="sd">        </span>
</span><span id="TimeSeries-127"><a href="#TimeSeries-127"><span class="linenos">127</span></a><span class="sd">        Returns:</span>
</span><span id="TimeSeries-128"><a href="#TimeSeries-128"><span class="linenos">128</span></a><span class="sd">            int: Number of dimensions of the time series.</span>
</span><span id="TimeSeries-129"><a href="#TimeSeries-129"><span class="linenos">129</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TimeSeries-130"><a href="#TimeSeries-130"><span class="linenos">130</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="TimeSeries-131"><a href="#TimeSeries-131"><span class="linenos">131</span></a>    
</span><span id="TimeSeries-132"><a href="#TimeSeries-132"><span class="linenos">132</span></a>    <span class="nd">@classmethod</span>
</span><span id="TimeSeries-133"><a href="#TimeSeries-133"><span class="linenos">133</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_csv</span><span class="p">(</span>
</span><span id="TimeSeries-134"><a href="#TimeSeries-134"><span class="linenos">134</span></a>        <span class="bp">cls</span><span class="p">,</span> 
</span><span id="TimeSeries-135"><a href="#TimeSeries-135"><span class="linenos">135</span></a>        <span class="n">fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">IO</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> 
</span><span id="TimeSeries-136"><a href="#TimeSeries-136"><span class="linenos">136</span></a>        <span class="n">time_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="TimeSeries-137"><a href="#TimeSeries-137"><span class="linenos">137</span></a>        <span class="n">times_dtype</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span>
</span><span id="TimeSeries-138"><a href="#TimeSeries-138"><span class="linenos">138</span></a>        <span class="n">dependent_var_cols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="TimeSeries-139"><a href="#TimeSeries-139"><span class="linenos">139</span></a>        <span class="n">times_conversion</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">DatetimeLike</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_time</span><span class="p">,</span> 
</span><span id="TimeSeries-140"><a href="#TimeSeries-140"><span class="linenos">140</span></a>        <span class="n">dep_var_conversion</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="TimeSeries-141"><a href="#TimeSeries-141"><span class="linenos">141</span></a>        <span class="n">max_rows</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="TimeSeries-142"><a href="#TimeSeries-142"><span class="linenos">142</span></a>    <span class="p">):</span>
</span><span id="TimeSeries-143"><a href="#TimeSeries-143"><span class="linenos">143</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TimeSeries-144"><a href="#TimeSeries-144"><span class="linenos">144</span></a><span class="sd">        Loads time series data from a CSV file.</span>
</span><span id="TimeSeries-145"><a href="#TimeSeries-145"><span class="linenos">145</span></a><span class="sd">        </span>
</span><span id="TimeSeries-146"><a href="#TimeSeries-146"><span class="linenos">146</span></a><span class="sd">        Args:</span>
</span><span id="TimeSeries-147"><a href="#TimeSeries-147"><span class="linenos">147</span></a><span class="sd">            fp (Union[IO, str, Path]): File path or object to read from.</span>
</span><span id="TimeSeries-148"><a href="#TimeSeries-148"><span class="linenos">148</span></a><span class="sd">            time_col (str): Name of the times column.</span>
</span><span id="TimeSeries-149"><a href="#TimeSeries-149"><span class="linenos">149</span></a><span class="sd">            times_dtype (dtype): Type of the times column</span>
</span><span id="TimeSeries-150"><a href="#TimeSeries-150"><span class="linenos">150</span></a><span class="sd">            dependent_var_cols (List[str]): Names of the dependent variable columns</span>
</span><span id="TimeSeries-151"><a href="#TimeSeries-151"><span class="linenos">151</span></a><span class="sd">            times_conversion (Callable[[str], DatetimeLike]): Function determining how to parse elements of the times column. Defaults to parse_time</span>
</span><span id="TimeSeries-152"><a href="#TimeSeries-152"><span class="linenos">152</span></a><span class="sd">            dep_var_conversion (Callable[[str], float]): Function determining how to parse elements of the dependent variable columns. Defaults to float</span>
</span><span id="TimeSeries-153"><a href="#TimeSeries-153"><span class="linenos">153</span></a><span class="sd">            max_rows (float): Maximum number of rows that should be parsed. If set to zero, all rows are parsed. Defaults to 0</span>
</span><span id="TimeSeries-154"><a href="#TimeSeries-154"><span class="linenos">154</span></a><span class="sd">        </span>
</span><span id="TimeSeries-155"><a href="#TimeSeries-155"><span class="linenos">155</span></a><span class="sd">        Returns:</span>
</span><span id="TimeSeries-156"><a href="#TimeSeries-156"><span class="linenos">156</span></a><span class="sd">            TimeSeries: A TimeSeries instance populated by data from the csv file.</span>
</span><span id="TimeSeries-157"><a href="#TimeSeries-157"><span class="linenos">157</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TimeSeries-158"><a href="#TimeSeries-158"><span class="linenos">158</span></a>        <span class="c1"># Helper generator to get a csv.DictReader source from different sources</span>
</span><span id="TimeSeries-159"><a href="#TimeSeries-159"><span class="linenos">159</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">get_reader</span><span class="p">(</span><span class="n">fp_</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="TimeSeries-160"><a href="#TimeSeries-160"><span class="linenos">160</span></a>            
</span><span id="TimeSeries-161"><a href="#TimeSeries-161"><span class="linenos">161</span></a>            <span class="c1"># Checking the input format</span>
</span><span id="TimeSeries-162"><a href="#TimeSeries-162"><span class="linenos">162</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fp_</span><span class="p">,</span> <span class="n">Path</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fp_</span><span class="p">):</span>
</span><span id="TimeSeries-163"><a href="#TimeSeries-163"><span class="linenos">163</span></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fp_</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="TimeSeries-164"><a href="#TimeSeries-164"><span class="linenos">164</span></a>                    <span class="k">yield from</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
</span><span id="TimeSeries-165"><a href="#TimeSeries-165"><span class="linenos">165</span></a>        
</span><span id="TimeSeries-166"><a href="#TimeSeries-166"><span class="linenos">166</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fp_</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">):</span>
</span><span id="TimeSeries-167"><a href="#TimeSeries-167"><span class="linenos">167</span></a>                <span class="c1"># Use codecs, because decoding directly is an eager operation</span>
</span><span id="TimeSeries-168"><a href="#TimeSeries-168"><span class="linenos">168</span></a>                <span class="n">fp_</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="TimeSeries-169"><a href="#TimeSeries-169"><span class="linenos">169</span></a>                <span class="k">yield from</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">codecs</span><span class="o">.</span><span class="n">getreader</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)(</span><span class="n">fp_</span><span class="p">))</span>
</span><span id="TimeSeries-170"><a href="#TimeSeries-170"><span class="linenos">170</span></a>            
</span><span id="TimeSeries-171"><a href="#TimeSeries-171"><span class="linenos">171</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">):</span>
</span><span id="TimeSeries-172"><a href="#TimeSeries-172"><span class="linenos">172</span></a>                <span class="n">fp_</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="TimeSeries-173"><a href="#TimeSeries-173"><span class="linenos">173</span></a>                <span class="k">yield from</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
</span><span id="TimeSeries-174"><a href="#TimeSeries-174"><span class="linenos">174</span></a>            
</span><span id="TimeSeries-175"><a href="#TimeSeries-175"><span class="linenos">175</span></a>            <span class="k">else</span><span class="p">:</span> 
</span><span id="TimeSeries-176"><a href="#TimeSeries-176"><span class="linenos">176</span></a>                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">()</span>
</span><span id="TimeSeries-177"><a href="#TimeSeries-177"><span class="linenos">177</span></a>        
</span><span id="TimeSeries-178"><a href="#TimeSeries-178"><span class="linenos">178</span></a>        <span class="c1"># Generator for lazy dependent variable processing</span>
</span><span id="TimeSeries-179"><a href="#TimeSeries-179"><span class="linenos">179</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">process_dep</span><span class="p">():</span> 
</span><span id="TimeSeries-180"><a href="#TimeSeries-180"><span class="linenos">180</span></a>            <span class="n">reader</span> <span class="o">=</span> <span class="n">get_reader</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</span><span id="TimeSeries-181"><a href="#TimeSeries-181"><span class="linenos">181</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">reader</span><span class="p">):</span>
</span><span id="TimeSeries-182"><a href="#TimeSeries-182"><span class="linenos">182</span></a>                <span class="k">if</span> <span class="n">max_rows</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">max_rows</span><span class="p">:</span>
</span><span id="TimeSeries-183"><a href="#TimeSeries-183"><span class="linenos">183</span></a>                    <span class="k">break</span>
</span><span id="TimeSeries-184"><a href="#TimeSeries-184"><span class="linenos">184</span></a>                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">dependent_var_cols</span><span class="p">:</span> 
</span><span id="TimeSeries-185"><a href="#TimeSeries-185"><span class="linenos">185</span></a>                    <span class="k">yield</span> <span class="n">dep_var_conversion</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">col</span><span class="p">])</span> 
</span><span id="TimeSeries-186"><a href="#TimeSeries-186"><span class="linenos">186</span></a>        
</span><span id="TimeSeries-187"><a href="#TimeSeries-187"><span class="linenos">187</span></a>        <span class="c1"># Generator for lazy times processing</span>
</span><span id="TimeSeries-188"><a href="#TimeSeries-188"><span class="linenos">188</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">process_times</span><span class="p">():</span> 
</span><span id="TimeSeries-189"><a href="#TimeSeries-189"><span class="linenos">189</span></a>            <span class="n">reader</span> <span class="o">=</span> <span class="n">get_reader</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</span><span id="TimeSeries-190"><a href="#TimeSeries-190"><span class="linenos">190</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">reader</span><span class="p">):</span>
</span><span id="TimeSeries-191"><a href="#TimeSeries-191"><span class="linenos">191</span></a>                <span class="k">if</span> <span class="n">max_rows</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">max_rows</span><span class="p">:</span>
</span><span id="TimeSeries-192"><a href="#TimeSeries-192"><span class="linenos">192</span></a>                    <span class="k">break</span> 
</span><span id="TimeSeries-193"><a href="#TimeSeries-193"><span class="linenos">193</span></a>                <span class="k">yield</span> <span class="n">times_conversion</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">time_col</span><span class="p">])</span>
</span><span id="TimeSeries-194"><a href="#TimeSeries-194"><span class="linenos">194</span></a>        
</span><span id="TimeSeries-195"><a href="#TimeSeries-195"><span class="linenos">195</span></a>        <span class="n">dep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(</span><span class="n">process_dep</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dependent_var_cols</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
</span><span id="TimeSeries-196"><a href="#TimeSeries-196"><span class="linenos">196</span></a>        
</span><span id="TimeSeries-197"><a href="#TimeSeries-197"><span class="linenos">197</span></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">DatetimeLikeArray</span><span class="o">.</span><span class="n">from_iter</span><span class="p">(</span><span class="n">process_times</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">times_dtype</span><span class="p">)</span>
</span><span id="TimeSeries-198"><a href="#TimeSeries-198"><span class="linenos">198</span></a>        
</span><span id="TimeSeries-199"><a href="#TimeSeries-199"><span class="linenos">199</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="TimeSeries-200"><a href="#TimeSeries-200"><span class="linenos">200</span></a>            <span class="n">dependent_variable</span><span class="o">=</span><span class="n">dep</span><span class="p">,</span> 
</span><span id="TimeSeries-201"><a href="#TimeSeries-201"><span class="linenos">201</span></a>            <span class="n">times</span><span class="o">=</span><span class="n">t</span>
</span><span id="TimeSeries-202"><a href="#TimeSeries-202"><span class="linenos">202</span></a>        <span class="p">)</span>
</span><span id="TimeSeries-203"><a href="#TimeSeries-203"><span class="linenos">203</span></a>    
</span><span id="TimeSeries-204"><a href="#TimeSeries-204"><span class="linenos">204</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimeSeriesTypedDict</span><span class="p">:</span>
</span><span id="TimeSeries-205"><a href="#TimeSeries-205"><span class="linenos">205</span></a><span class="w">        </span>
</span><span id="TimeSeries-206"><a href="#TimeSeries-206"><span class="linenos">206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TimeSeries-207"><a href="#TimeSeries-207"><span class="linenos">207</span></a><span class="sd">        convert to a typed dictionary</span>
</span><span id="TimeSeries-208"><a href="#TimeSeries-208"><span class="linenos">208</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TimeSeries-209"><a href="#TimeSeries-209"><span class="linenos">209</span></a>
</span><span id="TimeSeries-210"><a href="#TimeSeries-210"><span class="linenos">210</span></a>        <span class="k">return</span> <span class="n">TimeSeriesTypedDict</span><span class="p">(</span>
</span><span id="TimeSeries-211"><a href="#TimeSeries-211"><span class="linenos">211</span></a>            <span class="n">dependent_variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
</span><span id="TimeSeries-212"><a href="#TimeSeries-212"><span class="linenos">212</span></a>            <span class="n">times</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span><span id="TimeSeries-213"><a href="#TimeSeries-213"><span class="linenos">213</span></a>        <span class="p">)</span>
</span><span id="TimeSeries-214"><a href="#TimeSeries-214"><span class="linenos">214</span></a>    
</span><span id="TimeSeries-215"><a href="#TimeSeries-215"><span class="linenos">215</span></a>    <span class="nd">@property</span>
</span><span id="TimeSeries-216"><a href="#TimeSeries-216"><span class="linenos">216</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">timestep</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimeDeltaLike</span><span class="p">:</span>
</span><span id="TimeSeries-217"><a href="#TimeSeries-217"><span class="linenos">217</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TimeSeries-218"><a href="#TimeSeries-218"><span class="linenos">218</span></a><span class="sd">        Returns the time step between consecutive observations.</span>
</span><span id="TimeSeries-219"><a href="#TimeSeries-219"><span class="linenos">219</span></a>
</span><span id="TimeSeries-220"><a href="#TimeSeries-220"><span class="linenos">220</span></a><span class="sd">        Returns:</span>
</span><span id="TimeSeries-221"><a href="#TimeSeries-221"><span class="linenos">221</span></a><span class="sd">            TimeDeltaLike: The timestep of the time series.</span>
</span><span id="TimeSeries-222"><a href="#TimeSeries-222"><span class="linenos">222</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TimeSeries-223"><a href="#TimeSeries-223"><span class="linenos">223</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="TimeSeries-224"><a href="#TimeSeries-224"><span class="linenos">224</span></a>
</span><span id="TimeSeries-225"><a href="#TimeSeries-225"><span class="linenos">225</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="TimeSeries-226"><a href="#TimeSeries-226"><span class="linenos">226</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TimeSeries-227"><a href="#TimeSeries-227"><span class="linenos">227</span></a><span class="sd">        Checks equality between two TimeSeries instances.</span>
</span><span id="TimeSeries-228"><a href="#TimeSeries-228"><span class="linenos">228</span></a><span class="sd">        </span>
</span><span id="TimeSeries-229"><a href="#TimeSeries-229"><span class="linenos">229</span></a><span class="sd">        </span>
</span><span id="TimeSeries-230"><a href="#TimeSeries-230"><span class="linenos">230</span></a><span class="sd">        Returns:</span>
</span><span id="TimeSeries-231"><a href="#TimeSeries-231"><span class="linenos">231</span></a><span class="sd">            bool: True if both instances have the same times and dependent variables.</span>
</span><span id="TimeSeries-232"><a href="#TimeSeries-232"><span class="linenos">232</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TimeSeries-233"><a href="#TimeSeries-233"><span class="linenos">233</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">times</span> <span class="ow">and</span> <span class="nb">bool</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">)))</span>
</span><span id="TimeSeries-234"><a href="#TimeSeries-234"><span class="linenos">234</span></a>
</span><span id="TimeSeries-235"><a href="#TimeSeries-235"><span class="linenos">235</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span><span id="TimeSeries-236"><a href="#TimeSeries-236"><span class="linenos">236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TimeSeries-237"><a href="#TimeSeries-237"><span class="linenos">237</span></a><span class="sd">        Retrieves a subset of the TimeSeries.</span>
</span><span id="TimeSeries-238"><a href="#TimeSeries-238"><span class="linenos">238</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TimeSeries-239"><a href="#TimeSeries-239"><span class="linenos">239</span></a>        <span class="k">return</span> <span class="n">TimeSeries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="TimeSeries-240"><a href="#TimeSeries-240"><span class="linenos">240</span></a>
</span><span id="TimeSeries-241"><a href="#TimeSeries-241"><span class="linenos">241</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="TimeSeries-242"><a href="#TimeSeries-242"><span class="linenos">242</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TimeSeries-243"><a href="#TimeSeries-243"><span class="linenos">243</span></a><span class="sd">        Sets a subset of the TimeSeries.</span>
</span><span id="TimeSeries-244"><a href="#TimeSeries-244"><span class="linenos">244</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TimeSeries-245"><a href="#TimeSeries-245"><span class="linenos">245</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">TimeSeries</span><span class="p">):</span>
</span><span id="TimeSeries-246"><a href="#TimeSeries-246"><span class="linenos">246</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Value must be a TimeSeries object&quot;</span><span class="p">)</span>
</span><span id="TimeSeries-247"><a href="#TimeSeries-247"><span class="linenos">247</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">slice</span><span class="p">)</span> <span class="ow">and</span> <span class="n">key</span><span class="o">.</span><span class="n">stop</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">):</span>
</span><span id="TimeSeries-248"><a href="#TimeSeries-248"><span class="linenos">248</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Slice stop index out of range&quot;</span><span class="p">)</span>
</span><span id="TimeSeries-249"><a href="#TimeSeries-249"><span class="linenos">249</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">):</span>
</span><span id="TimeSeries-250"><a href="#TimeSeries-250"><span class="linenos">250</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Index out of range&quot;</span><span class="p">)</span>
</span><span id="TimeSeries-251"><a href="#TimeSeries-251"><span class="linenos">251</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">dependent_variable</span>
</span><span id="TimeSeries-252"><a href="#TimeSeries-252"><span class="linenos">252</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">times</span>
</span><span id="TimeSeries-253"><a href="#TimeSeries-253"><span class="linenos">253</span></a>
</span><span id="TimeSeries-254"><a href="#TimeSeries-254"><span class="linenos">254</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="TimeSeries-255"><a href="#TimeSeries-255"><span class="linenos">255</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TimeSeries-256"><a href="#TimeSeries-256"><span class="linenos">256</span></a><span class="sd">        Adds two TimeSeries instances element-wise.</span>
</span><span id="TimeSeries-257"><a href="#TimeSeries-257"><span class="linenos">257</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TimeSeries-258"><a href="#TimeSeries-258"><span class="linenos">258</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">times</span><span class="p">):</span>
</span><span id="TimeSeries-259"><a href="#TimeSeries-259"><span class="linenos">259</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can only add TimeSeries instances that have the same number of timesteps&quot;</span><span class="p">)</span>
</span><span id="TimeSeries-260"><a href="#TimeSeries-260"><span class="linenos">260</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">times</span><span class="p">):</span>
</span><span id="TimeSeries-261"><a href="#TimeSeries-261"><span class="linenos">261</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can only add TimeSeries instances that span the same times&quot;</span><span class="p">)</span>
</span><span id="TimeSeries-262"><a href="#TimeSeries-262"><span class="linenos">262</span></a>        <span class="k">return</span> <span class="n">TimeSeries</span><span class="p">(</span>
</span><span id="TimeSeries-263"><a href="#TimeSeries-263"><span class="linenos">263</span></a>            <span class="n">dependent_variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">,</span>
</span><span id="TimeSeries-264"><a href="#TimeSeries-264"><span class="linenos">264</span></a>            <span class="n">times</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span>
</span><span id="TimeSeries-265"><a href="#TimeSeries-265"><span class="linenos">265</span></a>        <span class="p">)</span>
</span><span id="TimeSeries-266"><a href="#TimeSeries-266"><span class="linenos">266</span></a>    
</span><span id="TimeSeries-267"><a href="#TimeSeries-267"><span class="linenos">267</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="TimeSeries-268"><a href="#TimeSeries-268"><span class="linenos">268</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TimeSeries-269"><a href="#TimeSeries-269"><span class="linenos">269</span></a><span class="sd">        Subtracts two TimeSeries instances element-wise.</span>
</span><span id="TimeSeries-270"><a href="#TimeSeries-270"><span class="linenos">270</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TimeSeries-271"><a href="#TimeSeries-271"><span class="linenos">271</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">times</span><span class="p">):</span>
</span><span id="TimeSeries-272"><a href="#TimeSeries-272"><span class="linenos">272</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can only subtract TimeSeries instances that have the same number of timesteps&quot;</span><span class="p">)</span>
</span><span id="TimeSeries-273"><a href="#TimeSeries-273"><span class="linenos">273</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">times</span><span class="p">):</span>
</span><span id="TimeSeries-274"><a href="#TimeSeries-274"><span class="linenos">274</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can only subtract TimeSeries instances that span the same times&quot;</span><span class="p">)</span>
</span><span id="TimeSeries-275"><a href="#TimeSeries-275"><span class="linenos">275</span></a>        <span class="k">return</span> <span class="n">TimeSeries</span><span class="p">(</span>
</span><span id="TimeSeries-276"><a href="#TimeSeries-276"><span class="linenos">276</span></a>            <span class="n">dependent_variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">,</span>
</span><span id="TimeSeries-277"><a href="#TimeSeries-277"><span class="linenos">277</span></a>            <span class="n">times</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span>
</span><span id="TimeSeries-278"><a href="#TimeSeries-278"><span class="linenos">278</span></a>        <span class="p">)</span>
</span><span id="TimeSeries-279"><a href="#TimeSeries-279"><span class="linenos">279</span></a>
</span><span id="TimeSeries-280"><a href="#TimeSeries-280"><span class="linenos">280</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__rshift__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="TimeSeries-281"><a href="#TimeSeries-281"><span class="linenos">281</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TimeSeries-282"><a href="#TimeSeries-282"><span class="linenos">282</span></a><span class="sd">        Concatenates two non-overlapping TimeSeries instances.</span>
</span><span id="TimeSeries-283"><a href="#TimeSeries-283"><span class="linenos">283</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TimeSeries-284"><a href="#TimeSeries-284"><span class="linenos">284</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="TimeSeries-285"><a href="#TimeSeries-285"><span class="linenos">285</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can only concatenate TimeSeries instances with non-overlapping time values&quot;</span><span class="p">)</span>
</span><span id="TimeSeries-286"><a href="#TimeSeries-286"><span class="linenos">286</span></a>        <span class="k">return</span> <span class="n">TimeSeries</span><span class="p">(</span>
</span><span id="TimeSeries-287"><a href="#TimeSeries-287"><span class="linenos">287</span></a>            <span class="n">dependent_variable</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">dependent_variable</span><span class="p">)),</span>
</span><span id="TimeSeries-288"><a href="#TimeSeries-288"><span class="linenos">288</span></a>            <span class="n">times</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">times</span><span class="p">))</span>
</span><span id="TimeSeries-289"><a href="#TimeSeries-289"><span class="linenos">289</span></a>        <span class="p">)</span>
</span><span id="TimeSeries-290"><a href="#TimeSeries-290"><span class="linenos">290</span></a>
</span><span id="TimeSeries-291"><a href="#TimeSeries-291"><span class="linenos">291</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TimeSeries-292"><a href="#TimeSeries-292"><span class="linenos">292</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TimeSeries-293"><a href="#TimeSeries-293"><span class="linenos">293</span></a><span class="sd">        Returns the number of timesteps in the TimeSeries.</span>
</span><span id="TimeSeries-294"><a href="#TimeSeries-294"><span class="linenos">294</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TimeSeries-295"><a href="#TimeSeries-295"><span class="linenos">295</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A class representing a time series, encapsulating dependent variables and corresponding timestamps.</p>
</div>


                            <div id="TimeSeries.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">TimeSeries</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">dependent_variable</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span>,</span><span class="param">	<span class="n">times</span><span class="p">:</span> <span class="n"><a href="datetimelikearray.html#DatetimeLikeArray">aqua_blue.datetimelikearray.DatetimeLikeArray</a></span></span>)</span>

        
    </div>
    <a class="headerlink" href="#TimeSeries.__init__"></a>
    
    

                            </div>
                            <div id="TimeSeries.dependent_variable" class="classattr">
                                <div class="attr variable">
            <span class="name">dependent_variable</span><span class="annotation">: numpy.ndarray[typing.Any, numpy.dtype[numpy.floating]]</span>

        
    </div>
    <a class="headerlink" href="#TimeSeries.dependent_variable"></a>
    
            <div class="docstring"><p>Array of dependent variables representing the time series values.</p>
</div>


                            </div>
                            <div id="TimeSeries.times" class="classattr">
                                <div class="attr variable">
            <span class="name">times</span><span class="annotation">: <a href="datetimelikearray.html#DatetimeLikeArray">aqua_blue.datetimelikearray.DatetimeLikeArray</a></span>

        
    </div>
    <a class="headerlink" href="#TimeSeries.times"></a>
    
            <div class="docstring"><p>Array of time values associated with the dependent variable.</p>
</div>


                            </div>
                            <div id="TimeSeries.save" class="classattr">
                                        <input id="TimeSeries.save-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">IO</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span>,</span><span class="param">	<span class="n">header</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span>,</span><span class="param">	<span class="n">fmt</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TimeSeries.save-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TimeSeries.save"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TimeSeries.save-97"><a href="#TimeSeries.save-97"><span class="linenos"> 97</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">IO</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="n">header</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">):</span>
</span><span id="TimeSeries.save-98"><a href="#TimeSeries.save-98"><span class="linenos"> 98</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TimeSeries.save-99"><a href="#TimeSeries.save-99"><span class="linenos"> 99</span></a><span class="sd">        Saves the time series data to a file.</span>
</span><span id="TimeSeries.save-100"><a href="#TimeSeries.save-100"><span class="linenos">100</span></a><span class="sd">        </span>
</span><span id="TimeSeries.save-101"><a href="#TimeSeries.save-101"><span class="linenos">101</span></a><span class="sd">        Args:</span>
</span><span id="TimeSeries.save-102"><a href="#TimeSeries.save-102"><span class="linenos">102</span></a><span class="sd">            fp (Union[IO, str, Path]): File path or object where the TimeSeries instance will be saved.</span>
</span><span id="TimeSeries.save-103"><a href="#TimeSeries.save-103"><span class="linenos">103</span></a><span class="sd">            header (str, optional): An optional header. Defaults to an empty string.</span>
</span><span id="TimeSeries.save-104"><a href="#TimeSeries.save-104"><span class="linenos">104</span></a><span class="sd">            delimiter (str, optional): The delimiter used in the output file. Defaults to a comma.</span>
</span><span id="TimeSeries.save-105"><a href="#TimeSeries.save-105"><span class="linenos">105</span></a><span class="sd">            fmt (Tuple(str), optional): Format specifier used for saving the data to fp. Defaults to &#39;%s&#39; (String representation)</span>
</span><span id="TimeSeries.save-106"><a href="#TimeSeries.save-106"><span class="linenos">106</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TimeSeries.save-107"><a href="#TimeSeries.save-107"><span class="linenos">107</span></a>        
</span><span id="TimeSeries.save-108"><a href="#TimeSeries.save-108"><span class="linenos">108</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span>
</span><span id="TimeSeries.save-109"><a href="#TimeSeries.save-109"><span class="linenos">109</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;object&#39;</span><span class="p">),</span> 
</span><span id="TimeSeries.save-110"><a href="#TimeSeries.save-110"><span class="linenos">110</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
</span><span id="TimeSeries.save-111"><a href="#TimeSeries.save-111"><span class="linenos">111</span></a>        <span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="TimeSeries.save-112"><a href="#TimeSeries.save-112"><span class="linenos">112</span></a>        
</span><span id="TimeSeries.save-113"><a href="#TimeSeries.save-113"><span class="linenos">113</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span>
</span><span id="TimeSeries.save-114"><a href="#TimeSeries.save-114"><span class="linenos">114</span></a>            <span class="n">fp</span><span class="p">,</span>
</span><span id="TimeSeries.save-115"><a href="#TimeSeries.save-115"><span class="linenos">115</span></a>            <span class="n">data</span><span class="p">,</span>
</span><span id="TimeSeries.save-116"><a href="#TimeSeries.save-116"><span class="linenos">116</span></a>            <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">,</span>
</span><span id="TimeSeries.save-117"><a href="#TimeSeries.save-117"><span class="linenos">117</span></a>            <span class="n">fmt</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span>
</span><span id="TimeSeries.save-118"><a href="#TimeSeries.save-118"><span class="linenos">118</span></a>            <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
</span><span id="TimeSeries.save-119"><a href="#TimeSeries.save-119"><span class="linenos">119</span></a>            <span class="n">comments</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
</span><span id="TimeSeries.save-120"><a href="#TimeSeries.save-120"><span class="linenos">120</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Saves the time series data to a file.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>fp (Union[IO, str, Path]):</strong>  File path or object where the TimeSeries instance will be saved.</li>
<li><strong>header (str, optional):</strong>  An optional header. Defaults to an empty string.</li>
<li><strong>delimiter (str, optional):</strong>  The delimiter used in the output file. Defaults to a comma.</li>
<li><strong>fmt (Tuple(str), optional):</strong>  Format specifier used for saving the data to fp. Defaults to '%s' (String representation)</li>
</ul>
</div>


                            </div>
                            <div id="TimeSeries.num_dims" class="classattr">
                                        <input id="TimeSeries.num_dims-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">num_dims</span><span class="annotation">: int</span>

                <label class="view-source-button" for="TimeSeries.num_dims-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TimeSeries.num_dims"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TimeSeries.num_dims-122"><a href="#TimeSeries.num_dims-122"><span class="linenos">122</span></a>    <span class="nd">@property</span>
</span><span id="TimeSeries.num_dims-123"><a href="#TimeSeries.num_dims-123"><span class="linenos">123</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">num_dims</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="TimeSeries.num_dims-124"><a href="#TimeSeries.num_dims-124"><span class="linenos">124</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TimeSeries.num_dims-125"><a href="#TimeSeries.num_dims-125"><span class="linenos">125</span></a><span class="sd">        Returns the dimensionality of the dependent variable.</span>
</span><span id="TimeSeries.num_dims-126"><a href="#TimeSeries.num_dims-126"><span class="linenos">126</span></a><span class="sd">        </span>
</span><span id="TimeSeries.num_dims-127"><a href="#TimeSeries.num_dims-127"><span class="linenos">127</span></a><span class="sd">        Returns:</span>
</span><span id="TimeSeries.num_dims-128"><a href="#TimeSeries.num_dims-128"><span class="linenos">128</span></a><span class="sd">            int: Number of dimensions of the time series.</span>
</span><span id="TimeSeries.num_dims-129"><a href="#TimeSeries.num_dims-129"><span class="linenos">129</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TimeSeries.num_dims-130"><a href="#TimeSeries.num_dims-130"><span class="linenos">130</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Returns the dimensionality of the dependent variable.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>int: Number of dimensions of the time series.</p>
</blockquote>
</div>


                            </div>
                            <div id="TimeSeries.from_csv" class="classattr">
                                        <input id="TimeSeries.from_csv-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-classmethod">@classmethod</div>

        <span class="def">def</span>
        <span class="name">from_csv</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">cls</span>,</span><span class="param">	<span class="n">fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">IO</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">]</span>,</span><span class="param">	<span class="n">time_col</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">times_dtype</span><span class="p">:</span> <span class="n">Type</span>,</span><span class="param">	<span class="n">dependent_var_cols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">times_conversion</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="o">~</span><span class="n">DatetimeLike</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n">parse_time</span><span class="o">&gt;</span>,</span><span class="param">	dep_var_conversion: Callable[[str], float] = &lt;class &#x27;float&#x27;&gt;,</span><span class="param">	<span class="n">max_rows</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TimeSeries.from_csv-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TimeSeries.from_csv"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TimeSeries.from_csv-132"><a href="#TimeSeries.from_csv-132"><span class="linenos">132</span></a>    <span class="nd">@classmethod</span>
</span><span id="TimeSeries.from_csv-133"><a href="#TimeSeries.from_csv-133"><span class="linenos">133</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">from_csv</span><span class="p">(</span>
</span><span id="TimeSeries.from_csv-134"><a href="#TimeSeries.from_csv-134"><span class="linenos">134</span></a>        <span class="bp">cls</span><span class="p">,</span> 
</span><span id="TimeSeries.from_csv-135"><a href="#TimeSeries.from_csv-135"><span class="linenos">135</span></a>        <span class="n">fp</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">IO</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> 
</span><span id="TimeSeries.from_csv-136"><a href="#TimeSeries.from_csv-136"><span class="linenos">136</span></a>        <span class="n">time_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="TimeSeries.from_csv-137"><a href="#TimeSeries.from_csv-137"><span class="linenos">137</span></a>        <span class="n">times_dtype</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span>
</span><span id="TimeSeries.from_csv-138"><a href="#TimeSeries.from_csv-138"><span class="linenos">138</span></a>        <span class="n">dependent_var_cols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="TimeSeries.from_csv-139"><a href="#TimeSeries.from_csv-139"><span class="linenos">139</span></a>        <span class="n">times_conversion</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">DatetimeLike</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_time</span><span class="p">,</span> 
</span><span id="TimeSeries.from_csv-140"><a href="#TimeSeries.from_csv-140"><span class="linenos">140</span></a>        <span class="n">dep_var_conversion</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="TimeSeries.from_csv-141"><a href="#TimeSeries.from_csv-141"><span class="linenos">141</span></a>        <span class="n">max_rows</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="TimeSeries.from_csv-142"><a href="#TimeSeries.from_csv-142"><span class="linenos">142</span></a>    <span class="p">):</span>
</span><span id="TimeSeries.from_csv-143"><a href="#TimeSeries.from_csv-143"><span class="linenos">143</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TimeSeries.from_csv-144"><a href="#TimeSeries.from_csv-144"><span class="linenos">144</span></a><span class="sd">        Loads time series data from a CSV file.</span>
</span><span id="TimeSeries.from_csv-145"><a href="#TimeSeries.from_csv-145"><span class="linenos">145</span></a><span class="sd">        </span>
</span><span id="TimeSeries.from_csv-146"><a href="#TimeSeries.from_csv-146"><span class="linenos">146</span></a><span class="sd">        Args:</span>
</span><span id="TimeSeries.from_csv-147"><a href="#TimeSeries.from_csv-147"><span class="linenos">147</span></a><span class="sd">            fp (Union[IO, str, Path]): File path or object to read from.</span>
</span><span id="TimeSeries.from_csv-148"><a href="#TimeSeries.from_csv-148"><span class="linenos">148</span></a><span class="sd">            time_col (str): Name of the times column.</span>
</span><span id="TimeSeries.from_csv-149"><a href="#TimeSeries.from_csv-149"><span class="linenos">149</span></a><span class="sd">            times_dtype (dtype): Type of the times column</span>
</span><span id="TimeSeries.from_csv-150"><a href="#TimeSeries.from_csv-150"><span class="linenos">150</span></a><span class="sd">            dependent_var_cols (List[str]): Names of the dependent variable columns</span>
</span><span id="TimeSeries.from_csv-151"><a href="#TimeSeries.from_csv-151"><span class="linenos">151</span></a><span class="sd">            times_conversion (Callable[[str], DatetimeLike]): Function determining how to parse elements of the times column. Defaults to parse_time</span>
</span><span id="TimeSeries.from_csv-152"><a href="#TimeSeries.from_csv-152"><span class="linenos">152</span></a><span class="sd">            dep_var_conversion (Callable[[str], float]): Function determining how to parse elements of the dependent variable columns. Defaults to float</span>
</span><span id="TimeSeries.from_csv-153"><a href="#TimeSeries.from_csv-153"><span class="linenos">153</span></a><span class="sd">            max_rows (float): Maximum number of rows that should be parsed. If set to zero, all rows are parsed. Defaults to 0</span>
</span><span id="TimeSeries.from_csv-154"><a href="#TimeSeries.from_csv-154"><span class="linenos">154</span></a><span class="sd">        </span>
</span><span id="TimeSeries.from_csv-155"><a href="#TimeSeries.from_csv-155"><span class="linenos">155</span></a><span class="sd">        Returns:</span>
</span><span id="TimeSeries.from_csv-156"><a href="#TimeSeries.from_csv-156"><span class="linenos">156</span></a><span class="sd">            TimeSeries: A TimeSeries instance populated by data from the csv file.</span>
</span><span id="TimeSeries.from_csv-157"><a href="#TimeSeries.from_csv-157"><span class="linenos">157</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TimeSeries.from_csv-158"><a href="#TimeSeries.from_csv-158"><span class="linenos">158</span></a>        <span class="c1"># Helper generator to get a csv.DictReader source from different sources</span>
</span><span id="TimeSeries.from_csv-159"><a href="#TimeSeries.from_csv-159"><span class="linenos">159</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">get_reader</span><span class="p">(</span><span class="n">fp_</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Dict</span><span class="p">]:</span>
</span><span id="TimeSeries.from_csv-160"><a href="#TimeSeries.from_csv-160"><span class="linenos">160</span></a>            
</span><span id="TimeSeries.from_csv-161"><a href="#TimeSeries.from_csv-161"><span class="linenos">161</span></a>            <span class="c1"># Checking the input format</span>
</span><span id="TimeSeries.from_csv-162"><a href="#TimeSeries.from_csv-162"><span class="linenos">162</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fp_</span><span class="p">,</span> <span class="n">Path</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fp_</span><span class="p">):</span>
</span><span id="TimeSeries.from_csv-163"><a href="#TimeSeries.from_csv-163"><span class="linenos">163</span></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fp_</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="TimeSeries.from_csv-164"><a href="#TimeSeries.from_csv-164"><span class="linenos">164</span></a>                    <span class="k">yield from</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
</span><span id="TimeSeries.from_csv-165"><a href="#TimeSeries.from_csv-165"><span class="linenos">165</span></a>        
</span><span id="TimeSeries.from_csv-166"><a href="#TimeSeries.from_csv-166"><span class="linenos">166</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fp_</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">):</span>
</span><span id="TimeSeries.from_csv-167"><a href="#TimeSeries.from_csv-167"><span class="linenos">167</span></a>                <span class="c1"># Use codecs, because decoding directly is an eager operation</span>
</span><span id="TimeSeries.from_csv-168"><a href="#TimeSeries.from_csv-168"><span class="linenos">168</span></a>                <span class="n">fp_</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="TimeSeries.from_csv-169"><a href="#TimeSeries.from_csv-169"><span class="linenos">169</span></a>                <span class="k">yield from</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">codecs</span><span class="o">.</span><span class="n">getreader</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)(</span><span class="n">fp_</span><span class="p">))</span>
</span><span id="TimeSeries.from_csv-170"><a href="#TimeSeries.from_csv-170"><span class="linenos">170</span></a>            
</span><span id="TimeSeries.from_csv-171"><a href="#TimeSeries.from_csv-171"><span class="linenos">171</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">):</span>
</span><span id="TimeSeries.from_csv-172"><a href="#TimeSeries.from_csv-172"><span class="linenos">172</span></a>                <span class="n">fp_</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="TimeSeries.from_csv-173"><a href="#TimeSeries.from_csv-173"><span class="linenos">173</span></a>                <span class="k">yield from</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
</span><span id="TimeSeries.from_csv-174"><a href="#TimeSeries.from_csv-174"><span class="linenos">174</span></a>            
</span><span id="TimeSeries.from_csv-175"><a href="#TimeSeries.from_csv-175"><span class="linenos">175</span></a>            <span class="k">else</span><span class="p">:</span> 
</span><span id="TimeSeries.from_csv-176"><a href="#TimeSeries.from_csv-176"><span class="linenos">176</span></a>                <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">()</span>
</span><span id="TimeSeries.from_csv-177"><a href="#TimeSeries.from_csv-177"><span class="linenos">177</span></a>        
</span><span id="TimeSeries.from_csv-178"><a href="#TimeSeries.from_csv-178"><span class="linenos">178</span></a>        <span class="c1"># Generator for lazy dependent variable processing</span>
</span><span id="TimeSeries.from_csv-179"><a href="#TimeSeries.from_csv-179"><span class="linenos">179</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">process_dep</span><span class="p">():</span> 
</span><span id="TimeSeries.from_csv-180"><a href="#TimeSeries.from_csv-180"><span class="linenos">180</span></a>            <span class="n">reader</span> <span class="o">=</span> <span class="n">get_reader</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</span><span id="TimeSeries.from_csv-181"><a href="#TimeSeries.from_csv-181"><span class="linenos">181</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">reader</span><span class="p">):</span>
</span><span id="TimeSeries.from_csv-182"><a href="#TimeSeries.from_csv-182"><span class="linenos">182</span></a>                <span class="k">if</span> <span class="n">max_rows</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">max_rows</span><span class="p">:</span>
</span><span id="TimeSeries.from_csv-183"><a href="#TimeSeries.from_csv-183"><span class="linenos">183</span></a>                    <span class="k">break</span>
</span><span id="TimeSeries.from_csv-184"><a href="#TimeSeries.from_csv-184"><span class="linenos">184</span></a>                <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">dependent_var_cols</span><span class="p">:</span> 
</span><span id="TimeSeries.from_csv-185"><a href="#TimeSeries.from_csv-185"><span class="linenos">185</span></a>                    <span class="k">yield</span> <span class="n">dep_var_conversion</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">col</span><span class="p">])</span> 
</span><span id="TimeSeries.from_csv-186"><a href="#TimeSeries.from_csv-186"><span class="linenos">186</span></a>        
</span><span id="TimeSeries.from_csv-187"><a href="#TimeSeries.from_csv-187"><span class="linenos">187</span></a>        <span class="c1"># Generator for lazy times processing</span>
</span><span id="TimeSeries.from_csv-188"><a href="#TimeSeries.from_csv-188"><span class="linenos">188</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">process_times</span><span class="p">():</span> 
</span><span id="TimeSeries.from_csv-189"><a href="#TimeSeries.from_csv-189"><span class="linenos">189</span></a>            <span class="n">reader</span> <span class="o">=</span> <span class="n">get_reader</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</span><span id="TimeSeries.from_csv-190"><a href="#TimeSeries.from_csv-190"><span class="linenos">190</span></a>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">reader</span><span class="p">):</span>
</span><span id="TimeSeries.from_csv-191"><a href="#TimeSeries.from_csv-191"><span class="linenos">191</span></a>                <span class="k">if</span> <span class="n">max_rows</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">max_rows</span><span class="p">:</span>
</span><span id="TimeSeries.from_csv-192"><a href="#TimeSeries.from_csv-192"><span class="linenos">192</span></a>                    <span class="k">break</span> 
</span><span id="TimeSeries.from_csv-193"><a href="#TimeSeries.from_csv-193"><span class="linenos">193</span></a>                <span class="k">yield</span> <span class="n">times_conversion</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">time_col</span><span class="p">])</span>
</span><span id="TimeSeries.from_csv-194"><a href="#TimeSeries.from_csv-194"><span class="linenos">194</span></a>        
</span><span id="TimeSeries.from_csv-195"><a href="#TimeSeries.from_csv-195"><span class="linenos">195</span></a>        <span class="n">dep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromiter</span><span class="p">(</span><span class="n">process_dep</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dependent_var_cols</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
</span><span id="TimeSeries.from_csv-196"><a href="#TimeSeries.from_csv-196"><span class="linenos">196</span></a>        
</span><span id="TimeSeries.from_csv-197"><a href="#TimeSeries.from_csv-197"><span class="linenos">197</span></a>        <span class="n">t</span> <span class="o">=</span> <span class="n">DatetimeLikeArray</span><span class="o">.</span><span class="n">from_iter</span><span class="p">(</span><span class="n">process_times</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">times_dtype</span><span class="p">)</span>
</span><span id="TimeSeries.from_csv-198"><a href="#TimeSeries.from_csv-198"><span class="linenos">198</span></a>        
</span><span id="TimeSeries.from_csv-199"><a href="#TimeSeries.from_csv-199"><span class="linenos">199</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="TimeSeries.from_csv-200"><a href="#TimeSeries.from_csv-200"><span class="linenos">200</span></a>            <span class="n">dependent_variable</span><span class="o">=</span><span class="n">dep</span><span class="p">,</span> 
</span><span id="TimeSeries.from_csv-201"><a href="#TimeSeries.from_csv-201"><span class="linenos">201</span></a>            <span class="n">times</span><span class="o">=</span><span class="n">t</span>
</span><span id="TimeSeries.from_csv-202"><a href="#TimeSeries.from_csv-202"><span class="linenos">202</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Loads time series data from a CSV file.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>fp (Union[IO, str, Path]):</strong>  File path or object to read from.</li>
<li><strong>time_col (str):</strong>  Name of the times column.</li>
<li><strong>times_dtype (dtype):</strong>  Type of the times column</li>
<li><strong>dependent_var_cols (List[str]):</strong>  Names of the dependent variable columns</li>
<li><strong>times_conversion (Callable[[str], DatetimeLike]):</strong>  Function determining how to parse elements of the times column. Defaults to parse_time</li>
<li><strong>dep_var_conversion (Callable[[str], float]):</strong>  Function determining how to parse elements of the dependent variable columns. Defaults to float</li>
<li><strong>max_rows (float):</strong>  Maximum number of rows that should be parsed. If set to zero, all rows are parsed. Defaults to 0</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>TimeSeries: A TimeSeries instance populated by data from the csv file.</p>
</blockquote>
</div>


                            </div>
                            <div id="TimeSeries.to_dict" class="classattr">
                                        <input id="TimeSeries.to_dict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_dict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n"><a href="#TimeSeriesTypedDict">TimeSeriesTypedDict</a></span>:</span></span>

                <label class="view-source-button" for="TimeSeries.to_dict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TimeSeries.to_dict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TimeSeries.to_dict-204"><a href="#TimeSeries.to_dict-204"><span class="linenos">204</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimeSeriesTypedDict</span><span class="p">:</span>
</span><span id="TimeSeries.to_dict-205"><a href="#TimeSeries.to_dict-205"><span class="linenos">205</span></a><span class="w">        </span>
</span><span id="TimeSeries.to_dict-206"><a href="#TimeSeries.to_dict-206"><span class="linenos">206</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TimeSeries.to_dict-207"><a href="#TimeSeries.to_dict-207"><span class="linenos">207</span></a><span class="sd">        convert to a typed dictionary</span>
</span><span id="TimeSeries.to_dict-208"><a href="#TimeSeries.to_dict-208"><span class="linenos">208</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TimeSeries.to_dict-209"><a href="#TimeSeries.to_dict-209"><span class="linenos">209</span></a>
</span><span id="TimeSeries.to_dict-210"><a href="#TimeSeries.to_dict-210"><span class="linenos">210</span></a>        <span class="k">return</span> <span class="n">TimeSeriesTypedDict</span><span class="p">(</span>
</span><span id="TimeSeries.to_dict-211"><a href="#TimeSeries.to_dict-211"><span class="linenos">211</span></a>            <span class="n">dependent_variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dependent_variable</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
</span><span id="TimeSeries.to_dict-212"><a href="#TimeSeries.to_dict-212"><span class="linenos">212</span></a>            <span class="n">times</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</span><span id="TimeSeries.to_dict-213"><a href="#TimeSeries.to_dict-213"><span class="linenos">213</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>convert to a typed dictionary</p>
</div>


                            </div>
                            <div id="TimeSeries.timestep" class="classattr">
                                        <input id="TimeSeries.timestep-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">timestep</span><span class="annotation">: ~TimeDeltaLike</span>

                <label class="view-source-button" for="TimeSeries.timestep-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TimeSeries.timestep"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TimeSeries.timestep-215"><a href="#TimeSeries.timestep-215"><span class="linenos">215</span></a>    <span class="nd">@property</span>
</span><span id="TimeSeries.timestep-216"><a href="#TimeSeries.timestep-216"><span class="linenos">216</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">timestep</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimeDeltaLike</span><span class="p">:</span>
</span><span id="TimeSeries.timestep-217"><a href="#TimeSeries.timestep-217"><span class="linenos">217</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TimeSeries.timestep-218"><a href="#TimeSeries.timestep-218"><span class="linenos">218</span></a><span class="sd">        Returns the time step between consecutive observations.</span>
</span><span id="TimeSeries.timestep-219"><a href="#TimeSeries.timestep-219"><span class="linenos">219</span></a>
</span><span id="TimeSeries.timestep-220"><a href="#TimeSeries.timestep-220"><span class="linenos">220</span></a><span class="sd">        Returns:</span>
</span><span id="TimeSeries.timestep-221"><a href="#TimeSeries.timestep-221"><span class="linenos">221</span></a><span class="sd">            TimeDeltaLike: The timestep of the time series.</span>
</span><span id="TimeSeries.timestep-222"><a href="#TimeSeries.timestep-222"><span class="linenos">222</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TimeSeries.timestep-223"><a href="#TimeSeries.timestep-223"><span class="linenos">223</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Returns the time step between consecutive observations.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>TimeDeltaLike: The timestep of the time series.</p>
</blockquote>
</div>


                            </div>
                </section>
    </main>
<!-- End of C:/CodingGeneral/chicagoClubManagement/aqua-blue/_build/aqua_blue/time_series.html -->
<!-- Start of C:/CodingGeneral/chicagoClubManagement/aqua-blue/_build/aqua_blue/utilities.html -->
<nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../aqua_blue.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;aqua_blue</a>

            <img src="https://raw.githubusercontent.com/Chicago-Club-Management-Company/aqua-blue/refs/heads/main/assets/blue.jpg" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Normalizer">Normalizer</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#Normalizer.means">means</a>
                        </li>
                        <li>
                                <a class="variable" href="#Normalizer.standard_deviations">standard_deviations</a>
                        </li>
                        <li>
                                <a class="function" href="#Normalizer.normalize">normalize</a>
                        </li>
                        <li>
                                <a class="function" href="#Normalizer.denormalize">denormalize</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#make_sparse">make_sparse</a>
            </li>
            <li>
                    <a class="function" href="#set_spectral">set_spectral</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../aqua_blue.html">aqua_blue</a><wbr>.utilities    </h1>

                        <div class="docstring"><p>This module provides simple utilities for processing TimeSeries instances.</p>
</div>

                        <input id="mod-utilities-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-utilities-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">This module provides simple utilities for processing TimeSeries instances.</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.time_series</span><span class="w"> </span><span class="kn">import</span> <span class="n">TimeSeries</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="nd">@dataclass</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Normalizer</span><span class="p">:</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="sd">    A utility class for normalizing and denormalizing TimeSeries instances.</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="sd">    This class computes and stores the mean and standard deviation of the</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="sd">    dependent variable during normalization. These statistics are later used</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="sd">    to restore the original scale of the data when denormalizing.</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>    
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>    <span class="n">means</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Mean values of the dependent variable, computed during normalization.&quot;&quot;&quot;</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>    <span class="n">standard_deviations</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Standard deviation values of the dependent variable, computed during normalization.&quot;&quot;&quot;</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_series</span><span class="p">:</span> <span class="n">TimeSeries</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimeSeries</span><span class="p">:</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">        Normalize a TimeSeries instance by adjusting its values to have zero mean and unit variance.</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">        Args:</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">            time_series (TimeSeries): The time series to be normalized.</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">        Returns:</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">            TimeSeries: A new TimeSeries instance with normalized values.</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">  </span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">        Raises:</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">            ValueError: If the normalizer has already been used, since it is intended for one-time use.</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>        
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;means&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;standard_deviations&quot;</span><span class="p">):</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You can only use the Normalizer once. Create a new instance to normalize again&quot;</span><span class="p">)</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>        
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">time_series</span><span class="o">.</span><span class="n">dependent_variable</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">means</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviations</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>        
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviations</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>        
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>        <span class="k">return</span> <span class="n">TimeSeries</span><span class="p">(</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>            <span class="n">dependent_variable</span><span class="o">=</span><span class="n">arr</span><span class="p">,</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>            <span class="n">times</span><span class="o">=</span><span class="n">time_series</span><span class="o">.</span><span class="n">times</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>        <span class="p">)</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>    
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">denormalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_series</span><span class="p">:</span> <span class="n">TimeSeries</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimeSeries</span><span class="p">:</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">        Denormalize a previously normalized TimeSeries instance, restoring it to its original scale.</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">        Args:</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">            time_series (TimeSeries): Time series to denormalize</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">        </span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">        Returns:</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">            TimeSeries: The denormalized time series</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">        </span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">        Raises:</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">            ValueError: If normalization has not been performed before calling this method.</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>        
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;means&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;standard_deviations&quot;</span><span class="p">):</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You can only denormalize after normalizing a time series.&quot;</span><span class="p">)</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>  
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">time_series</span><span class="o">.</span><span class="n">dependent_variable</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviations</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>        
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>        <span class="k">return</span> <span class="n">TimeSeries</span><span class="p">(</span><span class="n">dependent_variable</span><span class="o">=</span><span class="n">arr</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">time_series</span><span class="o">.</span><span class="n">times</span><span class="p">)</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="k">def</span><span class="w"> </span><span class="nf">make_sparse</span><span class="p">(</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>    <span class="n">weight_matrix</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">],</span> 
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>    <span class="n">sparsity</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>    <span class="n">generator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Generator</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]:</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">    Make a weight matrix sparse </span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">    </span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">    Args:</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">    </span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">        weight_matrix (np.typing.NDArray[np.floating]): Weight matrix to be made sparse</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">        sparsity (float): Extent of how sparse to make the weight matrix. Ranges from 0 to 1.</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">        generator (np.random.Generator): NumPy Generator to create random numbers</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>    
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">generator</span><span class="p">:</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>        <span class="n">generator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>    
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>    <span class="n">mask</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">weight_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">sparsity</span> 
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>    <span class="k">return</span> <span class="n">weight_matrix</span> <span class="o">*</span> <span class="n">mask</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="k">def</span><span class="w"> </span><span class="nf">set_spectral</span><span class="p">(</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>    <span class="n">weight_matrix</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">],</span> 
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>    <span class="n">spectral_radius</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]:</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="w">    </span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="sd">    Set the spectral radius of the weight matrix </span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">    </span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="sd">    Args:</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">    </span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a><span class="sd">        weight_matrix (np.typing.NDArray[np.floating]): Weight matrix whose spectral radius is to be set</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a><span class="sd">        spectral_radius (float):</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="sd">            The largest absolute singular value of the weight matrix.</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a><span class="sd">            Values less than 1.0 are recommended for tasks that require significant memory fading.</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="sd">            Values between 1-1.5 are recommended for tasks that are memory dependent.</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>    
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>    <span class="k">return</span> <span class="n">spectral_radius</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">weight_matrix</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">weight_matrix</span>
</span></pre></div>


            </section>
                <section id="Normalizer">
                            <input id="Normalizer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator decorator-dataclass">@dataclass</div>

    <span class="def">class</span>
    <span class="name">Normalizer</span>:

                <label class="view-source-button" for="Normalizer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Normalizer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Normalizer-13"><a href="#Normalizer-13"><span class="linenos">13</span></a><span class="nd">@dataclass</span>
</span><span id="Normalizer-14"><a href="#Normalizer-14"><span class="linenos">14</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Normalizer</span><span class="p">:</span>
</span><span id="Normalizer-15"><a href="#Normalizer-15"><span class="linenos">15</span></a>
</span><span id="Normalizer-16"><a href="#Normalizer-16"><span class="linenos">16</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Normalizer-17"><a href="#Normalizer-17"><span class="linenos">17</span></a><span class="sd">    A utility class for normalizing and denormalizing TimeSeries instances.</span>
</span><span id="Normalizer-18"><a href="#Normalizer-18"><span class="linenos">18</span></a>
</span><span id="Normalizer-19"><a href="#Normalizer-19"><span class="linenos">19</span></a><span class="sd">    This class computes and stores the mean and standard deviation of the</span>
</span><span id="Normalizer-20"><a href="#Normalizer-20"><span class="linenos">20</span></a><span class="sd">    dependent variable during normalization. These statistics are later used</span>
</span><span id="Normalizer-21"><a href="#Normalizer-21"><span class="linenos">21</span></a><span class="sd">    to restore the original scale of the data when denormalizing.</span>
</span><span id="Normalizer-22"><a href="#Normalizer-22"><span class="linenos">22</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Normalizer-23"><a href="#Normalizer-23"><span class="linenos">23</span></a>    
</span><span id="Normalizer-24"><a href="#Normalizer-24"><span class="linenos">24</span></a>    <span class="n">means</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Normalizer-25"><a href="#Normalizer-25"><span class="linenos">25</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Mean values of the dependent variable, computed during normalization.&quot;&quot;&quot;</span>
</span><span id="Normalizer-26"><a href="#Normalizer-26"><span class="linenos">26</span></a>
</span><span id="Normalizer-27"><a href="#Normalizer-27"><span class="linenos">27</span></a>    <span class="n">standard_deviations</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">init</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Normalizer-28"><a href="#Normalizer-28"><span class="linenos">28</span></a>
</span><span id="Normalizer-29"><a href="#Normalizer-29"><span class="linenos">29</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Standard deviation values of the dependent variable, computed during normalization.&quot;&quot;&quot;</span>
</span><span id="Normalizer-30"><a href="#Normalizer-30"><span class="linenos">30</span></a>
</span><span id="Normalizer-31"><a href="#Normalizer-31"><span class="linenos">31</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_series</span><span class="p">:</span> <span class="n">TimeSeries</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimeSeries</span><span class="p">:</span>
</span><span id="Normalizer-32"><a href="#Normalizer-32"><span class="linenos">32</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Normalizer-33"><a href="#Normalizer-33"><span class="linenos">33</span></a><span class="sd">        Normalize a TimeSeries instance by adjusting its values to have zero mean and unit variance.</span>
</span><span id="Normalizer-34"><a href="#Normalizer-34"><span class="linenos">34</span></a>
</span><span id="Normalizer-35"><a href="#Normalizer-35"><span class="linenos">35</span></a><span class="sd">        Args:</span>
</span><span id="Normalizer-36"><a href="#Normalizer-36"><span class="linenos">36</span></a><span class="sd">            time_series (TimeSeries): The time series to be normalized.</span>
</span><span id="Normalizer-37"><a href="#Normalizer-37"><span class="linenos">37</span></a>
</span><span id="Normalizer-38"><a href="#Normalizer-38"><span class="linenos">38</span></a><span class="sd">        Returns:</span>
</span><span id="Normalizer-39"><a href="#Normalizer-39"><span class="linenos">39</span></a><span class="sd">            TimeSeries: A new TimeSeries instance with normalized values.</span>
</span><span id="Normalizer-40"><a href="#Normalizer-40"><span class="linenos">40</span></a><span class="sd">  </span>
</span><span id="Normalizer-41"><a href="#Normalizer-41"><span class="linenos">41</span></a><span class="sd">        Raises:</span>
</span><span id="Normalizer-42"><a href="#Normalizer-42"><span class="linenos">42</span></a><span class="sd">            ValueError: If the normalizer has already been used, since it is intended for one-time use.</span>
</span><span id="Normalizer-43"><a href="#Normalizer-43"><span class="linenos">43</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Normalizer-44"><a href="#Normalizer-44"><span class="linenos">44</span></a>        
</span><span id="Normalizer-45"><a href="#Normalizer-45"><span class="linenos">45</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;means&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;standard_deviations&quot;</span><span class="p">):</span>
</span><span id="Normalizer-46"><a href="#Normalizer-46"><span class="linenos">46</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You can only use the Normalizer once. Create a new instance to normalize again&quot;</span><span class="p">)</span>
</span><span id="Normalizer-47"><a href="#Normalizer-47"><span class="linenos">47</span></a>        
</span><span id="Normalizer-48"><a href="#Normalizer-48"><span class="linenos">48</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">time_series</span><span class="o">.</span><span class="n">dependent_variable</span>
</span><span id="Normalizer-49"><a href="#Normalizer-49"><span class="linenos">49</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">means</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Normalizer-50"><a href="#Normalizer-50"><span class="linenos">50</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviations</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Normalizer-51"><a href="#Normalizer-51"><span class="linenos">51</span></a>        
</span><span id="Normalizer-52"><a href="#Normalizer-52"><span class="linenos">52</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span>
</span><span id="Normalizer-53"><a href="#Normalizer-53"><span class="linenos">53</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviations</span>
</span><span id="Normalizer-54"><a href="#Normalizer-54"><span class="linenos">54</span></a>        
</span><span id="Normalizer-55"><a href="#Normalizer-55"><span class="linenos">55</span></a>        <span class="k">return</span> <span class="n">TimeSeries</span><span class="p">(</span>
</span><span id="Normalizer-56"><a href="#Normalizer-56"><span class="linenos">56</span></a>            <span class="n">dependent_variable</span><span class="o">=</span><span class="n">arr</span><span class="p">,</span>
</span><span id="Normalizer-57"><a href="#Normalizer-57"><span class="linenos">57</span></a>            <span class="n">times</span><span class="o">=</span><span class="n">time_series</span><span class="o">.</span><span class="n">times</span>
</span><span id="Normalizer-58"><a href="#Normalizer-58"><span class="linenos">58</span></a>        <span class="p">)</span>
</span><span id="Normalizer-59"><a href="#Normalizer-59"><span class="linenos">59</span></a>    
</span><span id="Normalizer-60"><a href="#Normalizer-60"><span class="linenos">60</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">denormalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_series</span><span class="p">:</span> <span class="n">TimeSeries</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimeSeries</span><span class="p">:</span>
</span><span id="Normalizer-61"><a href="#Normalizer-61"><span class="linenos">61</span></a>
</span><span id="Normalizer-62"><a href="#Normalizer-62"><span class="linenos">62</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Normalizer-63"><a href="#Normalizer-63"><span class="linenos">63</span></a><span class="sd">        Denormalize a previously normalized TimeSeries instance, restoring it to its original scale.</span>
</span><span id="Normalizer-64"><a href="#Normalizer-64"><span class="linenos">64</span></a>
</span><span id="Normalizer-65"><a href="#Normalizer-65"><span class="linenos">65</span></a><span class="sd">        Args:</span>
</span><span id="Normalizer-66"><a href="#Normalizer-66"><span class="linenos">66</span></a><span class="sd">            time_series (TimeSeries): Time series to denormalize</span>
</span><span id="Normalizer-67"><a href="#Normalizer-67"><span class="linenos">67</span></a><span class="sd">        </span>
</span><span id="Normalizer-68"><a href="#Normalizer-68"><span class="linenos">68</span></a><span class="sd">        Returns:</span>
</span><span id="Normalizer-69"><a href="#Normalizer-69"><span class="linenos">69</span></a><span class="sd">            TimeSeries: The denormalized time series</span>
</span><span id="Normalizer-70"><a href="#Normalizer-70"><span class="linenos">70</span></a><span class="sd">        </span>
</span><span id="Normalizer-71"><a href="#Normalizer-71"><span class="linenos">71</span></a>
</span><span id="Normalizer-72"><a href="#Normalizer-72"><span class="linenos">72</span></a><span class="sd">        Raises:</span>
</span><span id="Normalizer-73"><a href="#Normalizer-73"><span class="linenos">73</span></a><span class="sd">            ValueError: If normalization has not been performed before calling this method.</span>
</span><span id="Normalizer-74"><a href="#Normalizer-74"><span class="linenos">74</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Normalizer-75"><a href="#Normalizer-75"><span class="linenos">75</span></a>        
</span><span id="Normalizer-76"><a href="#Normalizer-76"><span class="linenos">76</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;means&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;standard_deviations&quot;</span><span class="p">):</span>
</span><span id="Normalizer-77"><a href="#Normalizer-77"><span class="linenos">77</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You can only denormalize after normalizing a time series.&quot;</span><span class="p">)</span>
</span><span id="Normalizer-78"><a href="#Normalizer-78"><span class="linenos">78</span></a>  
</span><span id="Normalizer-79"><a href="#Normalizer-79"><span class="linenos">79</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">time_series</span><span class="o">.</span><span class="n">dependent_variable</span>
</span><span id="Normalizer-80"><a href="#Normalizer-80"><span class="linenos">80</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviations</span>
</span><span id="Normalizer-81"><a href="#Normalizer-81"><span class="linenos">81</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span>
</span><span id="Normalizer-82"><a href="#Normalizer-82"><span class="linenos">82</span></a>        
</span><span id="Normalizer-83"><a href="#Normalizer-83"><span class="linenos">83</span></a>        <span class="k">return</span> <span class="n">TimeSeries</span><span class="p">(</span><span class="n">dependent_variable</span><span class="o">=</span><span class="n">arr</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">time_series</span><span class="o">.</span><span class="n">times</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A utility class for normalizing and denormalizing TimeSeries instances.</p>

<p>This class computes and stores the mean and standard deviation of the
dependent variable during normalization. These statistics are later used
to restore the original scale of the data when denormalizing.</p>
</div>


                            <div id="Normalizer.means" class="classattr">
                                <div class="attr variable">
            <span class="name">means</span><span class="annotation">: numpy.ndarray[typing.Any, numpy.dtype[numpy.floating]]</span>

        
    </div>
    <a class="headerlink" href="#Normalizer.means"></a>
    
            <div class="docstring"><p>Mean values of the dependent variable, computed during normalization.</p>
</div>


                            </div>
                            <div id="Normalizer.standard_deviations" class="classattr">
                                <div class="attr variable">
            <span class="name">standard_deviations</span><span class="annotation">: numpy.ndarray[typing.Any, numpy.dtype[numpy.floating]]</span>

        
    </div>
    <a class="headerlink" href="#Normalizer.standard_deviations"></a>
    
            <div class="docstring"><p>Standard deviation values of the dependent variable, computed during normalization.</p>
</div>


                            </div>
                            <div id="Normalizer.normalize" class="classattr">
                                        <input id="Normalizer.normalize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">normalize</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">time_series</span><span class="p">:</span> <span class="n"><a href="time_series.html#TimeSeries">aqua_blue.time_series.TimeSeries</a></span></span><span class="return-annotation">) -> <span class="n"><a href="time_series.html#TimeSeries">aqua_blue.time_series.TimeSeries</a></span>:</span></span>

                <label class="view-source-button" for="Normalizer.normalize-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Normalizer.normalize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Normalizer.normalize-31"><a href="#Normalizer.normalize-31"><span class="linenos">31</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_series</span><span class="p">:</span> <span class="n">TimeSeries</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimeSeries</span><span class="p">:</span>
</span><span id="Normalizer.normalize-32"><a href="#Normalizer.normalize-32"><span class="linenos">32</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Normalizer.normalize-33"><a href="#Normalizer.normalize-33"><span class="linenos">33</span></a><span class="sd">        Normalize a TimeSeries instance by adjusting its values to have zero mean and unit variance.</span>
</span><span id="Normalizer.normalize-34"><a href="#Normalizer.normalize-34"><span class="linenos">34</span></a>
</span><span id="Normalizer.normalize-35"><a href="#Normalizer.normalize-35"><span class="linenos">35</span></a><span class="sd">        Args:</span>
</span><span id="Normalizer.normalize-36"><a href="#Normalizer.normalize-36"><span class="linenos">36</span></a><span class="sd">            time_series (TimeSeries): The time series to be normalized.</span>
</span><span id="Normalizer.normalize-37"><a href="#Normalizer.normalize-37"><span class="linenos">37</span></a>
</span><span id="Normalizer.normalize-38"><a href="#Normalizer.normalize-38"><span class="linenos">38</span></a><span class="sd">        Returns:</span>
</span><span id="Normalizer.normalize-39"><a href="#Normalizer.normalize-39"><span class="linenos">39</span></a><span class="sd">            TimeSeries: A new TimeSeries instance with normalized values.</span>
</span><span id="Normalizer.normalize-40"><a href="#Normalizer.normalize-40"><span class="linenos">40</span></a><span class="sd">  </span>
</span><span id="Normalizer.normalize-41"><a href="#Normalizer.normalize-41"><span class="linenos">41</span></a><span class="sd">        Raises:</span>
</span><span id="Normalizer.normalize-42"><a href="#Normalizer.normalize-42"><span class="linenos">42</span></a><span class="sd">            ValueError: If the normalizer has already been used, since it is intended for one-time use.</span>
</span><span id="Normalizer.normalize-43"><a href="#Normalizer.normalize-43"><span class="linenos">43</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Normalizer.normalize-44"><a href="#Normalizer.normalize-44"><span class="linenos">44</span></a>        
</span><span id="Normalizer.normalize-45"><a href="#Normalizer.normalize-45"><span class="linenos">45</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;means&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;standard_deviations&quot;</span><span class="p">):</span>
</span><span id="Normalizer.normalize-46"><a href="#Normalizer.normalize-46"><span class="linenos">46</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You can only use the Normalizer once. Create a new instance to normalize again&quot;</span><span class="p">)</span>
</span><span id="Normalizer.normalize-47"><a href="#Normalizer.normalize-47"><span class="linenos">47</span></a>        
</span><span id="Normalizer.normalize-48"><a href="#Normalizer.normalize-48"><span class="linenos">48</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">time_series</span><span class="o">.</span><span class="n">dependent_variable</span>
</span><span id="Normalizer.normalize-49"><a href="#Normalizer.normalize-49"><span class="linenos">49</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">means</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Normalizer.normalize-50"><a href="#Normalizer.normalize-50"><span class="linenos">50</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviations</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Normalizer.normalize-51"><a href="#Normalizer.normalize-51"><span class="linenos">51</span></a>        
</span><span id="Normalizer.normalize-52"><a href="#Normalizer.normalize-52"><span class="linenos">52</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span>
</span><span id="Normalizer.normalize-53"><a href="#Normalizer.normalize-53"><span class="linenos">53</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviations</span>
</span><span id="Normalizer.normalize-54"><a href="#Normalizer.normalize-54"><span class="linenos">54</span></a>        
</span><span id="Normalizer.normalize-55"><a href="#Normalizer.normalize-55"><span class="linenos">55</span></a>        <span class="k">return</span> <span class="n">TimeSeries</span><span class="p">(</span>
</span><span id="Normalizer.normalize-56"><a href="#Normalizer.normalize-56"><span class="linenos">56</span></a>            <span class="n">dependent_variable</span><span class="o">=</span><span class="n">arr</span><span class="p">,</span>
</span><span id="Normalizer.normalize-57"><a href="#Normalizer.normalize-57"><span class="linenos">57</span></a>            <span class="n">times</span><span class="o">=</span><span class="n">time_series</span><span class="o">.</span><span class="n">times</span>
</span><span id="Normalizer.normalize-58"><a href="#Normalizer.normalize-58"><span class="linenos">58</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Normalize a TimeSeries instance by adjusting its values to have zero mean and unit variance.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>time_series (TimeSeries):</strong>  The time series to be normalized.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>TimeSeries: A new TimeSeries instance with normalized values.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If the normalizer has already been used, since it is intended for one-time use.</li>
</ul>
</div>


                            </div>
                            <div id="Normalizer.denormalize" class="classattr">
                                        <input id="Normalizer.denormalize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">denormalize</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">time_series</span><span class="p">:</span> <span class="n"><a href="time_series.html#TimeSeries">aqua_blue.time_series.TimeSeries</a></span></span><span class="return-annotation">) -> <span class="n"><a href="time_series.html#TimeSeries">aqua_blue.time_series.TimeSeries</a></span>:</span></span>

                <label class="view-source-button" for="Normalizer.denormalize-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Normalizer.denormalize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Normalizer.denormalize-60"><a href="#Normalizer.denormalize-60"><span class="linenos">60</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">denormalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_series</span><span class="p">:</span> <span class="n">TimeSeries</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimeSeries</span><span class="p">:</span>
</span><span id="Normalizer.denormalize-61"><a href="#Normalizer.denormalize-61"><span class="linenos">61</span></a>
</span><span id="Normalizer.denormalize-62"><a href="#Normalizer.denormalize-62"><span class="linenos">62</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Normalizer.denormalize-63"><a href="#Normalizer.denormalize-63"><span class="linenos">63</span></a><span class="sd">        Denormalize a previously normalized TimeSeries instance, restoring it to its original scale.</span>
</span><span id="Normalizer.denormalize-64"><a href="#Normalizer.denormalize-64"><span class="linenos">64</span></a>
</span><span id="Normalizer.denormalize-65"><a href="#Normalizer.denormalize-65"><span class="linenos">65</span></a><span class="sd">        Args:</span>
</span><span id="Normalizer.denormalize-66"><a href="#Normalizer.denormalize-66"><span class="linenos">66</span></a><span class="sd">            time_series (TimeSeries): Time series to denormalize</span>
</span><span id="Normalizer.denormalize-67"><a href="#Normalizer.denormalize-67"><span class="linenos">67</span></a><span class="sd">        </span>
</span><span id="Normalizer.denormalize-68"><a href="#Normalizer.denormalize-68"><span class="linenos">68</span></a><span class="sd">        Returns:</span>
</span><span id="Normalizer.denormalize-69"><a href="#Normalizer.denormalize-69"><span class="linenos">69</span></a><span class="sd">            TimeSeries: The denormalized time series</span>
</span><span id="Normalizer.denormalize-70"><a href="#Normalizer.denormalize-70"><span class="linenos">70</span></a><span class="sd">        </span>
</span><span id="Normalizer.denormalize-71"><a href="#Normalizer.denormalize-71"><span class="linenos">71</span></a>
</span><span id="Normalizer.denormalize-72"><a href="#Normalizer.denormalize-72"><span class="linenos">72</span></a><span class="sd">        Raises:</span>
</span><span id="Normalizer.denormalize-73"><a href="#Normalizer.denormalize-73"><span class="linenos">73</span></a><span class="sd">            ValueError: If normalization has not been performed before calling this method.</span>
</span><span id="Normalizer.denormalize-74"><a href="#Normalizer.denormalize-74"><span class="linenos">74</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Normalizer.denormalize-75"><a href="#Normalizer.denormalize-75"><span class="linenos">75</span></a>        
</span><span id="Normalizer.denormalize-76"><a href="#Normalizer.denormalize-76"><span class="linenos">76</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;means&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;standard_deviations&quot;</span><span class="p">):</span>
</span><span id="Normalizer.denormalize-77"><a href="#Normalizer.denormalize-77"><span class="linenos">77</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You can only denormalize after normalizing a time series.&quot;</span><span class="p">)</span>
</span><span id="Normalizer.denormalize-78"><a href="#Normalizer.denormalize-78"><span class="linenos">78</span></a>  
</span><span id="Normalizer.denormalize-79"><a href="#Normalizer.denormalize-79"><span class="linenos">79</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">time_series</span><span class="o">.</span><span class="n">dependent_variable</span>
</span><span id="Normalizer.denormalize-80"><a href="#Normalizer.denormalize-80"><span class="linenos">80</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_deviations</span>
</span><span id="Normalizer.denormalize-81"><a href="#Normalizer.denormalize-81"><span class="linenos">81</span></a>        <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span>
</span><span id="Normalizer.denormalize-82"><a href="#Normalizer.denormalize-82"><span class="linenos">82</span></a>        
</span><span id="Normalizer.denormalize-83"><a href="#Normalizer.denormalize-83"><span class="linenos">83</span></a>        <span class="k">return</span> <span class="n">TimeSeries</span><span class="p">(</span><span class="n">dependent_variable</span><span class="o">=</span><span class="n">arr</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">time_series</span><span class="o">.</span><span class="n">times</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Denormalize a previously normalized TimeSeries instance, restoring it to its original scale.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>time_series (TimeSeries):</strong>  Time series to denormalize</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>TimeSeries: The denormalized time series</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If normalization has not been performed before calling this method.</li>
</ul>
</div>


                            </div>
                </section>
                <section id="make_sparse">
                            <input id="make_sparse-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">make_sparse</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">weight_matrix</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span>,</span><span class="param">	<span class="n">sparsity</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">generator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">Generator</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="make_sparse-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#make_sparse"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="make_sparse-86"><a href="#make_sparse-86"><span class="linenos"> 86</span></a><span class="k">def</span><span class="w"> </span><span class="nf">make_sparse</span><span class="p">(</span>
</span><span id="make_sparse-87"><a href="#make_sparse-87"><span class="linenos"> 87</span></a>    <span class="n">weight_matrix</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">],</span> 
</span><span id="make_sparse-88"><a href="#make_sparse-88"><span class="linenos"> 88</span></a>    <span class="n">sparsity</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="make_sparse-89"><a href="#make_sparse-89"><span class="linenos"> 89</span></a>    <span class="n">generator</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">Generator</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="make_sparse-90"><a href="#make_sparse-90"><span class="linenos"> 90</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]:</span>
</span><span id="make_sparse-91"><a href="#make_sparse-91"><span class="linenos"> 91</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="make_sparse-92"><a href="#make_sparse-92"><span class="linenos"> 92</span></a><span class="sd">    Make a weight matrix sparse </span>
</span><span id="make_sparse-93"><a href="#make_sparse-93"><span class="linenos"> 93</span></a><span class="sd">    </span>
</span><span id="make_sparse-94"><a href="#make_sparse-94"><span class="linenos"> 94</span></a><span class="sd">    Args:</span>
</span><span id="make_sparse-95"><a href="#make_sparse-95"><span class="linenos"> 95</span></a><span class="sd">    </span>
</span><span id="make_sparse-96"><a href="#make_sparse-96"><span class="linenos"> 96</span></a><span class="sd">        weight_matrix (np.typing.NDArray[np.floating]): Weight matrix to be made sparse</span>
</span><span id="make_sparse-97"><a href="#make_sparse-97"><span class="linenos"> 97</span></a>
</span><span id="make_sparse-98"><a href="#make_sparse-98"><span class="linenos"> 98</span></a><span class="sd">        sparsity (float): Extent of how sparse to make the weight matrix. Ranges from 0 to 1.</span>
</span><span id="make_sparse-99"><a href="#make_sparse-99"><span class="linenos"> 99</span></a>
</span><span id="make_sparse-100"><a href="#make_sparse-100"><span class="linenos">100</span></a><span class="sd">        generator (np.random.Generator): NumPy Generator to create random numbers</span>
</span><span id="make_sparse-101"><a href="#make_sparse-101"><span class="linenos">101</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="make_sparse-102"><a href="#make_sparse-102"><span class="linenos">102</span></a>    
</span><span id="make_sparse-103"><a href="#make_sparse-103"><span class="linenos">103</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">generator</span><span class="p">:</span>
</span><span id="make_sparse-104"><a href="#make_sparse-104"><span class="linenos">104</span></a>        <span class="n">generator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="make_sparse-105"><a href="#make_sparse-105"><span class="linenos">105</span></a>    
</span><span id="make_sparse-106"><a href="#make_sparse-106"><span class="linenos">106</span></a>    <span class="n">mask</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">weight_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">sparsity</span> 
</span><span id="make_sparse-107"><a href="#make_sparse-107"><span class="linenos">107</span></a>    <span class="k">return</span> <span class="n">weight_matrix</span> <span class="o">*</span> <span class="n">mask</span>
</span></pre></div>


            <div class="docstring"><p>Make a weight matrix sparse </p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>weight_matrix (np.typing.NDArray[np.floating]):</strong>  Weight matrix to be made sparse</li>
<li><strong>sparsity (float):</strong>  Extent of how sparse to make the weight matrix. Ranges from 0 to 1.</li>
<li><strong>generator (np.random.Generator):</strong>  NumPy Generator to create random numbers</li>
</ul>
</div>


                </section>
                <section id="set_spectral">
                            <input id="set_spectral-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_spectral</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">weight_matrix</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span>,</span><span class="param">	<span class="n">spectral_radius</span><span class="p">:</span> <span class="nb">float</span></span><span class="return-annotation">) -> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">floating</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="set_spectral-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#set_spectral"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="set_spectral-110"><a href="#set_spectral-110"><span class="linenos">110</span></a><span class="k">def</span><span class="w"> </span><span class="nf">set_spectral</span><span class="p">(</span>
</span><span id="set_spectral-111"><a href="#set_spectral-111"><span class="linenos">111</span></a>    <span class="n">weight_matrix</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">],</span> 
</span><span id="set_spectral-112"><a href="#set_spectral-112"><span class="linenos">112</span></a>    <span class="n">spectral_radius</span><span class="p">:</span> <span class="nb">float</span>
</span><span id="set_spectral-113"><a href="#set_spectral-113"><span class="linenos">113</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">floating</span><span class="p">]:</span>
</span><span id="set_spectral-114"><a href="#set_spectral-114"><span class="linenos">114</span></a><span class="w">    </span>
</span><span id="set_spectral-115"><a href="#set_spectral-115"><span class="linenos">115</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="set_spectral-116"><a href="#set_spectral-116"><span class="linenos">116</span></a><span class="sd">    Set the spectral radius of the weight matrix </span>
</span><span id="set_spectral-117"><a href="#set_spectral-117"><span class="linenos">117</span></a><span class="sd">    </span>
</span><span id="set_spectral-118"><a href="#set_spectral-118"><span class="linenos">118</span></a><span class="sd">    Args:</span>
</span><span id="set_spectral-119"><a href="#set_spectral-119"><span class="linenos">119</span></a><span class="sd">    </span>
</span><span id="set_spectral-120"><a href="#set_spectral-120"><span class="linenos">120</span></a><span class="sd">        weight_matrix (np.typing.NDArray[np.floating]): Weight matrix whose spectral radius is to be set</span>
</span><span id="set_spectral-121"><a href="#set_spectral-121"><span class="linenos">121</span></a>
</span><span id="set_spectral-122"><a href="#set_spectral-122"><span class="linenos">122</span></a><span class="sd">        spectral_radius (float):</span>
</span><span id="set_spectral-123"><a href="#set_spectral-123"><span class="linenos">123</span></a><span class="sd">            The largest absolute singular value of the weight matrix.</span>
</span><span id="set_spectral-124"><a href="#set_spectral-124"><span class="linenos">124</span></a><span class="sd">            Values less than 1.0 are recommended for tasks that require significant memory fading.</span>
</span><span id="set_spectral-125"><a href="#set_spectral-125"><span class="linenos">125</span></a><span class="sd">            Values between 1-1.5 are recommended for tasks that are memory dependent.</span>
</span><span id="set_spectral-126"><a href="#set_spectral-126"><span class="linenos">126</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="set_spectral-127"><a href="#set_spectral-127"><span class="linenos">127</span></a>    
</span><span id="set_spectral-128"><a href="#set_spectral-128"><span class="linenos">128</span></a>    <span class="k">return</span> <span class="n">spectral_radius</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">weight_matrix</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">weight_matrix</span>
</span></pre></div>


            <div class="docstring"><p>Set the spectral radius of the weight matrix </p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>weight_matrix (np.typing.NDArray[np.floating]):</strong>  Weight matrix whose spectral radius is to be set</li>
<li><strong>spectral_radius (float):</strong>  The largest absolute singular value of the weight matrix.
Values less than 1.0 are recommended for tasks that require significant memory fading.
Values between 1-1.5 are recommended for tasks that are memory dependent.</li>
</ul>
</div>


                </section>
    </main>
<!-- End of C:/CodingGeneral/chicagoClubManagement/aqua-blue/_build/aqua_blue/utilities.html -->
</body></html>